{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"themes/hexo-theme-next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/avatar.jpeg","path":"images/avatar.jpeg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/affix.js","path":"js/affix.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/exturl.js","path":"js/exturl.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/js.cookie.js","path":"js/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/motion.js","path":"js/motion.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/next-boot.js","path":"js/next-boot.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/post-details.js","path":"js/post-details.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/scroll-cookie.js","path":"js/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/scrollspy.js","path":"js/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/pay/alipay.png","path":"images/pay/alipay.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/pay/wechatpay.png","path":"images/pay/wechatpay.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1}],"Cache":[{"_id":"source/CNAME","hash":"9c974641389c6398f84f5f30a1fe4140c5345180","modified":1576826690114},{"_id":"themes/hexo-theme-next/.all-contributorsrc","hash":"d139a3b623b2e40bbff5c96ad44adf7dbdbc5be1","modified":1576826690116},{"_id":"themes/hexo-theme-next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1576826690117},{"_id":"themes/hexo-theme-next/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1576826690117},{"_id":"themes/hexo-theme-next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1576826690117},{"_id":"themes/hexo-theme-next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1576826690117},{"_id":"themes/hexo-theme-next/.gitignore","hash":"3ba52a2ecf11a3cc1f45c65d5d7cbfa42a6419cc","modified":1576826690117},{"_id":"themes/hexo-theme-next/.travis.yml","hash":"3d1dc928c4a97933e64379cfde749dedf62f252c","modified":1576826690117},{"_id":"themes/hexo-theme-next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1576826690117},{"_id":"themes/hexo-theme-next/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1576826690118},{"_id":"themes/hexo-theme-next/README.md","hash":"7958c3f70b2133b479ddaf525cc4b6d87a37e04a","modified":1576826690118},{"_id":"themes/hexo-theme-next/_config.yml","hash":"e9bb05a4442969344a9965472cb8185060a70105","modified":1584588395124},{"_id":"themes/hexo-theme-next/bower.json","hash":"9bc3900396a375f817db47d147bb6d207c661678","modified":1576826690119},{"_id":"themes/hexo-theme-next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1576826690119},{"_id":"themes/hexo-theme-next/gulpfile.coffee","hash":"23bd9587807edc4dbecb5c5a29ab96ade24458b5","modified":1576826690119},{"_id":"themes/hexo-theme-next/package.json","hash":"0284636ddd0e06ae593f4887819f3a35b08c1370","modified":1576826690143},{"_id":"source/404/index.md","hash":"82aac6497bcc87641291c7a683d0a9c1b02c4856","modified":1576826690114},{"_id":"source/_posts/Ionic4开发备忘.md","hash":"8fe2d945fde17a97f153813e163eb4e1f6608299","modified":1584588618288},{"_id":"source/_posts/JavaScript前端对象数组排序核心方法（支持多列排序）.md","hash":"4f27e7e6f722a34798c05932f14f27b0445e15b4","modified":1576826690114},{"_id":"source/_posts/Phonegap-jQueryMobile-在线应用拍照、相册选择上传-预览.md","hash":"e9f0efa857ba1e575f5bcd51d6d73e40438ffc09","modified":1576826690114},{"_id":"source/_posts/前后端分离.md","hash":"6b7941fdb581f9eef888881cdf13fa03c99cb63a","modified":1576826690116},{"_id":"source/_posts/SpringMVC整合WebSocket.md","hash":"0bbeac4e850fae41cd4826260fd15ab61e493720","modified":1576826690115},{"_id":"source/about/index.md","hash":"369ed72aeacd20c478bfa3a626c64c05a275c9b8","modified":1576827681936},{"_id":"source/categories/index.md","hash":"6c12c9c52596f1fe1cff8843a59fc1b8784be3c5","modified":1576826690116},{"_id":"source/tags/index.md","hash":"839917f3a88dbaf6710cd28ed8c76fa4e8188d87","modified":1576826690116},{"_id":"themes/hexo-theme-next/languages/de.yml","hash":"9e524b2bdfb848504b93a51c5650e76bba5fa9e0","modified":1576826690119},{"_id":"themes/hexo-theme-next/languages/default.yml","hash":"c540c3a0d7db2d4239293c8783881962640b6c34","modified":1576826690120},{"_id":"themes/hexo-theme-next/languages/en.yml","hash":"c540c3a0d7db2d4239293c8783881962640b6c34","modified":1576826690120},{"_id":"themes/hexo-theme-next/languages/es.yml","hash":"1752429687861b5cedd063c6ebe5dacefbe7e5a7","modified":1576826690120},{"_id":"themes/hexo-theme-next/languages/fa.yml","hash":"cd41db832af5e399590b70a5227cfe0b0e98e101","modified":1576826690120},{"_id":"themes/hexo-theme-next/languages/fr.yml","hash":"7005c2b42c2c6e82bd7a1be5cc2f443b5fc79105","modified":1576826690120},{"_id":"themes/hexo-theme-next/languages/id.yml","hash":"1c4868837f5109f1df863b04fe627352c31d404b","modified":1576826690120},{"_id":"themes/hexo-theme-next/languages/it.yml","hash":"b30ff77ad8044e3b021a3b09187cd377dc789fd2","modified":1576826690120},{"_id":"themes/hexo-theme-next/languages/ja.yml","hash":"1dc35e436da6214cdb3c2ff44bc4a06d0be5b9a0","modified":1576826690121},{"_id":"themes/hexo-theme-next/languages/ko.yml","hash":"20bfaa7600d35235996c18e5c13dcef89c119626","modified":1576826690121},{"_id":"themes/hexo-theme-next/languages/nl.yml","hash":"1c44b3cb2f817808607f3bf6ef47f58ce7599995","modified":1576826690121},{"_id":"themes/hexo-theme-next/languages/pt-BR.yml","hash":"08b913a5cf4cc160083069cb4dfb2d66eecd1218","modified":1576826690121},{"_id":"themes/hexo-theme-next/languages/pt.yml","hash":"8ddac820e2c17b484b56c0da8881e142b10e221b","modified":1576826690121},{"_id":"themes/hexo-theme-next/languages/ru.yml","hash":"db0644e738d2306ac38567aa183ca3e859a3980f","modified":1576826690122},{"_id":"themes/hexo-theme-next/languages/tr.yml","hash":"c5f0c20743b1dd52ccb256050b1397d023e6bcd9","modified":1576826690122},{"_id":"themes/hexo-theme-next/languages/uk.yml","hash":"1eb59e581568da9a81d6e20541b4ada5fc1c55c0","modified":1576826690122},{"_id":"themes/hexo-theme-next/languages/vi.yml","hash":"ba7aff8f88e03f69a0acf7f1b90ee03e077ee88e","modified":1576826690122},{"_id":"themes/hexo-theme-next/languages/zh-CN.yml","hash":"fbbf3a0b664ae8e927c700b0a813692b94345156","modified":1576826690123},{"_id":"themes/hexo-theme-next/languages/zh-HK.yml","hash":"7903b96912c605e630fb695534012501b2fad805","modified":1576826690123},{"_id":"themes/hexo-theme-next/languages/zh-TW.yml","hash":"6e6d2cd8f4244cb1b349b94904cb4770935acefd","modified":1576826690123},{"_id":"themes/hexo-theme-next/layout/_layout.swig","hash":"74701fcf2303d59400587436ab4c244e04df7ad9","modified":1576826690125},{"_id":"themes/hexo-theme-next/layout/archive.swig","hash":"7e8f3a41a68e912f2b2aaba905d314306ccaf794","modified":1576826690142},{"_id":"themes/hexo-theme-next/layout/category.swig","hash":"dda0e6b2139decaf5e865d22ec9d45fdb615a703","modified":1576826690143},{"_id":"themes/hexo-theme-next/layout/index.swig","hash":"c2a3896c64e96790edc10426ef586b6186a87f46","modified":1576826690143},{"_id":"themes/hexo-theme-next/layout/page.swig","hash":"d8a6cbf6f611c5d68d5da430cb6dc7010ff2c7e0","modified":1576826690143},{"_id":"themes/hexo-theme-next/layout/post.swig","hash":"f74929fd792541916eb25c2addfb35431be071ba","modified":1576826690143},{"_id":"themes/hexo-theme-next/layout/schedule.swig","hash":"3268dd3d90d8b0e142cfa1a2ebb23355baeda148","modified":1576826690143},{"_id":"themes/hexo-theme-next/layout/tag.swig","hash":"a6be69a90924c9d2f4d90fb4867234859bd2c2e9","modified":1576826690143},{"_id":"themes/hexo-theme-next/scripts/merge-configs.js","hash":"33afe97284d34542015d358a720823feeebef120","modified":1576826690144},{"_id":"themes/hexo-theme-next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1576826690145},{"_id":"themes/hexo-theme-next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1576826690183},{"_id":"themes/hexo-theme-next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1576826690183},{"_id":"themes/hexo-theme-next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1576826690184},{"_id":"themes/hexo-theme-next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1576826690165},{"_id":"themes/hexo-theme-next/layout/_custom/head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1576826690124},{"_id":"themes/hexo-theme-next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1576826690124},{"_id":"themes/hexo-theme-next/layout/_custom/sidebar.swig","hash":"892ff9bebe146c62e4a18427959258fb901bd96b","modified":1576826690125},{"_id":"themes/hexo-theme-next/layout/_macro/post-collapse.swig","hash":"89b0a0e64637bf5b0cfea0a23642df3d95eedfa4","modified":1576826690127},{"_id":"themes/hexo-theme-next/layout/_macro/post.swig","hash":"8a8a2865b09e933c454d9a68e54dd9063dc8c559","modified":1576826690127},{"_id":"themes/hexo-theme-next/layout/_macro/sidebar.swig","hash":"480d93619479dcfcbec6906803bb38b2dfbeae53","modified":1576826690127},{"_id":"themes/hexo-theme-next/layout/_partials/comments.swig","hash":"5352f96f4544c1520babf1cec7b44ddf2f8057b3","modified":1576826690128},{"_id":"themes/hexo-theme-next/layout/_partials/footer.swig","hash":"589f545333e21a8c7823bce89ab45cf1eb7db6e2","modified":1576826690128},{"_id":"themes/hexo-theme-next/layout/_partials/github-banner.swig","hash":"6357537ac0bb114aed4d61bafb39e6690a413697","modified":1576826690128},{"_id":"themes/hexo-theme-next/layout/_partials/pagination.swig","hash":"dbe321bcf3cf45917cc11a3e3f50d8572bac2c70","modified":1576826690131},{"_id":"themes/hexo-theme-next/layout/_partials/post-edit.swig","hash":"06dac109504812b63766a80ede9ddacbd42d227d","modified":1576826690131},{"_id":"themes/hexo-theme-next/layout/_scripts/commons.swig","hash":"50be1762f60222379a8bef5e42ab1a0f3872b7ff","modified":1576826690135},{"_id":"themes/hexo-theme-next/layout/_scripts/exturl.swig","hash":"61ae10d41f67ece004a025077fdb28724af05090","modified":1576826690135},{"_id":"themes/hexo-theme-next/layout/_scripts/next-boot.swig","hash":"012e3ece672cc3b13d5e032139f328d3426d7d65","modified":1576826690135},{"_id":"themes/hexo-theme-next/layout/_scripts/noscript.swig","hash":"edaff4766e0c05fd5c889d9dd32884d376bef9d9","modified":1576826690135},{"_id":"themes/hexo-theme-next/layout/_scripts/scroll-cookie.swig","hash":"ccd13d73429ef91ef5e8b7d9fa43c8188facdf41","modified":1576826690136},{"_id":"themes/hexo-theme-next/layout/_scripts/vendors.swig","hash":"83470eb401f78f4683907c48ad6760b90730daa3","modified":1576826690136},{"_id":"themes/hexo-theme-next/layout/_third-party/baidu-push.swig","hash":"4ccf2abbfd070874265b0436a3eff21f7c998dfb","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/bookmark.swig","hash":"10b61a8bac671e375916a4d234c120117098a78f","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/chatra.swig","hash":"eefb68b69b4b0ed558ee0324ccd711990059b20d","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/copy-code.swig","hash":"9be7c2c9cef63006866d1232c5289901e46be7ed","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/mermaid.swig","hash":"d6e6ddda836bd9e2e8d9767a910c7d3280080e81","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/needsharebutton.swig","hash":"2c4a66be4677d3e4dec3f169ac8a769098dad1fe","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/pangu.swig","hash":"c28f9dc96ab735daeb7f599f86470aa5a83c03cf","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/pdf.swig","hash":"810a9b2a6059f46c4a2ddb178f1eaa4c5e23750b","modified":1576826690141},{"_id":"themes/hexo-theme-next/layout/_third-party/rating.swig","hash":"cbe40cb67dad15ade967b0f396c1a95b6871f76a","modified":1576826690141},{"_id":"themes/hexo-theme-next/layout/_third-party/quicklink.swig","hash":"5db80e8d7ea3f29e998320f79508f7e14342a33c","modified":1576826690141},{"_id":"themes/hexo-theme-next/layout/_third-party/schedule.swig","hash":"2398e5cd0cb466953b6e7a42c2b2caddebf3c348","modified":1576826690142},{"_id":"themes/hexo-theme-next/layout/_third-party/tidio.swig","hash":"912368c41de675f458b267a49a99ae3e7e420ebb","modified":1576826690142},{"_id":"themes/hexo-theme-next/scripts/filters/exturl.js","hash":"79ad823ca803cb00e0bfc648aa6c9d59711e0519","modified":1576826690143},{"_id":"themes/hexo-theme-next/scripts/helpers/engine.js","hash":"60eb1554456d9d0e5afc4a2d16f1580a0aa02da8","modified":1576826690144},{"_id":"themes/hexo-theme-next/scripts/helpers/next-url.js","hash":"799a042bbf497a4c7a2981aa2014ff28fa1bb382","modified":1576826690144},{"_id":"themes/hexo-theme-next/scripts/tags/button.js","hash":"f3b4f7ae7e58072bbf410d950a99a0b53cbc866d","modified":1576826690145},{"_id":"themes/hexo-theme-next/scripts/tags/center-quote.js","hash":"f13430d9d1c9773b390787c2f046bb1f12a79878","modified":1576826690145},{"_id":"themes/hexo-theme-next/scripts/tags/exturl.js","hash":"d605918cf819887e9555212dbe12da97fd887a0b","modified":1576826690145},{"_id":"themes/hexo-theme-next/scripts/tags/full-image.js","hash":"fcb41c1c81560ed49dc4024654388a28ee7d32b0","modified":1576826690145},{"_id":"themes/hexo-theme-next/scripts/tags/include-raw.js","hash":"5db59d56f4f4082382bf1c16722e6c383892b0c5","modified":1576826690146},{"_id":"themes/hexo-theme-next/scripts/tags/group-pictures.js","hash":"598220fa92ff3540dcab74f633ba41523daa8364","modified":1576826690146},{"_id":"themes/hexo-theme-next/scripts/tags/label.js","hash":"fc5b267d903facb7a35001792db28b801cccb1f8","modified":1576826690146},{"_id":"themes/hexo-theme-next/scripts/tags/mermaid.js","hash":"983c6c4adea86160ecc0ba2204bc312aa338121d","modified":1576826690146},{"_id":"themes/hexo-theme-next/scripts/tags/note.js","hash":"0a02bb4c15aec41f6d5f1271cdb5c65889e265d9","modified":1576826690146},{"_id":"themes/hexo-theme-next/scripts/tags/pdf.js","hash":"f780cc72bff91d2720626e7af69eed25e9c12a29","modified":1576826690147},{"_id":"themes/hexo-theme-next/scripts/tags/tabs.js","hash":"00ca6340d4fe0ccdae7525373e4729117775bbfa","modified":1576826690147},{"_id":"themes/hexo-theme-next/scripts/tags/video.js","hash":"e5ff4c44faee604dd3ea9db6b222828c4750c227","modified":1576826690147},{"_id":"themes/hexo-theme-next/source/css/main.styl","hash":"e010ec8ac73268a0f137204c89e0080ab8d59b3d","modified":1576826690165},{"_id":"themes/hexo-theme-next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1576826690166},{"_id":"themes/hexo-theme-next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1576826690166},{"_id":"themes/hexo-theme-next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1576826690166},{"_id":"themes/hexo-theme-next/source/images/avatar.jpeg","hash":"4d643d3f6c7e015d65c4d933affb19db93d5dcbb","modified":1576826690166},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1576826690167},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1576826690167},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1576826690167},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1576826690167},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1576826690167},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1576826690168},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1576826690168},{"_id":"themes/hexo-theme-next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1576826690168},{"_id":"themes/hexo-theme-next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1576826690168},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1576826690171},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1576826690171},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1576826690171},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","hash":"025d64ba0160a3a2257dd2b3032b5f7c9dd9b82b","modified":1576826690171},{"_id":"themes/hexo-theme-next/source/js/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1576826690171},{"_id":"themes/hexo-theme-next/source/js/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1576826690172},{"_id":"themes/hexo-theme-next/source/js/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1576826690172},{"_id":"themes/hexo-theme-next/source/js/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1576826690172},{"_id":"themes/hexo-theme-next/source/js/motion.js","hash":"a16bc0b701646bf6653484675f4d5dc0f892d184","modified":1576826690172},{"_id":"themes/hexo-theme-next/source/js/next-boot.js","hash":"e0615efab5f81ba0fd39c0527eac31144deac7ce","modified":1576826690172},{"_id":"themes/hexo-theme-next/source/js/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1576826690173},{"_id":"themes/hexo-theme-next/source/js/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1576826690174},{"_id":"themes/hexo-theme-next/source/js/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1576826690174},{"_id":"themes/hexo-theme-next/source/js/utils.js","hash":"81913c5f75d0949443833cf4269ad63bd7f9be6f","modified":1576826690174},{"_id":"themes/hexo-theme-next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1576826690164},{"_id":"themes/hexo-theme-next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1576826690165},{"_id":"themes/hexo-theme-next/source/images/favicon-16x16-next.png","hash":"5bb78ac413ed6d53f62876b2fb0b8b1641cdefde","modified":1576826690168},{"_id":"themes/hexo-theme-next/source/images/favicon-32x32-next.png","hash":"5bb78ac413ed6d53f62876b2fb0b8b1641cdefde","modified":1576826690168},{"_id":"themes/hexo-theme-next/layout/_macro/menu/menu-badge.swig","hash":"65c5e585982dae7ae1542cada71858b4ea1f73d6","modified":1576826690126},{"_id":"themes/hexo-theme-next/layout/_macro/menu/menu-item.swig","hash":"fb33f499022cd02722f834fcef1a0e193362cfde","modified":1576826690127},{"_id":"themes/hexo-theme-next/layout/_partials/head/external-fonts.swig","hash":"fc6bafc8c633afadc538c5afa5620ea2a1cdcb84","modified":1576826690129},{"_id":"themes/hexo-theme-next/layout/_partials/head/head-unique.swig","hash":"02bb5748e8540b024e7f4008a9e640890b45280f","modified":1576826690129},{"_id":"themes/hexo-theme-next/layout/_partials/head/head.swig","hash":"36eae78a4d7160a1c5e59ca3f7333f00b43d359b","modified":1576826690129},{"_id":"themes/hexo-theme-next/layout/_partials/header/brand.swig","hash":"648bf7eda66629592cb915c4004534b3913cbc22","modified":1576826690129},{"_id":"themes/hexo-theme-next/layout/_partials/header/index.swig","hash":"2082f5077551123e695e8afec471c9c44b436acb","modified":1576826690130},{"_id":"themes/hexo-theme-next/layout/_partials/header/menu.swig","hash":"71af31fea5913fd30c233e555ef13cf2c9768f72","modified":1576826690130},{"_id":"themes/hexo-theme-next/layout/_partials/header/sub-menu.swig","hash":"5adc60100e129c1d0307bdcaa0c7b8e8375a6ea4","modified":1576826690130},{"_id":"themes/hexo-theme-next/layout/_partials/page/breadcrumb.swig","hash":"0fa4fadb39467b01cede49f21b22e86b1a2da805","modified":1576826690130},{"_id":"themes/hexo-theme-next/layout/_partials/page/page-header.swig","hash":"2940df694fff28e8bf71b6546b4162f1e38227db","modified":1576826690131},{"_id":"themes/hexo-theme-next/layout/_partials/post/post-copyright.swig","hash":"3615db591dd910fb9fa96542734c7ec0ef05019c","modified":1576826690131},{"_id":"themes/hexo-theme-next/layout/_partials/post/post-related.swig","hash":"eea95b785c9c36d28e1839619793f66e89773bee","modified":1576826690131},{"_id":"themes/hexo-theme-next/layout/_partials/post/reward.swig","hash":"d44f025eb93c99ddf90202d8293ccf80689a00c7","modified":1576826690131},{"_id":"themes/hexo-theme-next/layout/_partials/post/wechat-subscriber.swig","hash":"ef11b5be5bfb2f0affe82cf521c002b37fef9819","modified":1576826690132},{"_id":"themes/hexo-theme-next/layout/_partials/search/algolia-search.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1576826690133},{"_id":"themes/hexo-theme-next/layout/_partials/search/index.swig","hash":"7d1693416a5dc098f4723a53da2e2d1fc2d6e075","modified":1576826690134},{"_id":"themes/hexo-theme-next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1576826690134},{"_id":"themes/hexo-theme-next/layout/_partials/search/swiftype.swig","hash":"a5587bd1f60d35e58618576cec45e662aa44ea1f","modified":1576826690134},{"_id":"themes/hexo-theme-next/layout/_partials/share/add-this.swig","hash":"15b542f5b06b7532234af367340b9ed9fcebb0ac","modified":1576826690135},{"_id":"themes/hexo-theme-next/layout/_partials/share/baidushare.swig","hash":"6f181cc188ecbe5e607fd989756e470d4cb9765d","modified":1576826690135},{"_id":"themes/hexo-theme-next/layout/_partials/share/likely.swig","hash":"b45e934d24d76ec6b6a790e92bdb3d56186b0e2a","modified":1576826690135},{"_id":"themes/hexo-theme-next/layout/_scripts/pages/post-details.swig","hash":"5b05f165547391bf231e52f56f3d925efc09bc44","modified":1576826690136},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/gemini.swig","hash":"ffc8e8836714ea79abeb77b75859634615652877","modified":1576826690136},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/mist.swig","hash":"108b157fbd1ac3baaf19ae87234fa8728ab79556","modified":1576826690136},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/muse.swig","hash":"0097e45e7b671f8006b8b2d3c4f95cacc76a983c","modified":1576826690136},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/pisces.swig","hash":"e42604fbb17648484e5f12afe230d826de089388","modified":1576826690136},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"a5723950c343d220270bfd27bd30050eda6c3fb3","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/application-insights.swig","hash":"798d67e4a736613ab899eabe6529091bbcda7850","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/baidu-analytics.swig","hash":"591b2ccd9713ccb922b9fcf5e278b6de9c5ec30b","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"8eadb929c9e50e58502ccad2dc2657746f8c592a","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"08cd47ef8572121b7811342d3c9a84a338a18191","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/facebook-sdk.swig","hash":"050ea01f25cfe492be9bb77b409644d623fdf2dc","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/firestore.swig","hash":"fae69a0e1a1d42f7bb44e594a29857d94594698b","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/google-analytics.swig","hash":"d422beaf35a5d2646feaa098bc3e5adf691c7565","modified":1576826690137},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/growingio.swig","hash":"4a966b7ffe2d80ff1b3dd0fd14b355766dc5c70f","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/index.swig","hash":"438c6f5e6665d72f4ea7ee206011d669246f6102","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/lean-analytics.swig","hash":"c754f699c90f6278b9159eff1855c17bc713ee96","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/tencent-analytics.swig","hash":"f240a50cd9b627620d9a374a29cf95f0c5e99d7c","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/tencent-mta.swig","hash":"92e04a2b9e0c3df594bc22235d1894e5ad458dfc","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/analytics/vkontakte-api.swig","hash":"0dd5b315d1da55dbfc10f51a1f8952f72eba2720","modified":1576826690138},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/changyan.swig","hash":"3533167c4295637b91d90f3bae7c651cd128bb6e","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/disqus.swig","hash":"3cfeafefc672d9a7704650ebfb2f9d8668b38d9a","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/disqusjs.swig","hash":"c77a2e7ef5f449a445fb4d36b055721fba4a81af","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/gitalk.swig","hash":"e8f91c571ceb4b80aafebc4d36b89fb41b1ae040","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/gitment.swig","hash":"388efc86af7f19c05ad0e26720cd24ee012d20b9","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/index.swig","hash":"2cbaae65a020bbb0e9265364488aff8bf84fa48d","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/livere.swig","hash":"5856d5f701e51dfae1fd6fb486cefde67effd555","modified":1576826690139},{"_id":"themes/hexo-theme-next/layout/_third-party/comments/valine.swig","hash":"4a908b613518878b9b69576c5dba4a5185f552ab","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/math/index.swig","hash":"a7e304b05a44279d3e4f611908d7faef9dc14d7c","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/math/katex.swig","hash":"c2cb2f384bc30d31cdccf9794a729c03e687b45c","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/math/mathjax.swig","hash":"601774d8672577aefbcefac82c94b01f0338da31","modified":1576826690140},{"_id":"themes/hexo-theme-next/layout/_third-party/search/algolia-search.swig","hash":"0a13dfd2de52a96901039098c6fc7b515edfc50b","modified":1576826690142},{"_id":"themes/hexo-theme-next/layout/_third-party/search/index.swig","hash":"ea94aa85034c6d1b6bb865aecea55c73f8a14501","modified":1576826690142},{"_id":"themes/hexo-theme-next/layout/_third-party/search/localsearch.swig","hash":"b3eaab6a269aa3fcbafe24fd06f0c9206dc12716","modified":1576826690142},{"_id":"themes/hexo-theme-next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_mixins/Pisces.styl","hash":"2e8fb29aa92325df39054b5450757858c6cebc41","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_mixins/base.styl","hash":"2036bbb73afd43251982ce824f06c6e88d35a2ef","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_variables/Gemini.styl","hash":"a8aa41625b94cf17a7f473ed10dcbe683b1db705","modified":1576826690164},{"_id":"themes/hexo-theme-next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1576826690164},{"_id":"themes/hexo-theme-next/source/css/_variables/Pisces.styl","hash":"fc15e277d1504532a09b7b1bd31f900ad95ec4b8","modified":1576826690164},{"_id":"themes/hexo-theme-next/source/js/schemes/muse.js","hash":"e9bfa6b343b67625f58757efce46ccdaac8f308c","modified":1576826690173},{"_id":"themes/hexo-theme-next/source/js/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1576826690173},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1576826690175},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1576826690175},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1576826690175},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1576826690176},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1576826690176},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1576826690182},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1576826690183},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1576826690183},{"_id":"themes/hexo-theme-next/source/css/_variables/base.styl","hash":"640f25a63770af5566ccc9cec79c40a4f1c0b29e","modified":1576826690164},{"_id":"themes/hexo-theme-next/source/images/pay/alipay.png","hash":"28d313b7f2538106f87585d90c4f00639deb84d6","modified":1576826690169},{"_id":"themes/hexo-theme-next/source/images/pay/wechatpay.png","hash":"f363c8527102fd96c8cd0314d5c92ef2ed5264c8","modified":1576826690170},{"_id":"themes/hexo-theme-next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1576826690180},{"_id":"themes/hexo-theme-next/source/css/_common/components/back-to-top-sidebar.styl","hash":"fe5ff961b86004a306778c7d33a85b32e5e00e48","modified":1576826690148},{"_id":"themes/hexo-theme-next/source/css/_common/components/back-to-top.styl","hash":"c8b3225396cb444d8baeb94bac78e5216b992a81","modified":1576826690148},{"_id":"themes/hexo-theme-next/source/css/_common/components/buttons.styl","hash":"b98c65006e2546fbf3870c16fbbcbc009dbaab15","modified":1576826690148},{"_id":"themes/hexo-theme-next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1576826690148},{"_id":"themes/hexo-theme-next/source/css/_common/components/components.styl","hash":"9d71f34fa13a41b8c8cd2fbdf3fdea608385277c","modified":1576826690148},{"_id":"themes/hexo-theme-next/source/css/_common/components/pagination.styl","hash":"ce826aedf42b9eca424a044452f5d193866726a6","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/rainbow.styl","hash":"ce2aae8f3ed8ceac3a2417e0481044cf69c788aa","modified":1576826690154},{"_id":"themes/hexo-theme-next/source/css/_common/components/scrollbar.styl","hash":"d7b8bcf2a6031296c84bb4f4ecfb037af01d2d82","modified":1576826690154},{"_id":"themes/hexo-theme-next/source/css/_common/outline/outline.styl","hash":"7e51ea64611ab5d678c112b4688d4db4fd2737e2","modified":1576826690159},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/base.styl","hash":"6d900b4159eeb869196a619602578bf4d83a117b","modified":1576826690159},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/helpers.styl","hash":"8e0740a9ad349ce5555122325da872923135a698","modified":1576826690159},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/mobile.styl","hash":"9a190ef2f49bdbf69604b48ad1dc7197895ee9b6","modified":1576826690159},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/normalize.styl","hash":"7ffde343bdf10add1f052f3c4308a15180eb4404","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/tables.styl","hash":"33456264a74d1bba38264d14713544d67d003733","modified":1576826690160},{"_id":"themes/hexo-theme-next/source/css/_schemes/Gemini/index.styl","hash":"9a2d298dbdcbfd758518fd74b63897bc80ce15a5","modified":1576826690161},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_base.styl","hash":"0bef9f0dc134215bc4d0984ba3a16a1a0b6f87ec","modified":1576826690161},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_header.styl","hash":"24230e46fc9fb7b8551f97bb36e9bc1f7423098e","modified":1576826690161},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1576826690161},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_menu.styl","hash":"75d2d92af070eb10273558b2436972d3f12b361c","modified":1576826690161},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fa33213aceed7bf4bf25437ca9c1a00f7734ae65","modified":1576826690161},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1576826690162},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/index.styl","hash":"a96e46a6ae86c423f932bc2bc78b9f7453e4e4e5","modified":1576826690162},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_layout.styl","hash":"6565b4a309325596768d0d32e022c80ef23066cb","modified":1576826690162},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_logo.styl","hash":"fc160583f742c94316a0fee05c18468033173534","modified":1576826690162},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_menu.styl","hash":"1edf4e69d0ec0dc9cefed6c35d3e803e0da4093d","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_brand.styl","hash":"57044a6d19eb418c1c3d28787e82c69efa9e0ca6","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_layout.styl","hash":"75737591682a2bafa71db4c03fb79e970ac0e7aa","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_menu.styl","hash":"b6dac5bbf20f090cf4b67d156f030d7170dfb39c","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_sidebar.styl","hash":"6400c98a9fd2b9a8502269f33355bd7ab3ff793b","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b5b936dddb7b4de4720cd1e8428b30a2f06d63fb","modified":1576826690164},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/index.styl","hash":"232aedbd44243b3b80c4503c947060d3269c1afc","modified":1576826690164},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1576826690176},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1576826690177},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1576826690176},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/header.styl","hash":"6c4990d375b640ee4551e62c48c1cbe4c3d62212","modified":1576826690149},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/github-banner.styl","hash":"ca97f0b6990eef947039faede80c56d9c4381ee1","modified":1576826690149},{"_id":"themes/hexo-theme-next/source/css/_common/components/footer/footer.styl","hash":"4cfeec9434a72d5efc6ca225d3445d084d4590f7","modified":1576826690148},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1576826690149},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/diff.styl","hash":"71d8d1cc22a2a7627a6db7240f0c4902a14f9bea","modified":1576826690150},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/menu.styl","hash":"a410ed529afd46ddf4a96ecf0de6599488716887","modified":1576826690149},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/site-nav.styl","hash":"cc6ee18f47f2e1e06df6fa0eadb37079e580fd11","modified":1576826690150},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/site-meta.styl","hash":"c0d9e18a9210fdcaf33e488518b3b288eb58c0a1","modified":1576826690150},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/archive.styl","hash":"6904fd7ea6455e008d9884558b68254608af9a3c","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/highlight.styl","hash":"e9dd8de7d98f1478ac7d351624fffd3d8738c905","modified":1576826690150},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1576826690150},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/breadcrumb.styl","hash":"2d142c6f39853916256ad8fc79eb6b85f4001ae8","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/schedule.styl","hash":"80addb9b725e329915c05c27b9fadaf56457a9b3","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/pages.styl","hash":"f1d52954b9a5d1ca8e224382349f525e598dd923","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/tag-cloud.styl","hash":"61ca40856e5cacd48e0fa9728fde4605c7dd4c94","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-copyright.styl","hash":"2356226157e8068b0e9bbe2f7d0f74e1ab49199b","modified":1576826690152},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-collapse.styl","hash":"6a75bb1f2435f4e895cbbb5abbddf6e8f7257804","modified":1576826690152},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1576826690151},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-eof.styl","hash":"c961d37190d9bec58a36306c7e716c4e72c4582f","modified":1576826690152},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-meta.styl","hash":"b082d07b13a3d55b4c032fd351dfa9a4fd74edec","modified":1576826690153},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-gallery.styl","hash":"0bf899fab331add63f0c8ead31ca3a3db2ad74d9","modified":1576826690152},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-expand.styl","hash":"1385862a5c0bd845015d165aadbd1a6add7b72d7","modified":1576826690152},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-nav.styl","hash":"496f931e3a7e313ba8088fb91bb20789cace72c9","modified":1576826690153},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1576826690153},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-reading_progress.styl","hash":"3f33bb862c2aa993f54987fbb345da067b79b112","modified":1576826690153},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-reward.styl","hash":"5440013a081201ca791582db98159dce93ea9e75","modified":1576826690153},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1576826690154},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-title.styl","hash":"8e058c99dd7d41f0bd34c7c28b6ac9fbb17dcb5e","modified":1576826690154},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-widgets.styl","hash":"a6c24393dffbdd94dd5c01cdbec5e180b0bfbbbd","modified":1576826690154},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-type.styl","hash":"d5c8ffed7f2c701052b7a53abaf5ef437374ea72","modified":1576826690154},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post.styl","hash":"a3170630d8e085889a4bdc20eb7f09c5a0479c47","modified":1576826690154},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"9224b566cd2632f64c1a964e2c786cee93b93286","modified":1576826690155},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"c2d9c3b6fbfa65544e6b5a55d3cb2149df04a8a9","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"cc83816614f21c7e1d8d3f867d547ff7c658cec4","modified":1576826690155},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-button.styl","hash":"517d541a80d59ad99a3f648be74891e0c7bc72a8","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"707527c9950a7459355c8abcf4751c0964de0bc1","modified":1576826690155},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"9a3bfc878ca797946815bed23cd6f92b24a16358","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"c01609176929590f8f347075a9a12b661acd661e","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar.styl","hash":"8e5c884fb950937afa350c608545455c87aa6129","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"8a24b56524a388fbabd408ffc8ba9b56eb9e01ce","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/site-state.styl","hash":"967fb3a3c6c851b34ec5df2d945dc266ed63d146","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/full-image.styl","hash":"6ec8ea7b11a146777b6b8da0f71f0cc1dbd129df","modified":1576826690157},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1576826690157},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/blockquote-center.styl","hash":"58ec00eebe68d0eebd2eea435c710063877447df","modified":1576826690156},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/pdf.styl","hash":"da8d34729fb6eb0fcb8ee81e67d2be3c02bc1bc4","modified":1576826690157},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/label.styl","hash":"d7501ae01fc45fa15b00d1bc5233b9fffa20a3c9","modified":1576826690157},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/note.styl","hash":"21b32840d8b3a14b10770153114778304ba6d1b0","modified":1576826690157},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/tabs.styl","hash":"fcda60fecff1479adaf6521cf629cda2506337a8","modified":1576826690157},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/algolia-search.styl","hash":"fc58498d4f5081fcf6218e9e18c5bf2328275bef","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/gitalk.styl","hash":"ac7753d536341aa824d7bce0332735e838916995","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/tags.styl","hash":"cbc0be5a3285b469858ec9ead48e2ea90bd47ae1","modified":1576826690157},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/copy-code.styl","hash":"688ca3eccc26727d050ad098b32b40934719588a","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/localsearch.styl","hash":"9fac89c8146eb2675721a26f528d7d0f8be7debe","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/math.styl","hash":"ef66c0a08e4243a25e41408d70ca66682b8dcea1","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/han.styl","hash":"7059e24235b7c57a07f3f8abaa06b0bd6a7eda2f","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/gitment.styl","hash":"f1d9ee1f86a179741f2478f8c70ca11ab578810e","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/needsharebutton.styl","hash":"61466e3e5459960b5802a267751a0c8018918b0b","modified":1576826690158},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/third-party.styl","hash":"03c4fa9573fddd930552784cf484fd2ee7825323","modified":1576826690159},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/related-posts.styl","hash":"3ae3f3c276d444862033fd3434c632ad0d2f84e6","modified":1576826690159},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1576826690179},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1576826690162},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1576826690179},{"_id":"themes/hexo-theme-next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1576826690182},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1576826690163},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1576826690162},{"_id":"themes/hexo-theme-next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1576826690178},{"_id":"public/search.xml","hash":"4b22a80a846af1c8e0a43c174365fec3cb630434","modified":1584588658839},{"_id":"public/404/index.html","hash":"e25a4594057422e260ff1d5fcf9793babe330452","modified":1584587676326},{"_id":"public/tags/index.html","hash":"d2a08c3e96b6ac31cbf45ecee6af5976e4a20897","modified":1584587676327},{"_id":"public/about/index.html","hash":"bb8b654b71e9d1065c7d7e57877299de4273c20c","modified":1584587676327},{"_id":"public/categories/index.html","hash":"7403ec9029a9ea0aa1c57c0e78a33aa5f4d8be5c","modified":1584587676326},{"_id":"public/2019/12/20/Ionic4开发备忘/index.html","hash":"7658d165534bd92e39d43a6297eebee88185493d","modified":1584588658854},{"_id":"public/2019/06/05/JavaScript前端对象数组排序核心方法（支持多列排序）/index.html","hash":"611b3b7deed23f5e22a5fd5e07046882e2b7f69f","modified":1584587676327},{"_id":"public/2019/05/09/前后端分离/index.html","hash":"2230e59108e25a8b1c2ce97617f53e57ff7eb1a3","modified":1584587676327},{"_id":"public/2015/10/13/SpringMVC整合WebSocket/index.html","hash":"22b4cac11fcc1a4df5f330b46ea816f6e9228438","modified":1584587676327},{"_id":"public/archives/index.html","hash":"552828d3c4de60af647e56b4d11dd3d89b7c52b0","modified":1584587676327},{"_id":"public/archives/2015/index.html","hash":"a5f466d7595273aad683e18955d611da7b78b218","modified":1584587676327},{"_id":"public/2015/07/07/Phonegap-jQueryMobile-在线应用拍照、相册选择上传-预览/index.html","hash":"5cebd457d403310211a88af393046050cce7402b","modified":1584587676327},{"_id":"public/archives/2015/07/index.html","hash":"1d097a9dd0d9a844362343ef78c890c15d970a34","modified":1584587676327},{"_id":"public/archives/2015/10/index.html","hash":"710140d008fda09912a213fd7e6954d2ce72b330","modified":1584587676327},{"_id":"public/archives/2019/index.html","hash":"91fcb06c8192a54944ffdfa73227224f8a556350","modified":1584587676327},{"_id":"public/archives/2019/05/index.html","hash":"4dfc197cd52c60055a51b922b352f094d08b77a5","modified":1584587676327},{"_id":"public/archives/2019/06/index.html","hash":"29276167f8b1289a95b75785dc290e3c89b17063","modified":1584587676327},{"_id":"public/archives/2019/12/index.html","hash":"58f7c1d1013305fc4815284837fc155cf9de47f8","modified":1584587676328},{"_id":"public/index.html","hash":"543c4c3f9f8035199e5a9fd200b47ca1f0fc6a81","modified":1584588658854},{"_id":"public/tags/JavaScript/index.html","hash":"abd87fe81400410a356552c6f1ef0fbcd460f8bd","modified":1584587676328},{"_id":"public/tags/框架/index.html","hash":"10e8e52e5bee938b5ce25d3b6b5f0cb45db2b758","modified":1584587676328},{"_id":"public/tags/WebApp/index.html","hash":"4255d0ab1d3ad4a08b290a5624f92b9e9764972a","modified":1584587676328},{"_id":"public/tags/Java/index.html","hash":"7babb5ad424e3d343ea9f9b8c649a0814f83308c","modified":1584587676328},{"_id":"public/tags/WebSocket/index.html","hash":"2151e66888dbb9da2c3d801b0ca62f08f85a8e6a","modified":1584587676328},{"_id":"public/CNAME","hash":"9c974641389c6398f84f5f30a1fe4140c5345180","modified":1576826842264},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1576826842265},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1576826842265},{"_id":"public/images/avatar.jpeg","hash":"4d643d3f6c7e015d65c4d933affb19db93d5dcbb","modified":1576826842265},{"_id":"public/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1576826842265},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1576826842265},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1576826842265},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1576826842265},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1576826842265},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1576826842265},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1576826842265},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1576826842265},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1576826842265},{"_id":"public/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1576826842265},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1576826842265},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1576826842265},{"_id":"public/images/searchicon.png","hash":"025d64ba0160a3a2257dd2b3032b5f7c9dd9b82b","modified":1576826842265},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1576826842265},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1576826842265},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1576826842699},{"_id":"public/images/favicon-16x16-next.png","hash":"5bb78ac413ed6d53f62876b2fb0b8b1641cdefde","modified":1576826842700},{"_id":"public/images/favicon-32x32-next.png","hash":"5bb78ac413ed6d53f62876b2fb0b8b1641cdefde","modified":1576826842700},{"_id":"public/images/pay/wechatpay.png","hash":"f363c8527102fd96c8cd0314d5c92ef2ed5264c8","modified":1576826842700},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1576826842700},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1576826842700},{"_id":"public/js/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1576826842704},{"_id":"public/js/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1576826842704},{"_id":"public/js/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1576826842704},{"_id":"public/js/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1576826842704},{"_id":"public/js/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1576826842704},{"_id":"public/js/next-boot.js","hash":"e0615efab5f81ba0fd39c0527eac31144deac7ce","modified":1576826842705},{"_id":"public/js/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1576826842705},{"_id":"public/js/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1576826842705},{"_id":"public/js/schemes/muse.js","hash":"e9bfa6b343b67625f58757efce46ccdaac8f308c","modified":1576826842705},{"_id":"public/js/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1576826842705},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1576826842705},{"_id":"public/css/main.css","hash":"8427af789fb0ecf514e82737c3da1a4a903d066c","modified":1576826842705},{"_id":"public/images/pay/alipay.png","hash":"28d313b7f2538106f87585d90c4f00639deb84d6","modified":1576826842705},{"_id":"public/js/motion.js","hash":"a16bc0b701646bf6653484675f4d5dc0f892d184","modified":1576826842709},{"_id":"public/js/utils.js","hash":"81913c5f75d0949443833cf4269ad63bd7f9be6f","modified":1576826842709},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1576826842709},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1576826842709},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1576826842714},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1576826842719},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1576826842719},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1576826842719},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1576826842732},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1576826842741},{"_id":"public/tags/ionic/index.html","hash":"25b1017237ab8a796a2c1ef9b745b96d878c1624","modified":1584587676330}],"Category":[],"Data":[],"Page":[{"title":"404","date":"2019-05-10T18:02:38.000Z","comments":0,"_content":"<html>\n<head>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"https://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"/\" homePageName=\"返回主页\"></script>\n</body>\n</html>","source":"404/index.md","raw":"---\ntitle: 404\ndate: 2019-05-11 02:02:38\ncomments: false\n---\n<html>\n<head>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"https://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"/\" homePageName=\"返回主页\"></script>\n</body>\n</html>","updated":"2019-12-20T07:24:50.114Z","path":"404/index.html","layout":"page","_id":"ck4dtzkw90000emsoz8leari5","content":"<html><br><head><meta name=\"generator\" content=\"Hexo 3.8.0\"><br></head><br><body><br><script type=\"text/javascript\" src=\"https://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"返回主页\"></script><br></body><br></html>","site":{"data":{}},"excerpt":"","more":"<html><br><head><meta name=\"generator\" content=\"Hexo 3.8.0\"><br></head><br><body><br><script type=\"text/javascript\" src=\"https://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"返回主页\"></script><br></body><br></html>"},{"title":"文章分类","date":"2019-05-10T17:46:34.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: 文章分类\ndate: 2019-05-11 01:46:34\ntype: \"categories\"\ncomments: false\n---\n","updated":"2019-12-20T07:24:50.116Z","path":"categories/index.html","layout":"page","_id":"ck4dtzl1c0002emsobwlepzsk","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"标签","date":"2019-05-10T17:49:26.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ndate: 2019-05-11 01:49:26\ntype: \"tags\"\ncomments: false\n---\n","updated":"2019-12-20T07:24:50.116Z","path":"tags/index.html","layout":"page","_id":"ck4dtzl1f0004emso5iou0igw","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"关于我","date":"2019-05-10T17:42:56.000Z","disallow":true,"comments":1,"_content":"I'm Hllinc.\n\nEmail: hllinc@163.com\n","source":"about/index.md","raw":"---\ntitle: 关于我\ndate: 2019-05-11 01:42:56\ndisallow: true\ncomments: true\n---\nI'm Hllinc.\n\nEmail: hllinc@163.com\n","updated":"2019-12-20T07:41:21.936Z","path":"about/index.html","_id":"ck4dtzl1j0006emso56tvj344","layout":"page","content":"<p>I’m Hllinc.</p>\n<p>Email: <a href=\"mailto:hllinc@163.com\" target=\"_blank\" rel=\"noopener\">hllinc@163.com</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>I’m Hllinc.</p>\n<p>Email: <a href=\"mailto:hllinc@163.com\" target=\"_blank\" rel=\"noopener\">hllinc@163.com</a></p>\n"}],"Post":[{"title":"JavaScript前端对象数组排序核心方法（支持多列排序）","date":"2019-06-05T02:23:20.000Z","_content":"开箱即用工具代码：\n```javascript\n// 缓存当前数据\nvar tempDataArray = [{name:\"linc\",age:28},{name:\"linda\",age:26}];\n// 存储排序后的数据\nvar currentData = [];\n// 排序数组，支持多列排序\nvar orderArr = [{colName:\"name\",orderDir:\"desc\"}];\n// 生成排序脚本\nvar sortData = _generateByStr(orderArr);\ncurrentData = tempDataArray.concat();\ncurrentData.sort(eval(sortData));\n// 生成多列排序字符串方法\nfunction _generateByStr(tempDataArray) {\n\tvar arr = tempDataArray.concat();\n\tif (arr == null || arr.length == 0) {\n\t\treturn \"\";\n\t} else {\n\t\tif (arr.length > 1) {\n\t\t\tvar a = arr[0];\n\t\t\tarr.shift();\n\t\t\treturn \"_sortBy('\" + a.colName + \"','\" + a.orderDir + \"',\"\n\t\t\t\t\t+ _generateByStr(arr) + \")\";\n\t\t} else {\n\t\t\treturn \"_sortBy('\" + arr[0].colName + \"','\"\n\t\t\t\t\t+ arr[0].orderDir + \"')\";\n\t\t}\n\t}\n}\n// 排序主方法\nfunction _sortBy(name, dir, minor) {\n\treturn function(o, p) {\n\t\tvar a, b;\n\t\tif (o && p && typeof o === 'object' && typeof p === 'object') {\n\t\t\ta = o[name];\n\t\t\tb = p[name];\n\t\t\tif (a === b) {\n\t\t\t\treturn typeof minor === 'function' ? minor(o, p) : 0;\n\t\t\t}\n\t\t\tif (typeof a === typeof b) {\n\t\t\t\tif (dir == \"asc\") {\n\t\t\t\t\treturn a < b ? -1 : 1;\n\t\t\t\t} else {\n\t\t\t\t\treturn a > b ? -1 : 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (dir == \"desc\") {\n\t\t\t\treturn typeof a < typeof b ? -1 : 1;\n\t\t\t} else {\n\t\t\t\treturn typeof a > typeof b ? -1 : 1;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow(\"error\");\n\t\t}\n\t};\n}\n```","source":"_posts/JavaScript前端对象数组排序核心方法（支持多列排序）.md","raw":"---\ntitle: JavaScript前端对象数组排序核心方法（支持多列排序）\ndate: 2019-06-05 10:23:20\ntags:\n- JavaScript\ncategories:\n---\n开箱即用工具代码：\n```javascript\n// 缓存当前数据\nvar tempDataArray = [{name:\"linc\",age:28},{name:\"linda\",age:26}];\n// 存储排序后的数据\nvar currentData = [];\n// 排序数组，支持多列排序\nvar orderArr = [{colName:\"name\",orderDir:\"desc\"}];\n// 生成排序脚本\nvar sortData = _generateByStr(orderArr);\ncurrentData = tempDataArray.concat();\ncurrentData.sort(eval(sortData));\n// 生成多列排序字符串方法\nfunction _generateByStr(tempDataArray) {\n\tvar arr = tempDataArray.concat();\n\tif (arr == null || arr.length == 0) {\n\t\treturn \"\";\n\t} else {\n\t\tif (arr.length > 1) {\n\t\t\tvar a = arr[0];\n\t\t\tarr.shift();\n\t\t\treturn \"_sortBy('\" + a.colName + \"','\" + a.orderDir + \"',\"\n\t\t\t\t\t+ _generateByStr(arr) + \")\";\n\t\t} else {\n\t\t\treturn \"_sortBy('\" + arr[0].colName + \"','\"\n\t\t\t\t\t+ arr[0].orderDir + \"')\";\n\t\t}\n\t}\n}\n// 排序主方法\nfunction _sortBy(name, dir, minor) {\n\treturn function(o, p) {\n\t\tvar a, b;\n\t\tif (o && p && typeof o === 'object' && typeof p === 'object') {\n\t\t\ta = o[name];\n\t\t\tb = p[name];\n\t\t\tif (a === b) {\n\t\t\t\treturn typeof minor === 'function' ? minor(o, p) : 0;\n\t\t\t}\n\t\t\tif (typeof a === typeof b) {\n\t\t\t\tif (dir == \"asc\") {\n\t\t\t\t\treturn a < b ? -1 : 1;\n\t\t\t\t} else {\n\t\t\t\t\treturn a > b ? -1 : 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (dir == \"desc\") {\n\t\t\t\treturn typeof a < typeof b ? -1 : 1;\n\t\t\t} else {\n\t\t\t\treturn typeof a > typeof b ? -1 : 1;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow(\"error\");\n\t\t}\n\t};\n}\n```","slug":"JavaScript前端对象数组排序核心方法（支持多列排序）","published":1,"updated":"2019-12-20T07:24:50.114Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck4dtzl180001emso44iw3ms7","content":"<p>开箱即用工具代码：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 缓存当前数据</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> tempDataArray = [&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"linc\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">28</span>&#125;,&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"linda\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">26</span>&#125;];</span><br><span class=\"line\"><span class=\"comment\">// 存储排序后的数据</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> currentData = [];</span><br><span class=\"line\"><span class=\"comment\">// 排序数组，支持多列排序</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> orderArr = [&#123;<span class=\"attr\">colName</span>:<span class=\"string\">\"name\"</span>,<span class=\"attr\">orderDir</span>:<span class=\"string\">\"desc\"</span>&#125;];</span><br><span class=\"line\"><span class=\"comment\">// 生成排序脚本</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> sortData = _generateByStr(orderArr);</span><br><span class=\"line\">currentData = tempDataArray.concat();</span><br><span class=\"line\">currentData.sort(<span class=\"built_in\">eval</span>(sortData));</span><br><span class=\"line\"><span class=\"comment\">// 生成多列排序字符串方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_generateByStr</span>(<span class=\"params\">tempDataArray</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> arr = tempDataArray.concat();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (arr == <span class=\"literal\">null</span> || arr.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (arr.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> a = arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">\t\t\tarr.shift();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"_sortBy('\"</span> + a.colName + <span class=\"string\">\"','\"</span> + a.orderDir + <span class=\"string\">\"',\"</span></span><br><span class=\"line\">\t\t\t\t\t+ _generateByStr(arr) + <span class=\"string\">\")\"</span>;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"_sortBy('\"</span> + arr[<span class=\"number\">0</span>].colName + <span class=\"string\">\"','\"</span></span><br><span class=\"line\">\t\t\t\t\t+ arr[<span class=\"number\">0</span>].orderDir + <span class=\"string\">\"')\"</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 排序主方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_sortBy</span>(<span class=\"params\">name, dir, minor</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">o, p</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> a, b;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (o &amp;&amp; p &amp;&amp; <span class=\"keyword\">typeof</span> o === <span class=\"string\">'object'</span> &amp;&amp; <span class=\"keyword\">typeof</span> p === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">\t\t\ta = o[name];</span><br><span class=\"line\">\t\t\tb = p[name];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> minor === <span class=\"string\">'function'</span> ? minor(o, p) : <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (dir == <span class=\"string\">\"asc\"</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> a &gt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (dir == <span class=\"string\">\"desc\"</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &gt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">throw</span>(<span class=\"string\">\"error\"</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>开箱即用工具代码：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 缓存当前数据</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> tempDataArray = [&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"linc\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">28</span>&#125;,&#123;<span class=\"attr\">name</span>:<span class=\"string\">\"linda\"</span>,<span class=\"attr\">age</span>:<span class=\"number\">26</span>&#125;];</span><br><span class=\"line\"><span class=\"comment\">// 存储排序后的数据</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> currentData = [];</span><br><span class=\"line\"><span class=\"comment\">// 排序数组，支持多列排序</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> orderArr = [&#123;<span class=\"attr\">colName</span>:<span class=\"string\">\"name\"</span>,<span class=\"attr\">orderDir</span>:<span class=\"string\">\"desc\"</span>&#125;];</span><br><span class=\"line\"><span class=\"comment\">// 生成排序脚本</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> sortData = _generateByStr(orderArr);</span><br><span class=\"line\">currentData = tempDataArray.concat();</span><br><span class=\"line\">currentData.sort(<span class=\"built_in\">eval</span>(sortData));</span><br><span class=\"line\"><span class=\"comment\">// 生成多列排序字符串方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_generateByStr</span>(<span class=\"params\">tempDataArray</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> arr = tempDataArray.concat();</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (arr == <span class=\"literal\">null</span> || arr.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (arr.length &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> a = arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">\t\t\tarr.shift();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"_sortBy('\"</span> + a.colName + <span class=\"string\">\"','\"</span> + a.orderDir + <span class=\"string\">\"',\"</span></span><br><span class=\"line\">\t\t\t\t\t+ _generateByStr(arr) + <span class=\"string\">\")\"</span>;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"_sortBy('\"</span> + arr[<span class=\"number\">0</span>].colName + <span class=\"string\">\"','\"</span></span><br><span class=\"line\">\t\t\t\t\t+ arr[<span class=\"number\">0</span>].orderDir + <span class=\"string\">\"')\"</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 排序主方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">_sortBy</span>(<span class=\"params\">name, dir, minor</span>) </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">o, p</span>) </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> a, b;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (o &amp;&amp; p &amp;&amp; <span class=\"keyword\">typeof</span> o === <span class=\"string\">'object'</span> &amp;&amp; <span class=\"keyword\">typeof</span> p === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">\t\t\ta = o[name];</span><br><span class=\"line\">\t\t\tb = p[name];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (a === b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> minor === <span class=\"string\">'function'</span> ? minor(o, p) : <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> a === <span class=\"keyword\">typeof</span> b) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (dir == <span class=\"string\">\"asc\"</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> a &lt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> a &gt; b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (dir == <span class=\"string\">\"desc\"</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &lt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">typeof</span> a &gt; <span class=\"keyword\">typeof</span> b ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">throw</span>(<span class=\"string\">\"error\"</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n"},{"title":"前后端分离","date":"2019-05-09T14:07:00.000Z","_content":"## 代码管理方式\n\n## 开发配合方式\n\n## 部署方式","source":"_posts/前后端分离.md","raw":"---\ntitle: 前后端分离\ndate: 2019-05-09 22:07:00\ntags:\n- 框架\n---\n## 代码管理方式\n\n## 开发配合方式\n\n## 部署方式","slug":"前后端分离","published":1,"updated":"2019-12-20T07:24:50.116Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck4dtzl1e0003emsoiw7z12aa","content":"<h2 id=\"代码管理方式\"><a href=\"#代码管理方式\" class=\"headerlink\" title=\"代码管理方式\"></a>代码管理方式</h2><h2 id=\"开发配合方式\"><a href=\"#开发配合方式\" class=\"headerlink\" title=\"开发配合方式\"></a>开发配合方式</h2><h2 id=\"部署方式\"><a href=\"#部署方式\" class=\"headerlink\" title=\"部署方式\"></a>部署方式</h2>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"代码管理方式\"><a href=\"#代码管理方式\" class=\"headerlink\" title=\"代码管理方式\"></a>代码管理方式</h2><h2 id=\"开发配合方式\"><a href=\"#开发配合方式\" class=\"headerlink\" title=\"开发配合方式\"></a>开发配合方式</h2><h2 id=\"部署方式\"><a href=\"#部署方式\" class=\"headerlink\" title=\"部署方式\"></a>部署方式</h2>"},{"title":"Ionic4开发备忘","date":"2019-12-20T07:26:10.000Z","_content":"Ionic是一款跨平台开发App的框架，详细介绍见官网：[https://ionicframework.com](https://ionicframework.com/docs/cli)\n\n##环境搭建\n\n全局安装NodeJS和Ionic最新稳定版，安装命令如下：\n\n```\nnpm i -g cordova ionic\n```\n##新建项目\n\n初始化项目命令如下：\n\n```\nionic start myIonicApp tabs\n```\n其中的tabs为初始化项目模板，可选模板有blank,tabs,sidemenu,tutorial等，可以运行ionic start --list命令查看所有可用模板。\n##项目常用命令\n\n详细命令参考官网：[https://ionicframework.com/docs/cli](https://ionicframework.com/docs/cli)\n\n  1. 启动项目\n\nng serve -o\n\n  2. 编译项目\n```\nionic cordova prepare ios\nionic cordova prepare android\nionic cordova run android --prod --release\nionic cordova run ios --prod --release\nionic cordova build android --prod --release\nionic cordova build ios --prod --release\n```\n  3. 管理平台\n\n添加平台：\n\n```\nionic cordova platform add android\n```\n删除平台：\n```\ncordova platform rm ios\n```\n根据配置文件安装平台：\n```\ncordova prepare\n```\n  4. 管理插件\n\n添加插件：\n\n```\nionic cordova plugin add cordova-sqlite-storage\n```\n删除插件：\n```\nionic cordova plugin rm cordova-sqlite-storage\n```\n根据配置文件安装插件：\ncordova prepare\n\n  5. 自动创建代码命令\n```\nionic generate page pages/my-page\n```\n##路由传参\n\n路由传参只能传递字符串参数，不能为复杂对象，当然也可以将复杂对象转成json再通过路由进行传参，但这种方式不被推荐，某些情况下转换的对象json中存在特殊字符的话会直接影响路由功能。\n\n前端有localStorage这个比较强大的前端缓存工具，因为路由传参不适合传递复杂对象，我们还有一种方式就是将复杂对象存储在localStorage中，它的key放在路由参数中进行传递，然后到详情页面中通过这个key从localStorage中查询。显然，某些场景下也会出现下面的问题，但这的确是一个方法。关键前端缓存这块后面弄个专题说一下。\n\n在大部分场景中，比如查看订单列表中某一条数据的详细信息，通过路由传递一个id字段到详情页面就足够了，虽然前端可以缓存订单列表中已有的订单字段，但为了数据的准确性，这里还是推荐在详情页面根据id重新获取最新的详情数据。当然，得结合实际业务功能决定到底用何种方式。\n\n路由配置代码：\n\n```\nconst routes: Routes = [\n\t  {path: 'order-detail/:id', loadChildren: './pages/order-detail/order-detail.module#OrderDetailPageModule'}\n];\n```\n传递参数代码：\n```\n<ion-item routerLink=\"/order-detail/3\"></ion-item>\n```\n接收参数代码：\n```\nconstructor(private route: ActivatedRoute) {\n}\nngOnInit() {\n const id = this.route.snapshot.paramMap.get('id');\n}\n```\n##组件传参\n\n这里的组件传参就可以直接传递复杂参数，当然它同样不适合上面我们所说的查看详情等场景，但在以下场景中它将为我们带来极大的方便。\n\n涉及到流程表单的场景：用户在前端需要操作一个流程表单，分好几步，第一步干嘛，第二步干嘛，每一步都会在前端录入一些必要数据，而且这些数据可能在下一步的表单操作中要使用到，此时，组件传参就发挥了它的威力。\n\n在使用该component的module中需要配置entryComponents，代码如下：\n\n```\n@NgModule({\n declarations: [ReceiveOrderPage],\n entryComponents: [ReceiveOrderPage]\n})\n```\n在传递参数的component中代码如下：\n```\nconstructor(private modalCtrl: ModalController) {\n}\nasync receiveOrder() {\n const modal = await this.modalCtrl.create({\n   component: ReceiveOrderPage,\n   componentProps: {\n     params: {id: 1, name: 'hllinc'}\n   },\n   animated: true\n });\n return await modal.present();\n}\n```\n接收参数代码：\n```\nexport class ReceiveOrderPage implements OnInit {\n @Input() params;\n}\n<ion-content padding>\n <p>{{params.name}}</p>\n</ion-content>\n```\n##禁用菜单\n\n当我们使用menu功能时，一般会在全局添加menu左或右滑动唤出的功能，但在某些场景下，我们只希望在主页面中启用该功能，在子页面中禁用该功能，因为左右滑动在子页面可能会实现其他必要功能，此时我们需要在子页面中添加如下代码以禁用菜单唤出功能，代码如下：\n\n```\nconstructor(private menuCtrl: MenuController) {\n}\nionViewWillEnter() {\n this.menuCtrl.enable(false);\n}\n```\n##Flex布局\n\n某些情况下，采用Flex可以为布局带来更好的效果，css代码如下：\n\n```\n.dayPlat {\ndisplay: flex;\nflex-wrap: wrap;\nflex-direction: row;\nalign-content: flex-start;\n.day {\n font-size: 14px;\n width: 60px;\n height: 60px;\n text-align: center;\n line-height: 60px;\n margin: 10px;\n border: 1px solid #dddddd;\n color: #555;\n -webkit-border-radius: 5px;\n -moz-border-radius: 5px;\n border-radius: 5px;\n} \n```\n效果如下图所示：\n![图片](https://uploader.shimo.im/f/a1oAw02RFIw8UdD6.png!thumbnail)\n\n##Modal窗口\n\n对于一些页面的打开方式我们可能不需要像普通页面那样具有返回功能，在打开的页面中提供一个关闭按钮，并且打开效果也不像普通页面那样从右向左滑入，而是具有弹出效果的打开，以达到提醒用户当前打开页面中的内容很重要的目的。比如，协议页面、登录/注册页面等。\n\n打开Modal窗口，代码如下：\n\n```\nconstructor(private modalCtrl: ModalController) {\n}\nasync openProtocol() {\n const modal = await this.modalCtrl.create({\n   component: ProtocolPage\n });\n return await modal.present();\n}\n```\n关闭Modal窗口需要在打开的component中添加如下代码：\n```\n<ion-button color=\"primary\" (click)=\"closeModal()\">\n <ion-icon name=\"close\" color=\"light\"></ion-icon>\n</ion-button>\nconstructor(private modalCtrl: ModalController) { }\ncloseModal() {\n this.modalCtrl.dismiss();\n}\n```\n当然，这个modal中的component也是可以进行传参的，方式同组件传参。\n##拍照\n\n脚本代码如下：\n\n```\nimport {Component, OnInit} from '@angular/core';\nimport {Camera, CameraOptions} from '@ionic-native/camera/ngx';\n@Component({\n selector: 'app-camera',\n templateUrl: './camera.page.html',\n styleUrls: ['./camera.page.scss'],\n})\nexport class CameraPage implements OnInit {\n imageData;\n constructor(private camera: Camera) {\n }\n ngOnInit() {\n }\n takePhone() {\n   const options: CameraOptions = {\n     quality: 100,\n     destinationType: this.camera.DestinationType.DATA_URL,\n     encodingType: this.camera.EncodingType.JPEG,\n     mediaType: this.camera.MediaType.PICTURE\n   };\n   this.camera.getPicture(options).then((imageData) => {\n     // imageData is either a base64 encoded string or a file URI\n     // If it's base64 (DATA_URL)\n     let base64Image = 'data:image/jpeg;base64,' + imageData;\n     this.imageData = base64Image;\n   }, (err) => {\n     // Handle error\n   });\n }\n}\n```\n视图代码如下：\n```\n<ion-header>\n <ion-toolbar>\n   <ion-buttons slot=\"start\">\n     <ion-back-button [text]=\"'返回'\"></ion-back-button>\n   </ion-buttons>\n   <ion-title>camera</ion-title>\n </ion-toolbar>\n</ion-header>\n<ion-content padding>\n <ion-button (click)=\"takePhone()\">拍照</ion-button>\n <ion-img [src]=\"imageData\"></ion-img>\n</ion-content>\n```\n##生命周期\n\nIonic4中的生命周期函数和angualr7基本是一样的，下面我们看看Ionic4中的生命周期函数，以及生命周期函数的用法。  \n\n**Ionic4中内置的生命周期函数：**\n\n**ionViewWillEnter **—当进入一个页面时触发(如果它从堆栈返回)\n\n**ionViewDidEnter **—进入后触发\n\n**ionViewWillLeave **—如果页面将离开触发\n\n**ionViewDidLeave **— 在页面离开后触发\n\n**ionViewWillUnload **— 在Angular中没有触发，因为这里你必须使用ngOnDestroy\n\n**Ionic4中使用Angular生命周期函数：**\n\n1、Ionic4中的生命周期函数**ngOnChanges **当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)\n\n2、Ionic4中的生命周期函数**ngOnInit **请求数据一般放在这个里面  （重要*）\n\n3、Ionic4中的生命周期函数**ngDoCheck** 检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应\n\n4、Ionic4中的生命周期函数 **ngAfterContentInit **当把内容投影进组件之后调用\n\n5、Ionic4中的生命周期函数 **ngAfterContentChecked **每次完成被投影组件内容的变更检测之后调用\n\n6、Ionic4中的生命周期函数 **ngAfterViewInit  **初始化完组件视图及其子视图之后调用（dom操作放在这个里面） （重要）\n\n7、Ionic4中的生命周期函数 **ngAfterViewInit**  每次做完组件视图和子视图的变更检测之后调用\n\n8、Ionic4中的生命周期函数  **ngOnDestroy  **组件销毁后执行 （重要）\n\n```\nconstructor() { \n  console.log('00构造函数执行了---除了使用简单的值对局部变量进行初始化之外，什么都不应该做')\n}\nngOnChanges() {\n  console.log('01ngOnChages执行了---当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)'); \n}\nngOnInit() {\n    console.log('02ngOnInit执行了--- 请求数据一般放在这个里面');     \n}\nngDoCheck() {\n    //写一些自定义的操作\n    console.log('03ngDoCheck执行了---检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应');\n    if(this.userinfo!==this.oldUserinfo){\n        console.log(`你从${this.oldUserinfo}改成${this.userinfo}`);\n        this.oldUserinfo = this.userinfo;\n    }else{            \n        console.log(\"数据没有变化\");          \n    }\n}\nngAfterContentInit() {\n    console.log('04ngAfterContentInit执行了---当把内容投影进组件之后调用');\n}\nngAfterContentChecked() {\n    console.log('05ngAfterContentChecked执行了---每次完成被投影组件内容的变更检测之后调用');\n}\nngAfterViewInit(): void {     \n    console.log('06 ngAfterViewInit执行了----初始化完组件视图及其子视图之后调用（dom操作放在这个里面）');\n}\nngAfterViewChecked() {\n    console.log('07ngAfterViewChecked执行了----每次做完组件视图和子视图的变更检测之后调用');\n}\nngOnDestroy() {\n    console.log('08ngOnDestroy执行了····');\n}\n```\nIonic4内置生命周期函数使用demo\n```\nexport class Page01 implements OnInit {\n  constructor() { \n  }\n  ngOnInit() {\n  }\n  ionViewWillEnter(){\n    console.log('ionViewWillEnter');\n  }\n  ionViewDidEnter(){\n    console.log('ionViewDidEnter');\n  }\n}\n```\n注：本章节内容转载自网络：[http://www.ionic.wang/article-index-id-169.html](http://www.ionic.wang/article-index-id-169.html)\n##地图\n\n集成高德地图。\n\n##修改应用图标\n  1. 命令\n```\nionic cordova resources\nionic cordova resources --icon\nionic cordova resources --splash\n```\n  2. 准备\n* 准备一张大小为1024*1024的图片文件作为APP的图标（命名：icon）\n* 准备一张大小为2732 * 2732(ionic2为2208 * 2208)的图片作为APP的启动界面（命名：splash）\n* 两张图片的格式为png、psd或ai都可\n  3. 修改方法\n\n1.将准备好的两张图片（注意分辨率和图片格式）替换到web-app目录下的resources文件夹下。\n\n2.执行ionic cordova resources命令，或分别执行ionic cordova resources --icon和ionic cordova resources --splash。\n\n  4. 说明\n\n一般执行第一条命令（ionic cordova resources）即可，如失败（一般都是网络问题，有的是图片问题），网络问题：执行后第二、三条命令（ionic cordova resources --icon和ionic cordova resources --splash），图片问题：修改或更换图片。\n\n如果在启动界面不显示“小圆圈”（进度圈），修改config.xml文件<preference name=\"ShowSplashScreenSpinner\" value=\"false\" />的value为false，为true为显示。如下图：\n\n![图片](https://uploader.shimo.im/f/km1Id4yU07spcNeL.png!thumbnail)\n\n  5. 其他\n\nconfig.xml配置说明：\n\n```\n<preference name=\"webviewbounce\" value=\"false\" />\n<preference name=\"UIWebViewBounce\" value=\"false\" />\n<preference name=\"DisallowOverscroll\" value=\"true\" />\n<preference name=\"android-minSdkVersion\" value=\"16\" />\n<preference name=\"BackupWebStorage\" value=\"none\" />\n<preference name=\"ShowSplashScreen\" value=\"true\" />\n<preference name=\"AutoHideSplashScreen\" value=\"false\" />\n<preference name=\"ShowSplashScreenSpinner\" value=\"false\" />\n<preference name=\"SplashMaintainAspectRatio\" value=\"true\" />\n<preference name=\"FadeSplashScreenDuration\" value=\"300\" />\n<preference name=\"SplashShowOnlyFirstTime\" value=\"false\" />\n<preference name=\"SplashScreen\" value=\"screen\" />\n<preference name=\"SplashScreenDelay\" value=\"1500\" />\n<preference name=\"Fullscreen\" value=\"true\" />\n<preference name=\"Orientation\" value=\"landscape\" />\n<preference name=\"android-minSdkVersion\" value=\"16\" />\n android最小sdk版本\n\n <preference name=\"BackupWebStorage\" value=\"none\" />\n 网络备份存储\n\n <preference name=\"ShowSplashScreen\" value=\"true\" />\n 显示启动界面\n\n <preference name=\"AutoHideSplashScreen\" value=\"false\" />\n 自动隐藏启动界面\n\n <preference name=\"ShowSplashScreenSpinner\" value=\"false\" />\n 显示启动界面的进度圈\n\n <preference name=\"SplashMaintainAspectRatio\" value=\"true\" />\n 屏幕保持长宽比\n\n <preference name=\"FadeSplashScreenDuration\" value=\"300\" />\n 启动界面消失延迟\n\n <preference name=\"SplashShowOnlyFirstTime\" value=\"false\" />\n 启动界面只在第一次显示\n\n <preference name=\"SplashScreen\" value=\"screen\" />\n 启动界面\n\n <preference name=\"SplashScreenDelay\" value=\"1500\" />\n 启动界面延迟\n\n <preference name=\"Fullscreen\" value=\"false\" />\n 全屏显示\n\n <preference name=\"Orientation\" value=\"landscape\" />\n 屏幕方向。Orientation设置可以让你锁定应用程序屏幕方向以阻止屏幕自动翻转。可选的值有：default，landscape(横屏)，portrait(竖屏)。\n```\n","source":"_posts/Ionic4开发备忘.md","raw":"---\ntitle: Ionic4开发备忘\ndate: 2019-12-20 15:26:10\ntags: ionic\ncategories:\n---\nIonic是一款跨平台开发App的框架，详细介绍见官网：[https://ionicframework.com](https://ionicframework.com/docs/cli)\n\n##环境搭建\n\n全局安装NodeJS和Ionic最新稳定版，安装命令如下：\n\n```\nnpm i -g cordova ionic\n```\n##新建项目\n\n初始化项目命令如下：\n\n```\nionic start myIonicApp tabs\n```\n其中的tabs为初始化项目模板，可选模板有blank,tabs,sidemenu,tutorial等，可以运行ionic start --list命令查看所有可用模板。\n##项目常用命令\n\n详细命令参考官网：[https://ionicframework.com/docs/cli](https://ionicframework.com/docs/cli)\n\n  1. 启动项目\n\nng serve -o\n\n  2. 编译项目\n```\nionic cordova prepare ios\nionic cordova prepare android\nionic cordova run android --prod --release\nionic cordova run ios --prod --release\nionic cordova build android --prod --release\nionic cordova build ios --prod --release\n```\n  3. 管理平台\n\n添加平台：\n\n```\nionic cordova platform add android\n```\n删除平台：\n```\ncordova platform rm ios\n```\n根据配置文件安装平台：\n```\ncordova prepare\n```\n  4. 管理插件\n\n添加插件：\n\n```\nionic cordova plugin add cordova-sqlite-storage\n```\n删除插件：\n```\nionic cordova plugin rm cordova-sqlite-storage\n```\n根据配置文件安装插件：\ncordova prepare\n\n  5. 自动创建代码命令\n```\nionic generate page pages/my-page\n```\n##路由传参\n\n路由传参只能传递字符串参数，不能为复杂对象，当然也可以将复杂对象转成json再通过路由进行传参，但这种方式不被推荐，某些情况下转换的对象json中存在特殊字符的话会直接影响路由功能。\n\n前端有localStorage这个比较强大的前端缓存工具，因为路由传参不适合传递复杂对象，我们还有一种方式就是将复杂对象存储在localStorage中，它的key放在路由参数中进行传递，然后到详情页面中通过这个key从localStorage中查询。显然，某些场景下也会出现下面的问题，但这的确是一个方法。关键前端缓存这块后面弄个专题说一下。\n\n在大部分场景中，比如查看订单列表中某一条数据的详细信息，通过路由传递一个id字段到详情页面就足够了，虽然前端可以缓存订单列表中已有的订单字段，但为了数据的准确性，这里还是推荐在详情页面根据id重新获取最新的详情数据。当然，得结合实际业务功能决定到底用何种方式。\n\n路由配置代码：\n\n```\nconst routes: Routes = [\n\t  {path: 'order-detail/:id', loadChildren: './pages/order-detail/order-detail.module#OrderDetailPageModule'}\n];\n```\n传递参数代码：\n```\n<ion-item routerLink=\"/order-detail/3\"></ion-item>\n```\n接收参数代码：\n```\nconstructor(private route: ActivatedRoute) {\n}\nngOnInit() {\n const id = this.route.snapshot.paramMap.get('id');\n}\n```\n##组件传参\n\n这里的组件传参就可以直接传递复杂参数，当然它同样不适合上面我们所说的查看详情等场景，但在以下场景中它将为我们带来极大的方便。\n\n涉及到流程表单的场景：用户在前端需要操作一个流程表单，分好几步，第一步干嘛，第二步干嘛，每一步都会在前端录入一些必要数据，而且这些数据可能在下一步的表单操作中要使用到，此时，组件传参就发挥了它的威力。\n\n在使用该component的module中需要配置entryComponents，代码如下：\n\n```\n@NgModule({\n declarations: [ReceiveOrderPage],\n entryComponents: [ReceiveOrderPage]\n})\n```\n在传递参数的component中代码如下：\n```\nconstructor(private modalCtrl: ModalController) {\n}\nasync receiveOrder() {\n const modal = await this.modalCtrl.create({\n   component: ReceiveOrderPage,\n   componentProps: {\n     params: {id: 1, name: 'hllinc'}\n   },\n   animated: true\n });\n return await modal.present();\n}\n```\n接收参数代码：\n```\nexport class ReceiveOrderPage implements OnInit {\n @Input() params;\n}\n<ion-content padding>\n <p>{{params.name}}</p>\n</ion-content>\n```\n##禁用菜单\n\n当我们使用menu功能时，一般会在全局添加menu左或右滑动唤出的功能，但在某些场景下，我们只希望在主页面中启用该功能，在子页面中禁用该功能，因为左右滑动在子页面可能会实现其他必要功能，此时我们需要在子页面中添加如下代码以禁用菜单唤出功能，代码如下：\n\n```\nconstructor(private menuCtrl: MenuController) {\n}\nionViewWillEnter() {\n this.menuCtrl.enable(false);\n}\n```\n##Flex布局\n\n某些情况下，采用Flex可以为布局带来更好的效果，css代码如下：\n\n```\n.dayPlat {\ndisplay: flex;\nflex-wrap: wrap;\nflex-direction: row;\nalign-content: flex-start;\n.day {\n font-size: 14px;\n width: 60px;\n height: 60px;\n text-align: center;\n line-height: 60px;\n margin: 10px;\n border: 1px solid #dddddd;\n color: #555;\n -webkit-border-radius: 5px;\n -moz-border-radius: 5px;\n border-radius: 5px;\n} \n```\n效果如下图所示：\n![图片](https://uploader.shimo.im/f/a1oAw02RFIw8UdD6.png!thumbnail)\n\n##Modal窗口\n\n对于一些页面的打开方式我们可能不需要像普通页面那样具有返回功能，在打开的页面中提供一个关闭按钮，并且打开效果也不像普通页面那样从右向左滑入，而是具有弹出效果的打开，以达到提醒用户当前打开页面中的内容很重要的目的。比如，协议页面、登录/注册页面等。\n\n打开Modal窗口，代码如下：\n\n```\nconstructor(private modalCtrl: ModalController) {\n}\nasync openProtocol() {\n const modal = await this.modalCtrl.create({\n   component: ProtocolPage\n });\n return await modal.present();\n}\n```\n关闭Modal窗口需要在打开的component中添加如下代码：\n```\n<ion-button color=\"primary\" (click)=\"closeModal()\">\n <ion-icon name=\"close\" color=\"light\"></ion-icon>\n</ion-button>\nconstructor(private modalCtrl: ModalController) { }\ncloseModal() {\n this.modalCtrl.dismiss();\n}\n```\n当然，这个modal中的component也是可以进行传参的，方式同组件传参。\n##拍照\n\n脚本代码如下：\n\n```\nimport {Component, OnInit} from '@angular/core';\nimport {Camera, CameraOptions} from '@ionic-native/camera/ngx';\n@Component({\n selector: 'app-camera',\n templateUrl: './camera.page.html',\n styleUrls: ['./camera.page.scss'],\n})\nexport class CameraPage implements OnInit {\n imageData;\n constructor(private camera: Camera) {\n }\n ngOnInit() {\n }\n takePhone() {\n   const options: CameraOptions = {\n     quality: 100,\n     destinationType: this.camera.DestinationType.DATA_URL,\n     encodingType: this.camera.EncodingType.JPEG,\n     mediaType: this.camera.MediaType.PICTURE\n   };\n   this.camera.getPicture(options).then((imageData) => {\n     // imageData is either a base64 encoded string or a file URI\n     // If it's base64 (DATA_URL)\n     let base64Image = 'data:image/jpeg;base64,' + imageData;\n     this.imageData = base64Image;\n   }, (err) => {\n     // Handle error\n   });\n }\n}\n```\n视图代码如下：\n```\n<ion-header>\n <ion-toolbar>\n   <ion-buttons slot=\"start\">\n     <ion-back-button [text]=\"'返回'\"></ion-back-button>\n   </ion-buttons>\n   <ion-title>camera</ion-title>\n </ion-toolbar>\n</ion-header>\n<ion-content padding>\n <ion-button (click)=\"takePhone()\">拍照</ion-button>\n <ion-img [src]=\"imageData\"></ion-img>\n</ion-content>\n```\n##生命周期\n\nIonic4中的生命周期函数和angualr7基本是一样的，下面我们看看Ionic4中的生命周期函数，以及生命周期函数的用法。  \n\n**Ionic4中内置的生命周期函数：**\n\n**ionViewWillEnter **—当进入一个页面时触发(如果它从堆栈返回)\n\n**ionViewDidEnter **—进入后触发\n\n**ionViewWillLeave **—如果页面将离开触发\n\n**ionViewDidLeave **— 在页面离开后触发\n\n**ionViewWillUnload **— 在Angular中没有触发，因为这里你必须使用ngOnDestroy\n\n**Ionic4中使用Angular生命周期函数：**\n\n1、Ionic4中的生命周期函数**ngOnChanges **当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)\n\n2、Ionic4中的生命周期函数**ngOnInit **请求数据一般放在这个里面  （重要*）\n\n3、Ionic4中的生命周期函数**ngDoCheck** 检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应\n\n4、Ionic4中的生命周期函数 **ngAfterContentInit **当把内容投影进组件之后调用\n\n5、Ionic4中的生命周期函数 **ngAfterContentChecked **每次完成被投影组件内容的变更检测之后调用\n\n6、Ionic4中的生命周期函数 **ngAfterViewInit  **初始化完组件视图及其子视图之后调用（dom操作放在这个里面） （重要）\n\n7、Ionic4中的生命周期函数 **ngAfterViewInit**  每次做完组件视图和子视图的变更检测之后调用\n\n8、Ionic4中的生命周期函数  **ngOnDestroy  **组件销毁后执行 （重要）\n\n```\nconstructor() { \n  console.log('00构造函数执行了---除了使用简单的值对局部变量进行初始化之外，什么都不应该做')\n}\nngOnChanges() {\n  console.log('01ngOnChages执行了---当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)'); \n}\nngOnInit() {\n    console.log('02ngOnInit执行了--- 请求数据一般放在这个里面');     \n}\nngDoCheck() {\n    //写一些自定义的操作\n    console.log('03ngDoCheck执行了---检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应');\n    if(this.userinfo!==this.oldUserinfo){\n        console.log(`你从${this.oldUserinfo}改成${this.userinfo}`);\n        this.oldUserinfo = this.userinfo;\n    }else{            \n        console.log(\"数据没有变化\");          \n    }\n}\nngAfterContentInit() {\n    console.log('04ngAfterContentInit执行了---当把内容投影进组件之后调用');\n}\nngAfterContentChecked() {\n    console.log('05ngAfterContentChecked执行了---每次完成被投影组件内容的变更检测之后调用');\n}\nngAfterViewInit(): void {     \n    console.log('06 ngAfterViewInit执行了----初始化完组件视图及其子视图之后调用（dom操作放在这个里面）');\n}\nngAfterViewChecked() {\n    console.log('07ngAfterViewChecked执行了----每次做完组件视图和子视图的变更检测之后调用');\n}\nngOnDestroy() {\n    console.log('08ngOnDestroy执行了····');\n}\n```\nIonic4内置生命周期函数使用demo\n```\nexport class Page01 implements OnInit {\n  constructor() { \n  }\n  ngOnInit() {\n  }\n  ionViewWillEnter(){\n    console.log('ionViewWillEnter');\n  }\n  ionViewDidEnter(){\n    console.log('ionViewDidEnter');\n  }\n}\n```\n注：本章节内容转载自网络：[http://www.ionic.wang/article-index-id-169.html](http://www.ionic.wang/article-index-id-169.html)\n##地图\n\n集成高德地图。\n\n##修改应用图标\n  1. 命令\n```\nionic cordova resources\nionic cordova resources --icon\nionic cordova resources --splash\n```\n  2. 准备\n* 准备一张大小为1024*1024的图片文件作为APP的图标（命名：icon）\n* 准备一张大小为2732 * 2732(ionic2为2208 * 2208)的图片作为APP的启动界面（命名：splash）\n* 两张图片的格式为png、psd或ai都可\n  3. 修改方法\n\n1.将准备好的两张图片（注意分辨率和图片格式）替换到web-app目录下的resources文件夹下。\n\n2.执行ionic cordova resources命令，或分别执行ionic cordova resources --icon和ionic cordova resources --splash。\n\n  4. 说明\n\n一般执行第一条命令（ionic cordova resources）即可，如失败（一般都是网络问题，有的是图片问题），网络问题：执行后第二、三条命令（ionic cordova resources --icon和ionic cordova resources --splash），图片问题：修改或更换图片。\n\n如果在启动界面不显示“小圆圈”（进度圈），修改config.xml文件<preference name=\"ShowSplashScreenSpinner\" value=\"false\" />的value为false，为true为显示。如下图：\n\n![图片](https://uploader.shimo.im/f/km1Id4yU07spcNeL.png!thumbnail)\n\n  5. 其他\n\nconfig.xml配置说明：\n\n```\n<preference name=\"webviewbounce\" value=\"false\" />\n<preference name=\"UIWebViewBounce\" value=\"false\" />\n<preference name=\"DisallowOverscroll\" value=\"true\" />\n<preference name=\"android-minSdkVersion\" value=\"16\" />\n<preference name=\"BackupWebStorage\" value=\"none\" />\n<preference name=\"ShowSplashScreen\" value=\"true\" />\n<preference name=\"AutoHideSplashScreen\" value=\"false\" />\n<preference name=\"ShowSplashScreenSpinner\" value=\"false\" />\n<preference name=\"SplashMaintainAspectRatio\" value=\"true\" />\n<preference name=\"FadeSplashScreenDuration\" value=\"300\" />\n<preference name=\"SplashShowOnlyFirstTime\" value=\"false\" />\n<preference name=\"SplashScreen\" value=\"screen\" />\n<preference name=\"SplashScreenDelay\" value=\"1500\" />\n<preference name=\"Fullscreen\" value=\"true\" />\n<preference name=\"Orientation\" value=\"landscape\" />\n<preference name=\"android-minSdkVersion\" value=\"16\" />\n android最小sdk版本\n\n <preference name=\"BackupWebStorage\" value=\"none\" />\n 网络备份存储\n\n <preference name=\"ShowSplashScreen\" value=\"true\" />\n 显示启动界面\n\n <preference name=\"AutoHideSplashScreen\" value=\"false\" />\n 自动隐藏启动界面\n\n <preference name=\"ShowSplashScreenSpinner\" value=\"false\" />\n 显示启动界面的进度圈\n\n <preference name=\"SplashMaintainAspectRatio\" value=\"true\" />\n 屏幕保持长宽比\n\n <preference name=\"FadeSplashScreenDuration\" value=\"300\" />\n 启动界面消失延迟\n\n <preference name=\"SplashShowOnlyFirstTime\" value=\"false\" />\n 启动界面只在第一次显示\n\n <preference name=\"SplashScreen\" value=\"screen\" />\n 启动界面\n\n <preference name=\"SplashScreenDelay\" value=\"1500\" />\n 启动界面延迟\n\n <preference name=\"Fullscreen\" value=\"false\" />\n 全屏显示\n\n <preference name=\"Orientation\" value=\"landscape\" />\n 屏幕方向。Orientation设置可以让你锁定应用程序屏幕方向以阻止屏幕自动翻转。可选的值有：default，landscape(横屏)，portrait(竖屏)。\n```\n","slug":"Ionic4开发备忘","published":1,"updated":"2020-03-19T03:30:18.288Z","_id":"ck4dtzl2d000aemsoi33td0kg","comments":1,"layout":"post","photos":[],"link":"","content":"<p>Ionic是一款跨平台开发App的框架，详细介绍见官网：<a href=\"https://ionicframework.com/docs/cli\" target=\"_blank\" rel=\"noopener\">https://ionicframework.com</a></p>\n<p>##环境搭建</p>\n<p>全局安装NodeJS和Ionic最新稳定版，安装命令如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -g cordova ionic</span><br></pre></td></tr></table></figure>\n<p>##新建项目</p>\n<p>初始化项目命令如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic start myIonicApp tabs</span><br></pre></td></tr></table></figure>\n<p>其中的tabs为初始化项目模板，可选模板有blank,tabs,sidemenu,tutorial等，可以运行ionic start –list命令查看所有可用模板。</p>\n<p>##项目常用命令</p>\n<p>详细命令参考官网：<a href=\"https://ionicframework.com/docs/cli\" target=\"_blank\" rel=\"noopener\">https://ionicframework.com/docs/cli</a></p>\n<ol>\n<li>启动项目</li>\n</ol>\n<p>ng serve -o</p>\n<ol start=\"2\">\n<li><p>编译项目</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova prepare ios</span><br><span class=\"line\">ionic cordova prepare android</span><br><span class=\"line\">ionic cordova run android --prod --release</span><br><span class=\"line\">ionic cordova run ios --prod --release</span><br><span class=\"line\">ionic cordova build android --prod --release</span><br><span class=\"line\">ionic cordova build ios --prod --release</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>管理平台</p>\n</li>\n</ol>\n<p>添加平台：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova platform add android</span><br></pre></td></tr></table></figure>\n<p>删除平台：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova platform rm ios</span><br></pre></td></tr></table></figure></p>\n<p>根据配置文件安装平台：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova prepare</span><br></pre></td></tr></table></figure></p>\n<ol start=\"4\">\n<li>管理插件</li>\n</ol>\n<p>添加插件：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova plugin add cordova-sqlite-storage</span><br></pre></td></tr></table></figure>\n<p>删除插件：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova plugin rm cordova-sqlite-storage</span><br></pre></td></tr></table></figure></p>\n<p>根据配置文件安装插件：<br>cordova prepare</p>\n<ol start=\"5\">\n<li>自动创建代码命令<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic generate page pages/my-page</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>##路由传参</p>\n<p>路由传参只能传递字符串参数，不能为复杂对象，当然也可以将复杂对象转成json再通过路由进行传参，但这种方式不被推荐，某些情况下转换的对象json中存在特殊字符的话会直接影响路由功能。</p>\n<p>前端有localStorage这个比较强大的前端缓存工具，因为路由传参不适合传递复杂对象，我们还有一种方式就是将复杂对象存储在localStorage中，它的key放在路由参数中进行传递，然后到详情页面中通过这个key从localStorage中查询。显然，某些场景下也会出现下面的问题，但这的确是一个方法。关键前端缓存这块后面弄个专题说一下。</p>\n<p>在大部分场景中，比如查看订单列表中某一条数据的详细信息，通过路由传递一个id字段到详情页面就足够了，虽然前端可以缓存订单列表中已有的订单字段，但为了数据的准确性，这里还是推荐在详情页面根据id重新获取最新的详情数据。当然，得结合实际业务功能决定到底用何种方式。</p>\n<p>路由配置代码：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const routes: Routes = [</span><br><span class=\"line\">\t  &#123;path: &apos;order-detail/:id&apos;, loadChildren: &apos;./pages/order-detail/order-detail.module#OrderDetailPageModule&apos;&#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n<p>传递参数代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ion-item routerLink=&quot;/order-detail/3&quot;&gt;&lt;/ion-item&gt;</span><br></pre></td></tr></table></figure></p>\n<p>接收参数代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private route: ActivatedRoute) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\"> const id = this.route.snapshot.paramMap.get(&apos;id&apos;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>##组件传参</p>\n<p>这里的组件传参就可以直接传递复杂参数，当然它同样不适合上面我们所说的查看详情等场景，但在以下场景中它将为我们带来极大的方便。</p>\n<p>涉及到流程表单的场景：用户在前端需要操作一个流程表单，分好几步，第一步干嘛，第二步干嘛，每一步都会在前端录入一些必要数据，而且这些数据可能在下一步的表单操作中要使用到，此时，组件传参就发挥了它的威力。</p>\n<p>在使用该component的module中需要配置entryComponents，代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@NgModule(&#123;</span><br><span class=\"line\"> declarations: [ReceiveOrderPage],</span><br><span class=\"line\"> entryComponents: [ReceiveOrderPage]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>在传递参数的component中代码如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private modalCtrl: ModalController) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">async receiveOrder() &#123;</span><br><span class=\"line\"> const modal = await this.modalCtrl.create(&#123;</span><br><span class=\"line\">   component: ReceiveOrderPage,</span><br><span class=\"line\">   componentProps: &#123;</span><br><span class=\"line\">     params: &#123;id: 1, name: &apos;hllinc&apos;&#125;</span><br><span class=\"line\">   &#125;,</span><br><span class=\"line\">   animated: true</span><br><span class=\"line\"> &#125;);</span><br><span class=\"line\"> return await modal.present();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>接收参数代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export class ReceiveOrderPage implements OnInit &#123;</span><br><span class=\"line\"> @Input() params;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;ion-content padding&gt;</span><br><span class=\"line\"> &lt;p&gt;&#123;&#123;params.name&#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">&lt;/ion-content&gt;</span><br></pre></td></tr></table></figure></p>\n<p>##禁用菜单</p>\n<p>当我们使用menu功能时，一般会在全局添加menu左或右滑动唤出的功能，但在某些场景下，我们只希望在主页面中启用该功能，在子页面中禁用该功能，因为左右滑动在子页面可能会实现其他必要功能，此时我们需要在子页面中添加如下代码以禁用菜单唤出功能，代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private menuCtrl: MenuController) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ionViewWillEnter() &#123;</span><br><span class=\"line\"> this.menuCtrl.enable(false);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>##Flex布局</p>\n<p>某些情况下，采用Flex可以为布局带来更好的效果，css代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.dayPlat &#123;</span><br><span class=\"line\">display: flex;</span><br><span class=\"line\">flex-wrap: wrap;</span><br><span class=\"line\">flex-direction: row;</span><br><span class=\"line\">align-content: flex-start;</span><br><span class=\"line\">.day &#123;</span><br><span class=\"line\"> font-size: 14px;</span><br><span class=\"line\"> width: 60px;</span><br><span class=\"line\"> height: 60px;</span><br><span class=\"line\"> text-align: center;</span><br><span class=\"line\"> line-height: 60px;</span><br><span class=\"line\"> margin: 10px;</span><br><span class=\"line\"> border: 1px solid #dddddd;</span><br><span class=\"line\"> color: #555;</span><br><span class=\"line\"> -webkit-border-radius: 5px;</span><br><span class=\"line\"> -moz-border-radius: 5px;</span><br><span class=\"line\"> border-radius: 5px;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>效果如下图所示：<br><img src=\"https://uploader.shimo.im/f/a1oAw02RFIw8UdD6.png!thumbnail\" alt=\"图片\"></p>\n<p>##Modal窗口</p>\n<p>对于一些页面的打开方式我们可能不需要像普通页面那样具有返回功能，在打开的页面中提供一个关闭按钮，并且打开效果也不像普通页面那样从右向左滑入，而是具有弹出效果的打开，以达到提醒用户当前打开页面中的内容很重要的目的。比如，协议页面、登录/注册页面等。</p>\n<p>打开Modal窗口，代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private modalCtrl: ModalController) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">async openProtocol() &#123;</span><br><span class=\"line\"> const modal = await this.modalCtrl.create(&#123;</span><br><span class=\"line\">   component: ProtocolPage</span><br><span class=\"line\"> &#125;);</span><br><span class=\"line\"> return await modal.present();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>关闭Modal窗口需要在打开的component中添加如下代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ion-button color=&quot;primary&quot; (click)=&quot;closeModal()&quot;&gt;</span><br><span class=\"line\"> &lt;ion-icon name=&quot;close&quot; color=&quot;light&quot;&gt;&lt;/ion-icon&gt;</span><br><span class=\"line\">&lt;/ion-button&gt;</span><br><span class=\"line\">constructor(private modalCtrl: ModalController) &#123; &#125;</span><br><span class=\"line\">closeModal() &#123;</span><br><span class=\"line\"> this.modalCtrl.dismiss();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>当然，这个modal中的component也是可以进行传参的，方式同组件传参。</p>\n<p>##拍照</p>\n<p>脚本代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123;Component, OnInit&#125; from &apos;@angular/core&apos;;</span><br><span class=\"line\">import &#123;Camera, CameraOptions&#125; from &apos;@ionic-native/camera/ngx&apos;;</span><br><span class=\"line\">@Component(&#123;</span><br><span class=\"line\"> selector: &apos;app-camera&apos;,</span><br><span class=\"line\"> templateUrl: &apos;./camera.page.html&apos;,</span><br><span class=\"line\"> styleUrls: [&apos;./camera.page.scss&apos;],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">export class CameraPage implements OnInit &#123;</span><br><span class=\"line\"> imageData;</span><br><span class=\"line\"> constructor(private camera: Camera) &#123;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> ngOnInit() &#123;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> takePhone() &#123;</span><br><span class=\"line\">   const options: CameraOptions = &#123;</span><br><span class=\"line\">     quality: 100,</span><br><span class=\"line\">     destinationType: this.camera.DestinationType.DATA_URL,</span><br><span class=\"line\">     encodingType: this.camera.EncodingType.JPEG,</span><br><span class=\"line\">     mediaType: this.camera.MediaType.PICTURE</span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\">   this.camera.getPicture(options).then((imageData) =&gt; &#123;</span><br><span class=\"line\">     // imageData is either a base64 encoded string or a file URI</span><br><span class=\"line\">     // If it&apos;s base64 (DATA_URL)</span><br><span class=\"line\">     let base64Image = &apos;data:image/jpeg;base64,&apos; + imageData;</span><br><span class=\"line\">     this.imageData = base64Image;</span><br><span class=\"line\">   &#125;, (err) =&gt; &#123;</span><br><span class=\"line\">     // Handle error</span><br><span class=\"line\">   &#125;);</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>视图代码如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ion-header&gt;</span><br><span class=\"line\"> &lt;ion-toolbar&gt;</span><br><span class=\"line\">   &lt;ion-buttons slot=&quot;start&quot;&gt;</span><br><span class=\"line\">     &lt;ion-back-button [text]=&quot;&apos;返回&apos;&quot;&gt;&lt;/ion-back-button&gt;</span><br><span class=\"line\">   &lt;/ion-buttons&gt;</span><br><span class=\"line\">   &lt;ion-title&gt;camera&lt;/ion-title&gt;</span><br><span class=\"line\"> &lt;/ion-toolbar&gt;</span><br><span class=\"line\">&lt;/ion-header&gt;</span><br><span class=\"line\">&lt;ion-content padding&gt;</span><br><span class=\"line\"> &lt;ion-button (click)=&quot;takePhone()&quot;&gt;拍照&lt;/ion-button&gt;</span><br><span class=\"line\"> &lt;ion-img [src]=&quot;imageData&quot;&gt;&lt;/ion-img&gt;</span><br><span class=\"line\">&lt;/ion-content&gt;</span><br></pre></td></tr></table></figure></p>\n<p>##生命周期</p>\n<p>Ionic4中的生命周期函数和angualr7基本是一样的，下面我们看看Ionic4中的生命周期函数，以及生命周期函数的用法。  </p>\n<p><strong>Ionic4中内置的生命周期函数：</strong></p>\n<p><strong>ionViewWillEnter </strong>—当进入一个页面时触发(如果它从堆栈返回)</p>\n<p><strong>ionViewDidEnter </strong>—进入后触发</p>\n<p><strong>ionViewWillLeave </strong>—如果页面将离开触发</p>\n<p><strong>ionViewDidLeave </strong>— 在页面离开后触发</p>\n<p><strong>ionViewWillUnload </strong>— 在Angular中没有触发，因为这里你必须使用ngOnDestroy</p>\n<p><strong>Ionic4中使用Angular生命周期函数：</strong></p>\n<p>1、Ionic4中的生命周期函数<strong>ngOnChanges </strong>当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)</p>\n<p>2、Ionic4中的生命周期函数<strong>ngOnInit </strong>请求数据一般放在这个里面  （重要*）</p>\n<p>3、Ionic4中的生命周期函数<strong>ngDoCheck</strong> 检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应</p>\n<p>4、Ionic4中的生命周期函数 <strong>ngAfterContentInit </strong>当把内容投影进组件之后调用</p>\n<p>5、Ionic4中的生命周期函数 <strong>ngAfterContentChecked </strong>每次完成被投影组件内容的变更检测之后调用</p>\n<p>6、Ionic4中的生命周期函数 <strong>ngAfterViewInit  </strong>初始化完组件视图及其子视图之后调用（dom操作放在这个里面） （重要）</p>\n<p>7、Ionic4中的生命周期函数 <strong>ngAfterViewInit</strong>  每次做完组件视图和子视图的变更检测之后调用</p>\n<p>8、Ionic4中的生命周期函数  <strong>ngOnDestroy  </strong>组件销毁后执行 （重要）</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor() &#123; </span><br><span class=\"line\">  console.log(&apos;00构造函数执行了---除了使用简单的值对局部变量进行初始化之外，什么都不应该做&apos;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnChanges() &#123;</span><br><span class=\"line\">  console.log(&apos;01ngOnChages执行了---当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)&apos;); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\">    console.log(&apos;02ngOnInit执行了--- 请求数据一般放在这个里面&apos;);     </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngDoCheck() &#123;</span><br><span class=\"line\">    //写一些自定义的操作</span><br><span class=\"line\">    console.log(&apos;03ngDoCheck执行了---检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应&apos;);</span><br><span class=\"line\">    if(this.userinfo!==this.oldUserinfo)&#123;</span><br><span class=\"line\">        console.log(`你从$&#123;this.oldUserinfo&#125;改成$&#123;this.userinfo&#125;`);</span><br><span class=\"line\">        this.oldUserinfo = this.userinfo;</span><br><span class=\"line\">    &#125;else&#123;            </span><br><span class=\"line\">        console.log(&quot;数据没有变化&quot;);          </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterContentInit() &#123;</span><br><span class=\"line\">    console.log(&apos;04ngAfterContentInit执行了---当把内容投影进组件之后调用&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterContentChecked() &#123;</span><br><span class=\"line\">    console.log(&apos;05ngAfterContentChecked执行了---每次完成被投影组件内容的变更检测之后调用&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterViewInit(): void &#123;     </span><br><span class=\"line\">    console.log(&apos;06 ngAfterViewInit执行了----初始化完组件视图及其子视图之后调用（dom操作放在这个里面）&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterViewChecked() &#123;</span><br><span class=\"line\">    console.log(&apos;07ngAfterViewChecked执行了----每次做完组件视图和子视图的变更检测之后调用&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnDestroy() &#123;</span><br><span class=\"line\">    console.log(&apos;08ngOnDestroy执行了····&apos;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Ionic4内置生命周期函数使用demo<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export class Page01 implements OnInit &#123;</span><br><span class=\"line\">  constructor() &#123; </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ionViewWillEnter()&#123;</span><br><span class=\"line\">    console.log(&apos;ionViewWillEnter&apos;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ionViewDidEnter()&#123;</span><br><span class=\"line\">    console.log(&apos;ionViewDidEnter&apos;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>注：本章节内容转载自网络：<a href=\"http://www.ionic.wang/article-index-id-169.html\" target=\"_blank\" rel=\"noopener\">http://www.ionic.wang/article-index-id-169.html</a></p>\n<p>##地图</p>\n<p>集成高德地图。</p>\n<p>##修改应用图标</p>\n<ol>\n<li><p>命令</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova resources</span><br><span class=\"line\">ionic cordova resources --icon</span><br><span class=\"line\">ionic cordova resources --splash</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>准备</p>\n<ul>\n<li>准备一张大小为1024*1024的图片文件作为APP的图标（命名：icon）</li>\n<li>准备一张大小为2732 <em> 2732(ionic2为2208 </em> 2208)的图片作为APP的启动界面（命名：splash）</li>\n<li>两张图片的格式为png、psd或ai都可</li>\n</ul>\n</li>\n<li>修改方法</li>\n</ol>\n<p>1.将准备好的两张图片（注意分辨率和图片格式）替换到web-app目录下的resources文件夹下。</p>\n<p>2.执行ionic cordova resources命令，或分别执行ionic cordova resources –icon和ionic cordova resources –splash。</p>\n<ol start=\"4\">\n<li>说明</li>\n</ol>\n<p>一般执行第一条命令（ionic cordova resources）即可，如失败（一般都是网络问题，有的是图片问题），网络问题：执行后第二、三条命令（ionic cordova resources –icon和ionic cordova resources –splash），图片问题：修改或更换图片。</p>\n<p>如果在启动界面不显示“小圆圈”（进度圈），修改config.xml文件<preference name=\"ShowSplashScreenSpinner\" value=\"false\">的value为false，为true为显示。如下图：</preference></p>\n<p><img src=\"https://uploader.shimo.im/f/km1Id4yU07spcNeL.png!thumbnail\" alt=\"图片\"></p>\n<ol start=\"5\">\n<li>其他</li>\n</ol>\n<p>config.xml配置说明：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;preference name=&quot;webviewbounce&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;UIWebViewBounce&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;DisallowOverscroll&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;android-minSdkVersion&quot; value=&quot;16&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;BackupWebStorage&quot; value=&quot;none&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;ShowSplashScreen&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;AutoHideSplashScreen&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;ShowSplashScreenSpinner&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashMaintainAspectRatio&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;FadeSplashScreenDuration&quot; value=&quot;300&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashShowOnlyFirstTime&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashScreen&quot; value=&quot;screen&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashScreenDelay&quot; value=&quot;1500&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;Fullscreen&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;Orientation&quot; value=&quot;landscape&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;android-minSdkVersion&quot; value=&quot;16&quot; /&gt;</span><br><span class=\"line\"> android最小sdk版本</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;BackupWebStorage&quot; value=&quot;none&quot; /&gt;</span><br><span class=\"line\"> 网络备份存储</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;ShowSplashScreen&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\"> 显示启动界面</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;AutoHideSplashScreen&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 自动隐藏启动界面</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;ShowSplashScreenSpinner&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 显示启动界面的进度圈</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashMaintainAspectRatio&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\"> 屏幕保持长宽比</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;FadeSplashScreenDuration&quot; value=&quot;300&quot; /&gt;</span><br><span class=\"line\"> 启动界面消失延迟</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashShowOnlyFirstTime&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 启动界面只在第一次显示</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashScreen&quot; value=&quot;screen&quot; /&gt;</span><br><span class=\"line\"> 启动界面</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashScreenDelay&quot; value=&quot;1500&quot; /&gt;</span><br><span class=\"line\"> 启动界面延迟</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;Fullscreen&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 全屏显示</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;Orientation&quot; value=&quot;landscape&quot; /&gt;</span><br><span class=\"line\"> 屏幕方向。Orientation设置可以让你锁定应用程序屏幕方向以阻止屏幕自动翻转。可选的值有：default，landscape(横屏)，portrait(竖屏)。</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>Ionic是一款跨平台开发App的框架，详细介绍见官网：<a href=\"https://ionicframework.com/docs/cli\" target=\"_blank\" rel=\"noopener\">https://ionicframework.com</a></p>\n<p>##环境搭建</p>\n<p>全局安装NodeJS和Ionic最新稳定版，安装命令如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -g cordova ionic</span><br></pre></td></tr></table></figure>\n<p>##新建项目</p>\n<p>初始化项目命令如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic start myIonicApp tabs</span><br></pre></td></tr></table></figure>\n<p>其中的tabs为初始化项目模板，可选模板有blank,tabs,sidemenu,tutorial等，可以运行ionic start –list命令查看所有可用模板。</p>\n<p>##项目常用命令</p>\n<p>详细命令参考官网：<a href=\"https://ionicframework.com/docs/cli\" target=\"_blank\" rel=\"noopener\">https://ionicframework.com/docs/cli</a></p>\n<ol>\n<li>启动项目</li>\n</ol>\n<p>ng serve -o</p>\n<ol start=\"2\">\n<li><p>编译项目</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova prepare ios</span><br><span class=\"line\">ionic cordova prepare android</span><br><span class=\"line\">ionic cordova run android --prod --release</span><br><span class=\"line\">ionic cordova run ios --prod --release</span><br><span class=\"line\">ionic cordova build android --prod --release</span><br><span class=\"line\">ionic cordova build ios --prod --release</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>管理平台</p>\n</li>\n</ol>\n<p>添加平台：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova platform add android</span><br></pre></td></tr></table></figure>\n<p>删除平台：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova platform rm ios</span><br></pre></td></tr></table></figure></p>\n<p>根据配置文件安装平台：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cordova prepare</span><br></pre></td></tr></table></figure></p>\n<ol start=\"4\">\n<li>管理插件</li>\n</ol>\n<p>添加插件：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova plugin add cordova-sqlite-storage</span><br></pre></td></tr></table></figure>\n<p>删除插件：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova plugin rm cordova-sqlite-storage</span><br></pre></td></tr></table></figure></p>\n<p>根据配置文件安装插件：<br>cordova prepare</p>\n<ol start=\"5\">\n<li>自动创建代码命令<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic generate page pages/my-page</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>##路由传参</p>\n<p>路由传参只能传递字符串参数，不能为复杂对象，当然也可以将复杂对象转成json再通过路由进行传参，但这种方式不被推荐，某些情况下转换的对象json中存在特殊字符的话会直接影响路由功能。</p>\n<p>前端有localStorage这个比较强大的前端缓存工具，因为路由传参不适合传递复杂对象，我们还有一种方式就是将复杂对象存储在localStorage中，它的key放在路由参数中进行传递，然后到详情页面中通过这个key从localStorage中查询。显然，某些场景下也会出现下面的问题，但这的确是一个方法。关键前端缓存这块后面弄个专题说一下。</p>\n<p>在大部分场景中，比如查看订单列表中某一条数据的详细信息，通过路由传递一个id字段到详情页面就足够了，虽然前端可以缓存订单列表中已有的订单字段，但为了数据的准确性，这里还是推荐在详情页面根据id重新获取最新的详情数据。当然，得结合实际业务功能决定到底用何种方式。</p>\n<p>路由配置代码：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const routes: Routes = [</span><br><span class=\"line\">\t  &#123;path: &apos;order-detail/:id&apos;, loadChildren: &apos;./pages/order-detail/order-detail.module#OrderDetailPageModule&apos;&#125;</span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n<p>传递参数代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ion-item routerLink=&quot;/order-detail/3&quot;&gt;&lt;/ion-item&gt;</span><br></pre></td></tr></table></figure></p>\n<p>接收参数代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private route: ActivatedRoute) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\"> const id = this.route.snapshot.paramMap.get(&apos;id&apos;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>##组件传参</p>\n<p>这里的组件传参就可以直接传递复杂参数，当然它同样不适合上面我们所说的查看详情等场景，但在以下场景中它将为我们带来极大的方便。</p>\n<p>涉及到流程表单的场景：用户在前端需要操作一个流程表单，分好几步，第一步干嘛，第二步干嘛，每一步都会在前端录入一些必要数据，而且这些数据可能在下一步的表单操作中要使用到，此时，组件传参就发挥了它的威力。</p>\n<p>在使用该component的module中需要配置entryComponents，代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@NgModule(&#123;</span><br><span class=\"line\"> declarations: [ReceiveOrderPage],</span><br><span class=\"line\"> entryComponents: [ReceiveOrderPage]</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>在传递参数的component中代码如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private modalCtrl: ModalController) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">async receiveOrder() &#123;</span><br><span class=\"line\"> const modal = await this.modalCtrl.create(&#123;</span><br><span class=\"line\">   component: ReceiveOrderPage,</span><br><span class=\"line\">   componentProps: &#123;</span><br><span class=\"line\">     params: &#123;id: 1, name: &apos;hllinc&apos;&#125;</span><br><span class=\"line\">   &#125;,</span><br><span class=\"line\">   animated: true</span><br><span class=\"line\"> &#125;);</span><br><span class=\"line\"> return await modal.present();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>接收参数代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export class ReceiveOrderPage implements OnInit &#123;</span><br><span class=\"line\"> @Input() params;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;ion-content padding&gt;</span><br><span class=\"line\"> &lt;p&gt;&#123;&#123;params.name&#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">&lt;/ion-content&gt;</span><br></pre></td></tr></table></figure></p>\n<p>##禁用菜单</p>\n<p>当我们使用menu功能时，一般会在全局添加menu左或右滑动唤出的功能，但在某些场景下，我们只希望在主页面中启用该功能，在子页面中禁用该功能，因为左右滑动在子页面可能会实现其他必要功能，此时我们需要在子页面中添加如下代码以禁用菜单唤出功能，代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private menuCtrl: MenuController) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ionViewWillEnter() &#123;</span><br><span class=\"line\"> this.menuCtrl.enable(false);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>##Flex布局</p>\n<p>某些情况下，采用Flex可以为布局带来更好的效果，css代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.dayPlat &#123;</span><br><span class=\"line\">display: flex;</span><br><span class=\"line\">flex-wrap: wrap;</span><br><span class=\"line\">flex-direction: row;</span><br><span class=\"line\">align-content: flex-start;</span><br><span class=\"line\">.day &#123;</span><br><span class=\"line\"> font-size: 14px;</span><br><span class=\"line\"> width: 60px;</span><br><span class=\"line\"> height: 60px;</span><br><span class=\"line\"> text-align: center;</span><br><span class=\"line\"> line-height: 60px;</span><br><span class=\"line\"> margin: 10px;</span><br><span class=\"line\"> border: 1px solid #dddddd;</span><br><span class=\"line\"> color: #555;</span><br><span class=\"line\"> -webkit-border-radius: 5px;</span><br><span class=\"line\"> -moz-border-radius: 5px;</span><br><span class=\"line\"> border-radius: 5px;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>效果如下图所示：<br><img src=\"https://uploader.shimo.im/f/a1oAw02RFIw8UdD6.png!thumbnail\" alt=\"图片\"></p>\n<p>##Modal窗口</p>\n<p>对于一些页面的打开方式我们可能不需要像普通页面那样具有返回功能，在打开的页面中提供一个关闭按钮，并且打开效果也不像普通页面那样从右向左滑入，而是具有弹出效果的打开，以达到提醒用户当前打开页面中的内容很重要的目的。比如，协议页面、登录/注册页面等。</p>\n<p>打开Modal窗口，代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor(private modalCtrl: ModalController) &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">async openProtocol() &#123;</span><br><span class=\"line\"> const modal = await this.modalCtrl.create(&#123;</span><br><span class=\"line\">   component: ProtocolPage</span><br><span class=\"line\"> &#125;);</span><br><span class=\"line\"> return await modal.present();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>关闭Modal窗口需要在打开的component中添加如下代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ion-button color=&quot;primary&quot; (click)=&quot;closeModal()&quot;&gt;</span><br><span class=\"line\"> &lt;ion-icon name=&quot;close&quot; color=&quot;light&quot;&gt;&lt;/ion-icon&gt;</span><br><span class=\"line\">&lt;/ion-button&gt;</span><br><span class=\"line\">constructor(private modalCtrl: ModalController) &#123; &#125;</span><br><span class=\"line\">closeModal() &#123;</span><br><span class=\"line\"> this.modalCtrl.dismiss();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>当然，这个modal中的component也是可以进行传参的，方式同组件传参。</p>\n<p>##拍照</p>\n<p>脚本代码如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import &#123;Component, OnInit&#125; from &apos;@angular/core&apos;;</span><br><span class=\"line\">import &#123;Camera, CameraOptions&#125; from &apos;@ionic-native/camera/ngx&apos;;</span><br><span class=\"line\">@Component(&#123;</span><br><span class=\"line\"> selector: &apos;app-camera&apos;,</span><br><span class=\"line\"> templateUrl: &apos;./camera.page.html&apos;,</span><br><span class=\"line\"> styleUrls: [&apos;./camera.page.scss&apos;],</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">export class CameraPage implements OnInit &#123;</span><br><span class=\"line\"> imageData;</span><br><span class=\"line\"> constructor(private camera: Camera) &#123;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> ngOnInit() &#123;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> takePhone() &#123;</span><br><span class=\"line\">   const options: CameraOptions = &#123;</span><br><span class=\"line\">     quality: 100,</span><br><span class=\"line\">     destinationType: this.camera.DestinationType.DATA_URL,</span><br><span class=\"line\">     encodingType: this.camera.EncodingType.JPEG,</span><br><span class=\"line\">     mediaType: this.camera.MediaType.PICTURE</span><br><span class=\"line\">   &#125;;</span><br><span class=\"line\">   this.camera.getPicture(options).then((imageData) =&gt; &#123;</span><br><span class=\"line\">     // imageData is either a base64 encoded string or a file URI</span><br><span class=\"line\">     // If it&apos;s base64 (DATA_URL)</span><br><span class=\"line\">     let base64Image = &apos;data:image/jpeg;base64,&apos; + imageData;</span><br><span class=\"line\">     this.imageData = base64Image;</span><br><span class=\"line\">   &#125;, (err) =&gt; &#123;</span><br><span class=\"line\">     // Handle error</span><br><span class=\"line\">   &#125;);</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>视图代码如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;ion-header&gt;</span><br><span class=\"line\"> &lt;ion-toolbar&gt;</span><br><span class=\"line\">   &lt;ion-buttons slot=&quot;start&quot;&gt;</span><br><span class=\"line\">     &lt;ion-back-button [text]=&quot;&apos;返回&apos;&quot;&gt;&lt;/ion-back-button&gt;</span><br><span class=\"line\">   &lt;/ion-buttons&gt;</span><br><span class=\"line\">   &lt;ion-title&gt;camera&lt;/ion-title&gt;</span><br><span class=\"line\"> &lt;/ion-toolbar&gt;</span><br><span class=\"line\">&lt;/ion-header&gt;</span><br><span class=\"line\">&lt;ion-content padding&gt;</span><br><span class=\"line\"> &lt;ion-button (click)=&quot;takePhone()&quot;&gt;拍照&lt;/ion-button&gt;</span><br><span class=\"line\"> &lt;ion-img [src]=&quot;imageData&quot;&gt;&lt;/ion-img&gt;</span><br><span class=\"line\">&lt;/ion-content&gt;</span><br></pre></td></tr></table></figure></p>\n<p>##生命周期</p>\n<p>Ionic4中的生命周期函数和angualr7基本是一样的，下面我们看看Ionic4中的生命周期函数，以及生命周期函数的用法。  </p>\n<p><strong>Ionic4中内置的生命周期函数：</strong></p>\n<p><strong>ionViewWillEnter </strong>—当进入一个页面时触发(如果它从堆栈返回)</p>\n<p><strong>ionViewDidEnter </strong>—进入后触发</p>\n<p><strong>ionViewWillLeave </strong>—如果页面将离开触发</p>\n<p><strong>ionViewDidLeave </strong>— 在页面离开后触发</p>\n<p><strong>ionViewWillUnload </strong>— 在Angular中没有触发，因为这里你必须使用ngOnDestroy</p>\n<p><strong>Ionic4中使用Angular生命周期函数：</strong></p>\n<p>1、Ionic4中的生命周期函数<strong>ngOnChanges </strong>当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)</p>\n<p>2、Ionic4中的生命周期函数<strong>ngOnInit </strong>请求数据一般放在这个里面  （重要*）</p>\n<p>3、Ionic4中的生命周期函数<strong>ngDoCheck</strong> 检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应</p>\n<p>4、Ionic4中的生命周期函数 <strong>ngAfterContentInit </strong>当把内容投影进组件之后调用</p>\n<p>5、Ionic4中的生命周期函数 <strong>ngAfterContentChecked </strong>每次完成被投影组件内容的变更检测之后调用</p>\n<p>6、Ionic4中的生命周期函数 <strong>ngAfterViewInit  </strong>初始化完组件视图及其子视图之后调用（dom操作放在这个里面） （重要）</p>\n<p>7、Ionic4中的生命周期函数 <strong>ngAfterViewInit</strong>  每次做完组件视图和子视图的变更检测之后调用</p>\n<p>8、Ionic4中的生命周期函数  <strong>ngOnDestroy  </strong>组件销毁后执行 （重要）</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">constructor() &#123; </span><br><span class=\"line\">  console.log(&apos;00构造函数执行了---除了使用简单的值对局部变量进行初始化之外，什么都不应该做&apos;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnChanges() &#123;</span><br><span class=\"line\">  console.log(&apos;01ngOnChages执行了---当被绑定的输入属性的值发生变化时调用(父子组件传值的时候会触发)&apos;); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnInit() &#123;</span><br><span class=\"line\">    console.log(&apos;02ngOnInit执行了--- 请求数据一般放在这个里面&apos;);     </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngDoCheck() &#123;</span><br><span class=\"line\">    //写一些自定义的操作</span><br><span class=\"line\">    console.log(&apos;03ngDoCheck执行了---检测，并在发生 Angular 无法或不愿意自己检测的变化时作出反应&apos;);</span><br><span class=\"line\">    if(this.userinfo!==this.oldUserinfo)&#123;</span><br><span class=\"line\">        console.log(`你从$&#123;this.oldUserinfo&#125;改成$&#123;this.userinfo&#125;`);</span><br><span class=\"line\">        this.oldUserinfo = this.userinfo;</span><br><span class=\"line\">    &#125;else&#123;            </span><br><span class=\"line\">        console.log(&quot;数据没有变化&quot;);          </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterContentInit() &#123;</span><br><span class=\"line\">    console.log(&apos;04ngAfterContentInit执行了---当把内容投影进组件之后调用&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterContentChecked() &#123;</span><br><span class=\"line\">    console.log(&apos;05ngAfterContentChecked执行了---每次完成被投影组件内容的变更检测之后调用&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterViewInit(): void &#123;     </span><br><span class=\"line\">    console.log(&apos;06 ngAfterViewInit执行了----初始化完组件视图及其子视图之后调用（dom操作放在这个里面）&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngAfterViewChecked() &#123;</span><br><span class=\"line\">    console.log(&apos;07ngAfterViewChecked执行了----每次做完组件视图和子视图的变更检测之后调用&apos;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ngOnDestroy() &#123;</span><br><span class=\"line\">    console.log(&apos;08ngOnDestroy执行了····&apos;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Ionic4内置生命周期函数使用demo<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export class Page01 implements OnInit &#123;</span><br><span class=\"line\">  constructor() &#123; </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ngOnInit() &#123;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ionViewWillEnter()&#123;</span><br><span class=\"line\">    console.log(&apos;ionViewWillEnter&apos;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ionViewDidEnter()&#123;</span><br><span class=\"line\">    console.log(&apos;ionViewDidEnter&apos;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>注：本章节内容转载自网络：<a href=\"http://www.ionic.wang/article-index-id-169.html\" target=\"_blank\" rel=\"noopener\">http://www.ionic.wang/article-index-id-169.html</a></p>\n<p>##地图</p>\n<p>集成高德地图。</p>\n<p>##修改应用图标</p>\n<ol>\n<li><p>命令</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ionic cordova resources</span><br><span class=\"line\">ionic cordova resources --icon</span><br><span class=\"line\">ionic cordova resources --splash</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>准备</p>\n<ul>\n<li>准备一张大小为1024*1024的图片文件作为APP的图标（命名：icon）</li>\n<li>准备一张大小为2732 <em> 2732(ionic2为2208 </em> 2208)的图片作为APP的启动界面（命名：splash）</li>\n<li>两张图片的格式为png、psd或ai都可</li>\n</ul>\n</li>\n<li>修改方法</li>\n</ol>\n<p>1.将准备好的两张图片（注意分辨率和图片格式）替换到web-app目录下的resources文件夹下。</p>\n<p>2.执行ionic cordova resources命令，或分别执行ionic cordova resources –icon和ionic cordova resources –splash。</p>\n<ol start=\"4\">\n<li>说明</li>\n</ol>\n<p>一般执行第一条命令（ionic cordova resources）即可，如失败（一般都是网络问题，有的是图片问题），网络问题：执行后第二、三条命令（ionic cordova resources –icon和ionic cordova resources –splash），图片问题：修改或更换图片。</p>\n<p>如果在启动界面不显示“小圆圈”（进度圈），修改config.xml文件<preference name=\"ShowSplashScreenSpinner\" value=\"false\">的value为false，为true为显示。如下图：</preference></p>\n<p><img src=\"https://uploader.shimo.im/f/km1Id4yU07spcNeL.png!thumbnail\" alt=\"图片\"></p>\n<ol start=\"5\">\n<li>其他</li>\n</ol>\n<p>config.xml配置说明：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;preference name=&quot;webviewbounce&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;UIWebViewBounce&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;DisallowOverscroll&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;android-minSdkVersion&quot; value=&quot;16&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;BackupWebStorage&quot; value=&quot;none&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;ShowSplashScreen&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;AutoHideSplashScreen&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;ShowSplashScreenSpinner&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashMaintainAspectRatio&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;FadeSplashScreenDuration&quot; value=&quot;300&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashShowOnlyFirstTime&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashScreen&quot; value=&quot;screen&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;SplashScreenDelay&quot; value=&quot;1500&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;Fullscreen&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;Orientation&quot; value=&quot;landscape&quot; /&gt;</span><br><span class=\"line\">&lt;preference name=&quot;android-minSdkVersion&quot; value=&quot;16&quot; /&gt;</span><br><span class=\"line\"> android最小sdk版本</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;BackupWebStorage&quot; value=&quot;none&quot; /&gt;</span><br><span class=\"line\"> 网络备份存储</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;ShowSplashScreen&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\"> 显示启动界面</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;AutoHideSplashScreen&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 自动隐藏启动界面</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;ShowSplashScreenSpinner&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 显示启动界面的进度圈</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashMaintainAspectRatio&quot; value=&quot;true&quot; /&gt;</span><br><span class=\"line\"> 屏幕保持长宽比</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;FadeSplashScreenDuration&quot; value=&quot;300&quot; /&gt;</span><br><span class=\"line\"> 启动界面消失延迟</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashShowOnlyFirstTime&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 启动界面只在第一次显示</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashScreen&quot; value=&quot;screen&quot; /&gt;</span><br><span class=\"line\"> 启动界面</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;SplashScreenDelay&quot; value=&quot;1500&quot; /&gt;</span><br><span class=\"line\"> 启动界面延迟</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;Fullscreen&quot; value=&quot;false&quot; /&gt;</span><br><span class=\"line\"> 全屏显示</span><br><span class=\"line\"></span><br><span class=\"line\"> &lt;preference name=&quot;Orientation&quot; value=&quot;landscape&quot; /&gt;</span><br><span class=\"line\"> 屏幕方向。Orientation设置可以让你锁定应用程序屏幕方向以阻止屏幕自动翻转。可选的值有：default，landscape(横屏)，portrait(竖屏)。</span><br></pre></td></tr></table></figure>\n"},{"title":"Phonegap jQueryMobile 在线应用拍照、相册选择上传+预览","date":"2015-07-07T02:53:25.000Z","_content":"拍照上传以及从相册中选择图片上传是大多数手机应用的典型功能，这几天在做一个移动端的项目，其中就用到该功能。\n  \n  项目技术选择的是Phonegap+jQueryMobile，因为jQuery自己比较熟悉，用jQueryMobile没有什么大的难点。\n  \n  界面用jQueryMobile搭的很快，一开始打算用Phonegap将应用做为离线版本，但后来发现离线版本升级的话还是和普通的app一样，都需要重新安装，这就没有了WebApp的优势和亮点，故最终选择了在线版本，即将项目作为一个web应用，用Tomcat发布在服务器上，Phonegap作为一个app外壳行使浏览器功能在其中请求服务器上的页面等资源。\n  \n  做该功能的时候，由于对于Phonegap接触不久，花了我整整两天的时间，这两天没有做其他的，一直在研究如何实现图片预览，网上、官网有很多成功的例子，但没有一个在我这边成功预览的，几乎看遍了网上所有的帖子，点坏了鼠标！心情坏到了极点，因为本以为很简单的东西，而后网上说的也都很简单，很多帖子都是一样的内容，但是我却死活跑不通，崩溃！\n  \n  到最后，才发现问题原来出在我的“在线”应用上，无语，其实做J2EE的我深知浏览器端是无权限操作本地文件的，但是由于对Phonegap的不了解，由于知道Phonegap可以直接操作本地资源，误认为用了Phonegap就无敌了，你以为呢！于是我就把WebApp整成离线的试下喽，果然，可以显示了！\n  \n  但项目已经做到这个地步了，再把它重构成离线的？不可取。于是我就开始分析了。。。\n  \n  Phonegap不是可以操作本地文件吗？html中的img标签不能根据本地图片路径渲染图片，但它可以不用文件路径啊！于是呵呵了。\n  \n  最终解决方案是用Phonegap的FileReader来根据本地图片路径以base64的形式读取其内容，base64是可以直接在img标签上渲染的，所以问题就解决了。\n  \n  下面截取拍照上传以及预览的代码如下：\n  \n  图片处理代码：\n```javascript\nvar picUrl = \"\" ;\nfunction capturePhotoUrl() {\n \n     navigator.camera.getPicture(onCaptureSuccess, onUrlFail, {\n           quality : 80,\n//         allowEdit : true,//在Android中此配置忽略\n           destinationType : Camera.DestinationType.FILE_URI,\n           sourceType:Camera.PictureSourceType.CAMERA,\n           targetWidth : 800, // 生成的图片大小 单位像素\n           targetHeight : 640\n     });\n \n}\nfunction onCaptureSuccess(imageURI) {\n     picUrl = imageURI;\n     //这是关键部分\n     window.resolveLocalFileSystemURI(imageURI, function(fileEntry){\n           fileEntry.file( function(file){\n                 var reader = new FileReader();\n                    reader.onloadend = function(evt) {\n                     $( \"#uploadImgDom\").append(\"<img path='\"+imageURI+\"' class='uploadImg' src='\"+evt.target.result+\"' />\");\n                     $( \"#report-page\").trigger(\"create\" );\n                    };\n                    reader.readAsDataURL(file);\n           }, readFileFail);\n     }, readFileFail);\n//   $(\"#urlinfo\").text(\"图片的原始路径\" + imageURI);\n}\n \nfunction readFileFail(evt){\n     navigator.notification.alert( \"文件读取失败，原因：\" + evt.code, null, \"警告\" );\n}\n \nfunction onUrlFail(message) {\n     navigator.notification.alert( \"失败，原因：\" + message, null, \"警告\" );\n}\n \nfunction loadImageLocal() {\n     navigator.camera.getPicture(onLoadSuccess, onUrlFail, {\n           quality : 80,\n           sourceType : Camera.PictureSourceType.PHOTOLIBRARY,\n           destinationType : Camera.DestinationType.FILE_URI,\n//         encodingType : Camera.EncodingType.JPEG,\n//         mediaType : Camera.MediaType.PICTURE,\n           targetWidth : 800, // 生成的图片大小 单位像素，选择图片的时候一定要制定这个值，否则\n           targetHeight : 640\n     });\n \n}\n \nfunction onLoadSuccess(imageURI) {\n     imageURI = imageURI + \".jpg\";\n     picUrl = imageURI;\n     window.resolveLocalFileSystemURI(imageURI, function(fileEntry){\n           fileEntry.file( function(file){\n                 var reader = new FileReader();\n                    reader.onloadend = function(evt) {\n                     $( \"#uploadImgDom\").append(\"<img path='\"+imageURI+\"' class='uploadImg' src='\"+evt.target.result+\"' />\");\n                     $( \"#report-page\").trigger(\"create\" );\n                    };\n                    reader.readAsDataURL(file);\n           }, readFileFail);\n     }, readFileFail);\n//   $(\"#urlinfo\").text(\"图片的原始路径\" + picUrl);\n}\n \nfunction uploadPhoto() {\n     $(\"#report-btn\").attr({ \"disabled\": \"disabled\"});\n     var options = new FileUploadOptions();\n     options.fileKey = \"file\";\n     options.fileName = picUrl.substr(picUrl.lastIndexOf( '/') + 1);\n     options.mimeType = \"image/jpeg\";\n     \n     var ft = new FileTransfer(); //文件上传类\n    ft.onprogress = function (progressEvt) { //显示上传进度条\n        if (progressEvt.lengthComputable) {\n            navigator.notification.progressValue(Math.round(( progressEvt.loaded / progressEvt.total ) * 100));\n        }\n    }\n    navigator.notification.progressStart( \"提醒\", \"当前上传进度\" );\n     \n     var params = new Object();\n     params.title = $( \"#textinput-2\").val();\n     params.info = $( \"#textarea-2\").val();\n     params.longitude = $( \"#longitude\").text();\n     params.latitude = $( \"#latitude\").text();\n     \n     options.params = params;\n     \n     \n     ft.upload(picUrl, basePath+ \"/report\", win,\n                fail, options);\n}\n \nfunction win(r) {\n     navigator.notification.progressStop(); //停止进度条\n     \n     $(\"#returnpic\").attr( \"src\",\n                basePath+ \"/files/\" + r.response);\n \n//   $(\"#returninfo\").html(\n//              \"上传成功\\n：反馈的信息:r.responseCode:\" + r.responseCode + \"\\nr.response:\"\n//                         + r.response + \"\\nr.bytesSent:\" + r.bytesSent);\n     $(\"#report-btn\").removeAttr( \"disabled\");\n     navigator.notification.alert( \"上传成功！\" , function(){\n           $( \"#reportPageBackBtn\").click();\n     }, \"提醒\");\n}\n \nfunction fail(error) {\n \n     /*\n      * FileTransferError.FILE_NOT_FOUND_ERR：1 文件未找到错误。\n      * •FileTransferError.INVALID_URL_ERR：2 无效的URL错误。\n      * •FileTransferError.CONNECTION_ERR：3 连接错误。 FileTransferError.ABORT_ERR =\n      * 4; 程序异常\n      */\n     var errorcode = error.code;\n     var errstr = \"\";\n     switch (errorcode) {\n     case 1: {\n           errstr = \"错误代码1：源文件路径异常，请重新选择或者拍照上传！\" ;\n            break;\n     }\n     case 2: {\n           errstr = \"错误代码2:目标地址无效,请重试！\" ;\n            break;\n     }\n     case 3: {\n           errstr = \"您手机或者后台服务器网络异常,请重新上传！\" ;\n            break;\n     }\n     default: {\n           errstr = \"程序出错\";\n            break;\n     }\n \n     }\n     $(\"#returninfo\").text(\n                 \"上传失败,错误代码:\" + errstr + \"上传源文件:\" + error.source + \"目标地址:\"\n                           + error.target + \"请重新上传！\" );\n    \n     $(\"#report-btn\").removeAttr( \"disabled\");\n}\n```\n前台显示代码：\n```html\n<div role= \"main\" class = \"ui-content jqm-content\" data-iscroll =\"content\" >\n  <div class = \"ui-grid-a\">\n    <div class = \"ui-block-a\">\n        <a href = \"#\" onclick =\"capturePhoto()\" class = \"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-camera\"> 拍照</ a>\n    </div>\n    <div class = \"ui-block-b\">\n         <a href = \"#\" onclick =\"loadImageLocal()\" class= \"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-heart\"> 相册</a>\n    </div>\n</div>\n<div id = \"returninfo\"></div>\n<div id = \"uploadImgDom\"></div>\n```\n  后台上传的代码就不贴了，就一个Servlet。\n  \n  谨记我这两天的精彩编程生活。\n  \n  <font color=red>最后感谢所有网友的帮助与分享！</font>","source":"_posts/Phonegap-jQueryMobile-在线应用拍照、相册选择上传-预览.md","raw":"---\ntitle: Phonegap jQueryMobile 在线应用拍照、相册选择上传+预览\ndate: 2015-07-07 10:53:25\ntags:\n- WebApp\n---\n拍照上传以及从相册中选择图片上传是大多数手机应用的典型功能，这几天在做一个移动端的项目，其中就用到该功能。\n  \n  项目技术选择的是Phonegap+jQueryMobile，因为jQuery自己比较熟悉，用jQueryMobile没有什么大的难点。\n  \n  界面用jQueryMobile搭的很快，一开始打算用Phonegap将应用做为离线版本，但后来发现离线版本升级的话还是和普通的app一样，都需要重新安装，这就没有了WebApp的优势和亮点，故最终选择了在线版本，即将项目作为一个web应用，用Tomcat发布在服务器上，Phonegap作为一个app外壳行使浏览器功能在其中请求服务器上的页面等资源。\n  \n  做该功能的时候，由于对于Phonegap接触不久，花了我整整两天的时间，这两天没有做其他的，一直在研究如何实现图片预览，网上、官网有很多成功的例子，但没有一个在我这边成功预览的，几乎看遍了网上所有的帖子，点坏了鼠标！心情坏到了极点，因为本以为很简单的东西，而后网上说的也都很简单，很多帖子都是一样的内容，但是我却死活跑不通，崩溃！\n  \n  到最后，才发现问题原来出在我的“在线”应用上，无语，其实做J2EE的我深知浏览器端是无权限操作本地文件的，但是由于对Phonegap的不了解，由于知道Phonegap可以直接操作本地资源，误认为用了Phonegap就无敌了，你以为呢！于是我就把WebApp整成离线的试下喽，果然，可以显示了！\n  \n  但项目已经做到这个地步了，再把它重构成离线的？不可取。于是我就开始分析了。。。\n  \n  Phonegap不是可以操作本地文件吗？html中的img标签不能根据本地图片路径渲染图片，但它可以不用文件路径啊！于是呵呵了。\n  \n  最终解决方案是用Phonegap的FileReader来根据本地图片路径以base64的形式读取其内容，base64是可以直接在img标签上渲染的，所以问题就解决了。\n  \n  下面截取拍照上传以及预览的代码如下：\n  \n  图片处理代码：\n```javascript\nvar picUrl = \"\" ;\nfunction capturePhotoUrl() {\n \n     navigator.camera.getPicture(onCaptureSuccess, onUrlFail, {\n           quality : 80,\n//         allowEdit : true,//在Android中此配置忽略\n           destinationType : Camera.DestinationType.FILE_URI,\n           sourceType:Camera.PictureSourceType.CAMERA,\n           targetWidth : 800, // 生成的图片大小 单位像素\n           targetHeight : 640\n     });\n \n}\nfunction onCaptureSuccess(imageURI) {\n     picUrl = imageURI;\n     //这是关键部分\n     window.resolveLocalFileSystemURI(imageURI, function(fileEntry){\n           fileEntry.file( function(file){\n                 var reader = new FileReader();\n                    reader.onloadend = function(evt) {\n                     $( \"#uploadImgDom\").append(\"<img path='\"+imageURI+\"' class='uploadImg' src='\"+evt.target.result+\"' />\");\n                     $( \"#report-page\").trigger(\"create\" );\n                    };\n                    reader.readAsDataURL(file);\n           }, readFileFail);\n     }, readFileFail);\n//   $(\"#urlinfo\").text(\"图片的原始路径\" + imageURI);\n}\n \nfunction readFileFail(evt){\n     navigator.notification.alert( \"文件读取失败，原因：\" + evt.code, null, \"警告\" );\n}\n \nfunction onUrlFail(message) {\n     navigator.notification.alert( \"失败，原因：\" + message, null, \"警告\" );\n}\n \nfunction loadImageLocal() {\n     navigator.camera.getPicture(onLoadSuccess, onUrlFail, {\n           quality : 80,\n           sourceType : Camera.PictureSourceType.PHOTOLIBRARY,\n           destinationType : Camera.DestinationType.FILE_URI,\n//         encodingType : Camera.EncodingType.JPEG,\n//         mediaType : Camera.MediaType.PICTURE,\n           targetWidth : 800, // 生成的图片大小 单位像素，选择图片的时候一定要制定这个值，否则\n           targetHeight : 640\n     });\n \n}\n \nfunction onLoadSuccess(imageURI) {\n     imageURI = imageURI + \".jpg\";\n     picUrl = imageURI;\n     window.resolveLocalFileSystemURI(imageURI, function(fileEntry){\n           fileEntry.file( function(file){\n                 var reader = new FileReader();\n                    reader.onloadend = function(evt) {\n                     $( \"#uploadImgDom\").append(\"<img path='\"+imageURI+\"' class='uploadImg' src='\"+evt.target.result+\"' />\");\n                     $( \"#report-page\").trigger(\"create\" );\n                    };\n                    reader.readAsDataURL(file);\n           }, readFileFail);\n     }, readFileFail);\n//   $(\"#urlinfo\").text(\"图片的原始路径\" + picUrl);\n}\n \nfunction uploadPhoto() {\n     $(\"#report-btn\").attr({ \"disabled\": \"disabled\"});\n     var options = new FileUploadOptions();\n     options.fileKey = \"file\";\n     options.fileName = picUrl.substr(picUrl.lastIndexOf( '/') + 1);\n     options.mimeType = \"image/jpeg\";\n     \n     var ft = new FileTransfer(); //文件上传类\n    ft.onprogress = function (progressEvt) { //显示上传进度条\n        if (progressEvt.lengthComputable) {\n            navigator.notification.progressValue(Math.round(( progressEvt.loaded / progressEvt.total ) * 100));\n        }\n    }\n    navigator.notification.progressStart( \"提醒\", \"当前上传进度\" );\n     \n     var params = new Object();\n     params.title = $( \"#textinput-2\").val();\n     params.info = $( \"#textarea-2\").val();\n     params.longitude = $( \"#longitude\").text();\n     params.latitude = $( \"#latitude\").text();\n     \n     options.params = params;\n     \n     \n     ft.upload(picUrl, basePath+ \"/report\", win,\n                fail, options);\n}\n \nfunction win(r) {\n     navigator.notification.progressStop(); //停止进度条\n     \n     $(\"#returnpic\").attr( \"src\",\n                basePath+ \"/files/\" + r.response);\n \n//   $(\"#returninfo\").html(\n//              \"上传成功\\n：反馈的信息:r.responseCode:\" + r.responseCode + \"\\nr.response:\"\n//                         + r.response + \"\\nr.bytesSent:\" + r.bytesSent);\n     $(\"#report-btn\").removeAttr( \"disabled\");\n     navigator.notification.alert( \"上传成功！\" , function(){\n           $( \"#reportPageBackBtn\").click();\n     }, \"提醒\");\n}\n \nfunction fail(error) {\n \n     /*\n      * FileTransferError.FILE_NOT_FOUND_ERR：1 文件未找到错误。\n      * •FileTransferError.INVALID_URL_ERR：2 无效的URL错误。\n      * •FileTransferError.CONNECTION_ERR：3 连接错误。 FileTransferError.ABORT_ERR =\n      * 4; 程序异常\n      */\n     var errorcode = error.code;\n     var errstr = \"\";\n     switch (errorcode) {\n     case 1: {\n           errstr = \"错误代码1：源文件路径异常，请重新选择或者拍照上传！\" ;\n            break;\n     }\n     case 2: {\n           errstr = \"错误代码2:目标地址无效,请重试！\" ;\n            break;\n     }\n     case 3: {\n           errstr = \"您手机或者后台服务器网络异常,请重新上传！\" ;\n            break;\n     }\n     default: {\n           errstr = \"程序出错\";\n            break;\n     }\n \n     }\n     $(\"#returninfo\").text(\n                 \"上传失败,错误代码:\" + errstr + \"上传源文件:\" + error.source + \"目标地址:\"\n                           + error.target + \"请重新上传！\" );\n    \n     $(\"#report-btn\").removeAttr( \"disabled\");\n}\n```\n前台显示代码：\n```html\n<div role= \"main\" class = \"ui-content jqm-content\" data-iscroll =\"content\" >\n  <div class = \"ui-grid-a\">\n    <div class = \"ui-block-a\">\n        <a href = \"#\" onclick =\"capturePhoto()\" class = \"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-camera\"> 拍照</ a>\n    </div>\n    <div class = \"ui-block-b\">\n         <a href = \"#\" onclick =\"loadImageLocal()\" class= \"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-heart\"> 相册</a>\n    </div>\n</div>\n<div id = \"returninfo\"></div>\n<div id = \"uploadImgDom\"></div>\n```\n  后台上传的代码就不贴了，就一个Servlet。\n  \n  谨记我这两天的精彩编程生活。\n  \n  <font color=red>最后感谢所有网友的帮助与分享！</font>","slug":"Phonegap-jQueryMobile-在线应用拍照、相册选择上传-预览","published":1,"updated":"2019-12-20T07:24:50.114Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck4dtzl2e000bemsoj6ijmltj","content":"<p>拍照上传以及从相册中选择图片上传是大多数手机应用的典型功能，这几天在做一个移动端的项目，其中就用到该功能。</p>\n<p>  项目技术选择的是Phonegap+jQueryMobile，因为jQuery自己比较熟悉，用jQueryMobile没有什么大的难点。</p>\n<p>  界面用jQueryMobile搭的很快，一开始打算用Phonegap将应用做为离线版本，但后来发现离线版本升级的话还是和普通的app一样，都需要重新安装，这就没有了WebApp的优势和亮点，故最终选择了在线版本，即将项目作为一个web应用，用Tomcat发布在服务器上，Phonegap作为一个app外壳行使浏览器功能在其中请求服务器上的页面等资源。</p>\n<p>  做该功能的时候，由于对于Phonegap接触不久，花了我整整两天的时间，这两天没有做其他的，一直在研究如何实现图片预览，网上、官网有很多成功的例子，但没有一个在我这边成功预览的，几乎看遍了网上所有的帖子，点坏了鼠标！心情坏到了极点，因为本以为很简单的东西，而后网上说的也都很简单，很多帖子都是一样的内容，但是我却死活跑不通，崩溃！</p>\n<p>  到最后，才发现问题原来出在我的“在线”应用上，无语，其实做J2EE的我深知浏览器端是无权限操作本地文件的，但是由于对Phonegap的不了解，由于知道Phonegap可以直接操作本地资源，误认为用了Phonegap就无敌了，你以为呢！于是我就把WebApp整成离线的试下喽，果然，可以显示了！</p>\n<p>  但项目已经做到这个地步了，再把它重构成离线的？不可取。于是我就开始分析了。。。</p>\n<p>  Phonegap不是可以操作本地文件吗？html中的img标签不能根据本地图片路径渲染图片，但它可以不用文件路径啊！于是呵呵了。</p>\n<p>  最终解决方案是用Phonegap的FileReader来根据本地图片路径以base64的形式读取其内容，base64是可以直接在img标签上渲染的，所以问题就解决了。</p>\n<p>  下面截取拍照上传以及预览的代码如下：</p>\n<p>  图片处理代码：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> picUrl = <span class=\"string\">\"\"</span> ;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">capturePhotoUrl</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">     navigator.camera.getPicture(onCaptureSuccess, onUrlFail, &#123;</span><br><span class=\"line\">           quality : <span class=\"number\">80</span>,</span><br><span class=\"line\"><span class=\"comment\">//         allowEdit : true,//在Android中此配置忽略</span></span><br><span class=\"line\">           destinationType : Camera.DestinationType.FILE_URI,</span><br><span class=\"line\">           sourceType:Camera.PictureSourceType.CAMERA,</span><br><span class=\"line\">           targetWidth : <span class=\"number\">800</span>, <span class=\"comment\">// 生成的图片大小 单位像素</span></span><br><span class=\"line\">           targetHeight : <span class=\"number\">640</span></span><br><span class=\"line\">     &#125;);</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onCaptureSuccess</span>(<span class=\"params\">imageURI</span>) </span>&#123;</span><br><span class=\"line\">     picUrl = imageURI;</span><br><span class=\"line\">     <span class=\"comment\">//这是关键部分</span></span><br><span class=\"line\">     <span class=\"built_in\">window</span>.resolveLocalFileSystemURI(imageURI, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">fileEntry</span>)</span>&#123;</span><br><span class=\"line\">           fileEntry.file( <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">file</span>)</span>&#123;</span><br><span class=\"line\">                 <span class=\"keyword\">var</span> reader = <span class=\"keyword\">new</span> FileReader();</span><br><span class=\"line\">                    reader.onloadend = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">evt</span>) </span>&#123;</span><br><span class=\"line\">                     $( <span class=\"string\">\"#uploadImgDom\"</span>).append(<span class=\"string\">\"&lt;img path='\"</span>+imageURI+<span class=\"string\">\"' class='uploadImg' src='\"</span>+evt.target.result+<span class=\"string\">\"' /&gt;\"</span>);</span><br><span class=\"line\">                     $( <span class=\"string\">\"#report-page\"</span>).trigger(<span class=\"string\">\"create\"</span> );</span><br><span class=\"line\">                    &#125;;</span><br><span class=\"line\">                    reader.readAsDataURL(file);</span><br><span class=\"line\">           &#125;, readFileFail);</span><br><span class=\"line\">     &#125;, readFileFail);</span><br><span class=\"line\"><span class=\"comment\">//   $(\"#urlinfo\").text(\"图片的原始路径\" + imageURI);</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">readFileFail</span>(<span class=\"params\">evt</span>)</span>&#123;</span><br><span class=\"line\">     navigator.notification.alert( <span class=\"string\">\"文件读取失败，原因：\"</span> + evt.code, <span class=\"literal\">null</span>, <span class=\"string\">\"警告\"</span> );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onUrlFail</span>(<span class=\"params\">message</span>) </span>&#123;</span><br><span class=\"line\">     navigator.notification.alert( <span class=\"string\">\"失败，原因：\"</span> + message, <span class=\"literal\">null</span>, <span class=\"string\">\"警告\"</span> );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">loadImageLocal</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">     navigator.camera.getPicture(onLoadSuccess, onUrlFail, &#123;</span><br><span class=\"line\">           quality : <span class=\"number\">80</span>,</span><br><span class=\"line\">           sourceType : Camera.PictureSourceType.PHOTOLIBRARY,</span><br><span class=\"line\">           destinationType : Camera.DestinationType.FILE_URI,</span><br><span class=\"line\"><span class=\"comment\">//         encodingType : Camera.EncodingType.JPEG,</span></span><br><span class=\"line\"><span class=\"comment\">//         mediaType : Camera.MediaType.PICTURE,</span></span><br><span class=\"line\">           targetWidth : <span class=\"number\">800</span>, <span class=\"comment\">// 生成的图片大小 单位像素，选择图片的时候一定要制定这个值，否则</span></span><br><span class=\"line\">           targetHeight : <span class=\"number\">640</span></span><br><span class=\"line\">     &#125;);</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onLoadSuccess</span>(<span class=\"params\">imageURI</span>) </span>&#123;</span><br><span class=\"line\">     imageURI = imageURI + <span class=\"string\">\".jpg\"</span>;</span><br><span class=\"line\">     picUrl = imageURI;</span><br><span class=\"line\">     <span class=\"built_in\">window</span>.resolveLocalFileSystemURI(imageURI, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">fileEntry</span>)</span>&#123;</span><br><span class=\"line\">           fileEntry.file( <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">file</span>)</span>&#123;</span><br><span class=\"line\">                 <span class=\"keyword\">var</span> reader = <span class=\"keyword\">new</span> FileReader();</span><br><span class=\"line\">                    reader.onloadend = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">evt</span>) </span>&#123;</span><br><span class=\"line\">                     $( <span class=\"string\">\"#uploadImgDom\"</span>).append(<span class=\"string\">\"&lt;img path='\"</span>+imageURI+<span class=\"string\">\"' class='uploadImg' src='\"</span>+evt.target.result+<span class=\"string\">\"' /&gt;\"</span>);</span><br><span class=\"line\">                     $( <span class=\"string\">\"#report-page\"</span>).trigger(<span class=\"string\">\"create\"</span> );</span><br><span class=\"line\">                    &#125;;</span><br><span class=\"line\">                    reader.readAsDataURL(file);</span><br><span class=\"line\">           &#125;, readFileFail);</span><br><span class=\"line\">     &#125;, readFileFail);</span><br><span class=\"line\"><span class=\"comment\">//   $(\"#urlinfo\").text(\"图片的原始路径\" + picUrl);</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">uploadPhoto</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">     $(<span class=\"string\">\"#report-btn\"</span>).attr(&#123; <span class=\"string\">\"disabled\"</span>: <span class=\"string\">\"disabled\"</span>&#125;);</span><br><span class=\"line\">     <span class=\"keyword\">var</span> options = <span class=\"keyword\">new</span> FileUploadOptions();</span><br><span class=\"line\">     options.fileKey = <span class=\"string\">\"file\"</span>;</span><br><span class=\"line\">     options.fileName = picUrl.substr(picUrl.lastIndexOf( <span class=\"string\">'/'</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">     options.mimeType = <span class=\"string\">\"image/jpeg\"</span>;</span><br><span class=\"line\">     </span><br><span class=\"line\">     <span class=\"keyword\">var</span> ft = <span class=\"keyword\">new</span> FileTransfer(); <span class=\"comment\">//文件上传类</span></span><br><span class=\"line\">    ft.onprogress = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">progressEvt</span>) </span>&#123; <span class=\"comment\">//显示上传进度条</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (progressEvt.lengthComputable) &#123;</span><br><span class=\"line\">            navigator.notification.progressValue(<span class=\"built_in\">Math</span>.round(( progressEvt.loaded / progressEvt.total ) * <span class=\"number\">100</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    navigator.notification.progressStart( <span class=\"string\">\"提醒\"</span>, <span class=\"string\">\"当前上传进度\"</span> );</span><br><span class=\"line\">     </span><br><span class=\"line\">     <span class=\"keyword\">var</span> params = <span class=\"keyword\">new</span> <span class=\"built_in\">Object</span>();</span><br><span class=\"line\">     params.title = $( <span class=\"string\">\"#textinput-2\"</span>).val();</span><br><span class=\"line\">     params.info = $( <span class=\"string\">\"#textarea-2\"</span>).val();</span><br><span class=\"line\">     params.longitude = $( <span class=\"string\">\"#longitude\"</span>).text();</span><br><span class=\"line\">     params.latitude = $( <span class=\"string\">\"#latitude\"</span>).text();</span><br><span class=\"line\">     </span><br><span class=\"line\">     options.params = params;</span><br><span class=\"line\">     </span><br><span class=\"line\">     </span><br><span class=\"line\">     ft.upload(picUrl, basePath+ <span class=\"string\">\"/report\"</span>, win,</span><br><span class=\"line\">                fail, options);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">win</span>(<span class=\"params\">r</span>) </span>&#123;</span><br><span class=\"line\">     navigator.notification.progressStop(); <span class=\"comment\">//停止进度条</span></span><br><span class=\"line\">     </span><br><span class=\"line\">     $(<span class=\"string\">\"#returnpic\"</span>).attr( <span class=\"string\">\"src\"</span>,</span><br><span class=\"line\">                basePath+ <span class=\"string\">\"/files/\"</span> + r.response);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//   $(\"#returninfo\").html(</span></span><br><span class=\"line\"><span class=\"comment\">//              \"上传成功\\n：反馈的信息:r.responseCode:\" + r.responseCode + \"\\nr.response:\"</span></span><br><span class=\"line\"><span class=\"comment\">//                         + r.response + \"\\nr.bytesSent:\" + r.bytesSent);</span></span><br><span class=\"line\">     $(<span class=\"string\">\"#report-btn\"</span>).removeAttr( <span class=\"string\">\"disabled\"</span>);</span><br><span class=\"line\">     navigator.notification.alert( <span class=\"string\">\"上传成功！\"</span> , <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">           $( <span class=\"string\">\"#reportPageBackBtn\"</span>).click();</span><br><span class=\"line\">     &#125;, <span class=\"string\">\"提醒\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fail</span>(<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">     <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">      * FileTransferError.FILE_NOT_FOUND_ERR：1 文件未找到错误。</span></span><br><span class=\"line\"><span class=\"comment\">      * •FileTransferError.INVALID_URL_ERR：2 无效的URL错误。</span></span><br><span class=\"line\"><span class=\"comment\">      * •FileTransferError.CONNECTION_ERR：3 连接错误。 FileTransferError.ABORT_ERR =</span></span><br><span class=\"line\"><span class=\"comment\">      * 4; 程序异常</span></span><br><span class=\"line\"><span class=\"comment\">      */</span></span><br><span class=\"line\">     <span class=\"keyword\">var</span> errorcode = error.code;</span><br><span class=\"line\">     <span class=\"keyword\">var</span> errstr = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">     <span class=\"keyword\">switch</span> (errorcode) &#123;</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"number\">1</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"错误代码1：源文件路径异常，请重新选择或者拍照上传！\"</span> ;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"number\">2</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"错误代码2:目标地址无效,请重试！\"</span> ;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"number\">3</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"您手机或者后台服务器网络异常,请重新上传！\"</span> ;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">default</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"程序出错\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     $(<span class=\"string\">\"#returninfo\"</span>).text(</span><br><span class=\"line\">                 <span class=\"string\">\"上传失败,错误代码:\"</span> + errstr + <span class=\"string\">\"上传源文件:\"</span> + error.source + <span class=\"string\">\"目标地址:\"</span></span><br><span class=\"line\">                           + error.target + <span class=\"string\">\"请重新上传！\"</span> );</span><br><span class=\"line\">    </span><br><span class=\"line\">     $(<span class=\"string\">\"#report-btn\"</span>).removeAttr( <span class=\"string\">\"disabled\"</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>前台显示代码：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">role</span>= <span class=\"string\">\"main\"</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-content jqm-content\"</span> <span class=\"attr\">data-iscroll</span> =<span class=\"string\">\"content\"</span> &gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-grid-a\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-block-a\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span> = <span class=\"string\">\"#\"</span> <span class=\"attr\">onclick</span> =<span class=\"string\">\"capturePhoto()\"</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-camera\"</span>&gt;</span> 拍照<span class=\"tag\">&lt;/ <span class=\"attr\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-block-b\"</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span> = <span class=\"string\">\"#\"</span> <span class=\"attr\">onclick</span> =<span class=\"string\">\"loadImageLocal()\"</span> <span class=\"attr\">class</span>= <span class=\"string\">\"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-heart\"</span>&gt;</span> 相册<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span> = <span class=\"string\">\"returninfo\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span> = <span class=\"string\">\"uploadImgDom\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>  后台上传的代码就不贴了，就一个Servlet。</p>\n<p>  谨记我这两天的精彩编程生活。</p>\n  <font color=\"red\">最后感谢所有网友的帮助与分享！</font>","site":{"data":{}},"excerpt":"","more":"<p>拍照上传以及从相册中选择图片上传是大多数手机应用的典型功能，这几天在做一个移动端的项目，其中就用到该功能。</p>\n<p>  项目技术选择的是Phonegap+jQueryMobile，因为jQuery自己比较熟悉，用jQueryMobile没有什么大的难点。</p>\n<p>  界面用jQueryMobile搭的很快，一开始打算用Phonegap将应用做为离线版本，但后来发现离线版本升级的话还是和普通的app一样，都需要重新安装，这就没有了WebApp的优势和亮点，故最终选择了在线版本，即将项目作为一个web应用，用Tomcat发布在服务器上，Phonegap作为一个app外壳行使浏览器功能在其中请求服务器上的页面等资源。</p>\n<p>  做该功能的时候，由于对于Phonegap接触不久，花了我整整两天的时间，这两天没有做其他的，一直在研究如何实现图片预览，网上、官网有很多成功的例子，但没有一个在我这边成功预览的，几乎看遍了网上所有的帖子，点坏了鼠标！心情坏到了极点，因为本以为很简单的东西，而后网上说的也都很简单，很多帖子都是一样的内容，但是我却死活跑不通，崩溃！</p>\n<p>  到最后，才发现问题原来出在我的“在线”应用上，无语，其实做J2EE的我深知浏览器端是无权限操作本地文件的，但是由于对Phonegap的不了解，由于知道Phonegap可以直接操作本地资源，误认为用了Phonegap就无敌了，你以为呢！于是我就把WebApp整成离线的试下喽，果然，可以显示了！</p>\n<p>  但项目已经做到这个地步了，再把它重构成离线的？不可取。于是我就开始分析了。。。</p>\n<p>  Phonegap不是可以操作本地文件吗？html中的img标签不能根据本地图片路径渲染图片，但它可以不用文件路径啊！于是呵呵了。</p>\n<p>  最终解决方案是用Phonegap的FileReader来根据本地图片路径以base64的形式读取其内容，base64是可以直接在img标签上渲染的，所以问题就解决了。</p>\n<p>  下面截取拍照上传以及预览的代码如下：</p>\n<p>  图片处理代码：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> picUrl = <span class=\"string\">\"\"</span> ;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">capturePhotoUrl</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">     navigator.camera.getPicture(onCaptureSuccess, onUrlFail, &#123;</span><br><span class=\"line\">           quality : <span class=\"number\">80</span>,</span><br><span class=\"line\"><span class=\"comment\">//         allowEdit : true,//在Android中此配置忽略</span></span><br><span class=\"line\">           destinationType : Camera.DestinationType.FILE_URI,</span><br><span class=\"line\">           sourceType:Camera.PictureSourceType.CAMERA,</span><br><span class=\"line\">           targetWidth : <span class=\"number\">800</span>, <span class=\"comment\">// 生成的图片大小 单位像素</span></span><br><span class=\"line\">           targetHeight : <span class=\"number\">640</span></span><br><span class=\"line\">     &#125;);</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onCaptureSuccess</span>(<span class=\"params\">imageURI</span>) </span>&#123;</span><br><span class=\"line\">     picUrl = imageURI;</span><br><span class=\"line\">     <span class=\"comment\">//这是关键部分</span></span><br><span class=\"line\">     <span class=\"built_in\">window</span>.resolveLocalFileSystemURI(imageURI, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">fileEntry</span>)</span>&#123;</span><br><span class=\"line\">           fileEntry.file( <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">file</span>)</span>&#123;</span><br><span class=\"line\">                 <span class=\"keyword\">var</span> reader = <span class=\"keyword\">new</span> FileReader();</span><br><span class=\"line\">                    reader.onloadend = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">evt</span>) </span>&#123;</span><br><span class=\"line\">                     $( <span class=\"string\">\"#uploadImgDom\"</span>).append(<span class=\"string\">\"&lt;img path='\"</span>+imageURI+<span class=\"string\">\"' class='uploadImg' src='\"</span>+evt.target.result+<span class=\"string\">\"' /&gt;\"</span>);</span><br><span class=\"line\">                     $( <span class=\"string\">\"#report-page\"</span>).trigger(<span class=\"string\">\"create\"</span> );</span><br><span class=\"line\">                    &#125;;</span><br><span class=\"line\">                    reader.readAsDataURL(file);</span><br><span class=\"line\">           &#125;, readFileFail);</span><br><span class=\"line\">     &#125;, readFileFail);</span><br><span class=\"line\"><span class=\"comment\">//   $(\"#urlinfo\").text(\"图片的原始路径\" + imageURI);</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">readFileFail</span>(<span class=\"params\">evt</span>)</span>&#123;</span><br><span class=\"line\">     navigator.notification.alert( <span class=\"string\">\"文件读取失败，原因：\"</span> + evt.code, <span class=\"literal\">null</span>, <span class=\"string\">\"警告\"</span> );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onUrlFail</span>(<span class=\"params\">message</span>) </span>&#123;</span><br><span class=\"line\">     navigator.notification.alert( <span class=\"string\">\"失败，原因：\"</span> + message, <span class=\"literal\">null</span>, <span class=\"string\">\"警告\"</span> );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">loadImageLocal</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">     navigator.camera.getPicture(onLoadSuccess, onUrlFail, &#123;</span><br><span class=\"line\">           quality : <span class=\"number\">80</span>,</span><br><span class=\"line\">           sourceType : Camera.PictureSourceType.PHOTOLIBRARY,</span><br><span class=\"line\">           destinationType : Camera.DestinationType.FILE_URI,</span><br><span class=\"line\"><span class=\"comment\">//         encodingType : Camera.EncodingType.JPEG,</span></span><br><span class=\"line\"><span class=\"comment\">//         mediaType : Camera.MediaType.PICTURE,</span></span><br><span class=\"line\">           targetWidth : <span class=\"number\">800</span>, <span class=\"comment\">// 生成的图片大小 单位像素，选择图片的时候一定要制定这个值，否则</span></span><br><span class=\"line\">           targetHeight : <span class=\"number\">640</span></span><br><span class=\"line\">     &#125;);</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">onLoadSuccess</span>(<span class=\"params\">imageURI</span>) </span>&#123;</span><br><span class=\"line\">     imageURI = imageURI + <span class=\"string\">\".jpg\"</span>;</span><br><span class=\"line\">     picUrl = imageURI;</span><br><span class=\"line\">     <span class=\"built_in\">window</span>.resolveLocalFileSystemURI(imageURI, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">fileEntry</span>)</span>&#123;</span><br><span class=\"line\">           fileEntry.file( <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">file</span>)</span>&#123;</span><br><span class=\"line\">                 <span class=\"keyword\">var</span> reader = <span class=\"keyword\">new</span> FileReader();</span><br><span class=\"line\">                    reader.onloadend = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">evt</span>) </span>&#123;</span><br><span class=\"line\">                     $( <span class=\"string\">\"#uploadImgDom\"</span>).append(<span class=\"string\">\"&lt;img path='\"</span>+imageURI+<span class=\"string\">\"' class='uploadImg' src='\"</span>+evt.target.result+<span class=\"string\">\"' /&gt;\"</span>);</span><br><span class=\"line\">                     $( <span class=\"string\">\"#report-page\"</span>).trigger(<span class=\"string\">\"create\"</span> );</span><br><span class=\"line\">                    &#125;;</span><br><span class=\"line\">                    reader.readAsDataURL(file);</span><br><span class=\"line\">           &#125;, readFileFail);</span><br><span class=\"line\">     &#125;, readFileFail);</span><br><span class=\"line\"><span class=\"comment\">//   $(\"#urlinfo\").text(\"图片的原始路径\" + picUrl);</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">uploadPhoto</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">     $(<span class=\"string\">\"#report-btn\"</span>).attr(&#123; <span class=\"string\">\"disabled\"</span>: <span class=\"string\">\"disabled\"</span>&#125;);</span><br><span class=\"line\">     <span class=\"keyword\">var</span> options = <span class=\"keyword\">new</span> FileUploadOptions();</span><br><span class=\"line\">     options.fileKey = <span class=\"string\">\"file\"</span>;</span><br><span class=\"line\">     options.fileName = picUrl.substr(picUrl.lastIndexOf( <span class=\"string\">'/'</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">     options.mimeType = <span class=\"string\">\"image/jpeg\"</span>;</span><br><span class=\"line\">     </span><br><span class=\"line\">     <span class=\"keyword\">var</span> ft = <span class=\"keyword\">new</span> FileTransfer(); <span class=\"comment\">//文件上传类</span></span><br><span class=\"line\">    ft.onprogress = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">progressEvt</span>) </span>&#123; <span class=\"comment\">//显示上传进度条</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (progressEvt.lengthComputable) &#123;</span><br><span class=\"line\">            navigator.notification.progressValue(<span class=\"built_in\">Math</span>.round(( progressEvt.loaded / progressEvt.total ) * <span class=\"number\">100</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    navigator.notification.progressStart( <span class=\"string\">\"提醒\"</span>, <span class=\"string\">\"当前上传进度\"</span> );</span><br><span class=\"line\">     </span><br><span class=\"line\">     <span class=\"keyword\">var</span> params = <span class=\"keyword\">new</span> <span class=\"built_in\">Object</span>();</span><br><span class=\"line\">     params.title = $( <span class=\"string\">\"#textinput-2\"</span>).val();</span><br><span class=\"line\">     params.info = $( <span class=\"string\">\"#textarea-2\"</span>).val();</span><br><span class=\"line\">     params.longitude = $( <span class=\"string\">\"#longitude\"</span>).text();</span><br><span class=\"line\">     params.latitude = $( <span class=\"string\">\"#latitude\"</span>).text();</span><br><span class=\"line\">     </span><br><span class=\"line\">     options.params = params;</span><br><span class=\"line\">     </span><br><span class=\"line\">     </span><br><span class=\"line\">     ft.upload(picUrl, basePath+ <span class=\"string\">\"/report\"</span>, win,</span><br><span class=\"line\">                fail, options);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">win</span>(<span class=\"params\">r</span>) </span>&#123;</span><br><span class=\"line\">     navigator.notification.progressStop(); <span class=\"comment\">//停止进度条</span></span><br><span class=\"line\">     </span><br><span class=\"line\">     $(<span class=\"string\">\"#returnpic\"</span>).attr( <span class=\"string\">\"src\"</span>,</span><br><span class=\"line\">                basePath+ <span class=\"string\">\"/files/\"</span> + r.response);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">//   $(\"#returninfo\").html(</span></span><br><span class=\"line\"><span class=\"comment\">//              \"上传成功\\n：反馈的信息:r.responseCode:\" + r.responseCode + \"\\nr.response:\"</span></span><br><span class=\"line\"><span class=\"comment\">//                         + r.response + \"\\nr.bytesSent:\" + r.bytesSent);</span></span><br><span class=\"line\">     $(<span class=\"string\">\"#report-btn\"</span>).removeAttr( <span class=\"string\">\"disabled\"</span>);</span><br><span class=\"line\">     navigator.notification.alert( <span class=\"string\">\"上传成功！\"</span> , <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">           $( <span class=\"string\">\"#reportPageBackBtn\"</span>).click();</span><br><span class=\"line\">     &#125;, <span class=\"string\">\"提醒\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fail</span>(<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">     <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">      * FileTransferError.FILE_NOT_FOUND_ERR：1 文件未找到错误。</span></span><br><span class=\"line\"><span class=\"comment\">      * •FileTransferError.INVALID_URL_ERR：2 无效的URL错误。</span></span><br><span class=\"line\"><span class=\"comment\">      * •FileTransferError.CONNECTION_ERR：3 连接错误。 FileTransferError.ABORT_ERR =</span></span><br><span class=\"line\"><span class=\"comment\">      * 4; 程序异常</span></span><br><span class=\"line\"><span class=\"comment\">      */</span></span><br><span class=\"line\">     <span class=\"keyword\">var</span> errorcode = error.code;</span><br><span class=\"line\">     <span class=\"keyword\">var</span> errstr = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">     <span class=\"keyword\">switch</span> (errorcode) &#123;</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"number\">1</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"错误代码1：源文件路径异常，请重新选择或者拍照上传！\"</span> ;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"number\">2</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"错误代码2:目标地址无效,请重试！\"</span> ;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">case</span> <span class=\"number\">3</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"您手机或者后台服务器网络异常,请重新上传！\"</span> ;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     <span class=\"keyword\">default</span>: &#123;</span><br><span class=\"line\">           errstr = <span class=\"string\">\"程序出错\"</span>;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     $(<span class=\"string\">\"#returninfo\"</span>).text(</span><br><span class=\"line\">                 <span class=\"string\">\"上传失败,错误代码:\"</span> + errstr + <span class=\"string\">\"上传源文件:\"</span> + error.source + <span class=\"string\">\"目标地址:\"</span></span><br><span class=\"line\">                           + error.target + <span class=\"string\">\"请重新上传！\"</span> );</span><br><span class=\"line\">    </span><br><span class=\"line\">     $(<span class=\"string\">\"#report-btn\"</span>).removeAttr( <span class=\"string\">\"disabled\"</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>前台显示代码：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">role</span>= <span class=\"string\">\"main\"</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-content jqm-content\"</span> <span class=\"attr\">data-iscroll</span> =<span class=\"string\">\"content\"</span> &gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-grid-a\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-block-a\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span> = <span class=\"string\">\"#\"</span> <span class=\"attr\">onclick</span> =<span class=\"string\">\"capturePhoto()\"</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-camera\"</span>&gt;</span> 拍照<span class=\"tag\">&lt;/ <span class=\"attr\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span> = <span class=\"string\">\"ui-block-b\"</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span> = <span class=\"string\">\"#\"</span> <span class=\"attr\">onclick</span> =<span class=\"string\">\"loadImageLocal()\"</span> <span class=\"attr\">class</span>= <span class=\"string\">\"ui-shadow ui-btn ui-btn-b ui-corner-all ui-btn-icon-left ui-icon-heart\"</span>&gt;</span> 相册<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span> = <span class=\"string\">\"returninfo\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span> = <span class=\"string\">\"uploadImgDom\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>  后台上传的代码就不贴了，就一个Servlet。</p>\n<p>  谨记我这两天的精彩编程生活。</p>\n  <font color=\"red\">最后感谢所有网友的帮助与分享！</font>"},{"title":"SpringMVC整合WebSocket","date":"2015-10-13T02:45:19.000Z","_content":"Spring4已经加入了对Websocket支持。\n- 引入Spring4的jar包，以及Spring websocket的jar包\n- web.xml文件用3.0版本。\n```xml\n< web-app\n      xmlns:xsi= “http://www.w3.org/2001/XMLSchema-instance”\n      xmlns= “http://java.sun.com/xml/ns/javaee”\n      xmlns:web= “http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd”\n      xsi:schemaLocation= “http://java.sun.com/xml/ns/javaee\n                     http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd”\n      version= “3.0” >\n```\n- Tomcat用7或以上，JDK用7或以上，其他Spring配置文件按默认即可，这里用的是注解方式。\n- WebSocketConfig.java\n```java\npackage com.noter.websocket.config;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.servlet.config.annotation.EnableWebMvc;\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;\nimport org.springframework.web.socket.WebSocketHandler;\nimport org.springframework.web.socket.config.annotation.EnableWebSocket;\nimport org.springframework.web.socket.config.annotation.WebSocketConfigurer;\nimport org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;\nimport com.noter.websocket.handler.SystemWebSocketHandler;\n@Configuration\n@EnableWebMvc\n@EnableWebSocket\npublic class WebSocketConfig extends WebMvcConfigurerAdapter implements\n           WebSocketConfigurer {\n      @Override\n      public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {\n           registry.addHandler(systemWebSocketHandler(), “/webSocketServer.do” );\n     }\n      @Bean\n      public WebSocketHandler systemWebSocketHandler() {\n            return new SystemWebSocketHandler();\n     }\n}\n```\n- SystemWebSocketHandler.java\n```java\npackage com.noter.websocket.handler;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport org.springframework.web.socket.CloseStatus;\nimport org.springframework.web.socket.TextMessage;\nimport org.springframework.web.socket.WebSocketHandler;\nimport org.springframework.web.socket.WebSocketMessage;\nimport org.springframework.web.socket.WebSocketSession;\npublic class SystemWebSocketHandler implements WebSocketHandler {\n    private static final ArrayList<WebSocketSession> users = new ArrayList<WebSocketSession>();;\n    @Override\n    public void afterConnectionEstablished(WebSocketSession session) throws Exception {\n     System. out.println( “ConnectionEstablished” );\n        users.add(session);\n    }\n    @Override\n    public void handleMessage(WebSocketSession session, WebSocketMessage<?> message) throws Exception {\n     System. out.println( “session id:” + session.getId());\n     sendMessageToUsers(session.getId(),(TextMessage) message);\n    }\n    @Override\n    public void handleTransportError(WebSocketSession session, Throwable exception) throws Exception {\n        if(session.isOpen()){\n            session.close();\n        }\n        users.remove(session);\n    }\n    @Override\n    public void afterConnectionClosed(WebSocketSession session, CloseStatus closeStatus) throws Exception {\n        users.remove(session);\n    }\n    @Override\n    public boolean supportsPartialMessages() {\n        return false;\n    }\n    /**\n     * 给所有在线用户发送消息\n     *\n     * @param message\n     */\n    public void sendMessageToUsers(String excep, TextMessage message) {\n        for (WebSocketSession user : users) {\n            try {\n                if (user.isOpen()&& !user.getId().equals(excep)) {\n                    user.sendMessage(message);\n                }\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n \n}\n```\n- 前台JSP代码：\n```\n<%@ page language = “java” contentType= “text/html; charset=UTF-8”\n      pageEncoding= “UTF-8” %>\n<%\n     String path = request.getContextPath();\n     String basePath = request.getScheme() + “://”\n     + request.getServerName() + “:” + request.getServerPort()\n     + path + “/”;\n%>\n<! DOCTYPE html PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “http://www.w3.org/TR/html4/loose.dtd” >\n< html>\n< head>\n< meta http-equiv= “Content-Type” content = “text/html; charset=UTF-8”>\n< title> WebSocket/SockJS Echo Sample (Adapted from Tomcat’s echo sample)</ title>\n    <style type = “text/css”>\n        #connect-container {\n            float: left;\n            width: 400px\n        }\n        #connect-container div {\n            padding: 5px;\n        }\n        #console-container {\n            float: left;\n            margin-left: 15px;\n            width: 400px;\n        }\n        #console {\n            border: 1px solid #CCCCCC ;\n            border-right-color: #999999;\n            border-bottom-color: #999999;\n            height: 170px;\n            overflow-y: scroll;\n            padding: 5px;\n            width: 100%;\n        }\n        #console p {\n            padding: 0;\n            margin: 0;\n        }\n    </style >\n    <script src = “../assets/js/sockjs-0.3.min.js”></ script >\n    <script type = “text/javascript”>\n        var ws = null;\n        var url = null;\n        var transports = [];\n       \n        var basePath = “ <%= basePath%> “;\n        var wsPath = basePath.replace( “http://”, “ws://” );\n \n        function setConnected(connected) {\n            document.getElementById( ‘connect’ ).disabled = connected;\n            document.getElementById( ‘disconnect’ ).disabled = !connected;\n            document.getElementById( ‘echo’ ).disabled = !connected;\n        }\n        function connect() {\n            if (!url) {\n                alert( ‘Select whether to use W3C WebSocket or SockJS’);\n                return ;\n            }\n            ws = new WebSocket(wsPath+‘webSocketServer.do’ ); /* (url.indexOf(‘sockjs’) != -1) ?\n                new SockJS(url, undefined, {protocols_whitelist: transports}) :  */\n            ws.onopen = function () {\n                setConnected( true );\n                log( ‘Info: connection opened.’ );\n            };\n            ws.onmessage = function (event) {\n                 for ( var i in event.originalTarget){\n                     console.log( “event[“ +i+“]:” +event.originalTarget[i]);\n                }\n                log( ‘Received: ‘ + event.data);\n            };\n           \n            ws.onclose = function (event) {\n                setConnected( false );\n                log( ‘Info: connection closed.’ );\n                log(event);\n            };\n        }\n \n        function disconnect() {\n            if (ws != null) {\n                ws.close();\n                ws = null ;\n            }\n            setConnected( false );\n        }\n \n        function echo() {\n            if (ws != null) {\n                var message = document.getElementById(‘message’ ).value;\n                log( ‘Sent: ‘ + message);\n                ws.send(message);\n            } else {\n                alert( ‘connection not established, please connect.’);\n            }\n        }\n \n        function updateUrl(urlPath) {\n            if (urlPath.indexOf(‘sockjs’ ) != -1) {\n                url = urlPath;\n                document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘visible’;\n            }\n            else {\n              if (window.location.protocol == ‘http:’) {\n                  url = ‘ws://’ + window.location.host + urlPath;\n              } else {\n                  url = ‘wss://’ + window.location.host + urlPath;\n              }\n              document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘hidden’;\n            }\n        }\n \n        function updateTransport(transport) {\n          transports = (transport == ‘all’ ) ?  [] : [transport];\n        }\n       \n        function log(message) {\n            var console = document.getElementById( ‘console’);\n            var p = document.createElement( ‘p’);\n            p.style.wordWrap = ‘break-word’ ;\n            p.appendChild(document.createTextNode(message));\n            console.appendChild(p);\n            while (console.childNodes.length > 25) {\n                console.removeChild(console.firstChild);\n            }\n            console.scrollTop = console.scrollHeight;\n        }\n    </script >\n</ head>\n< body>\n< noscript>< h2 style=” color: #ff0000“ >Seems your browser doesn’t support Javascript! Websockets\n    rely on Javascript being enabled. Please enable\n    Javascript and reload this page!</ h2></ noscript >\n< div>\n    <div id = “connect-container”>\n        <input id = “radio1” type= “radio” name= “group1” onclick =“updateUrl(‘ ${contextPath} /webSocketServer’);”>\n            <label for = “radio1”> W3C WebSocket</ label >\n        <br >\n        <input id = “radio2” type= “radio” name= “group1” onclick =“updateUrl(‘/spring-websocket-test/sockjs/echo’);” >\n            <label for = “radio2”> SockJS</ label >\n        <div id = “sockJsTransportSelect” style=” visibility: hidden;” >\n            <span >SockJS transport: </ span>\n            <select onchange =“updateTransport(this.value)” >\n              <option value = “all”> all</ option >\n              <option value = “websocket”> websocket</ option >\n              <option value = “xhr-polling”> xhr-polling </option >\n              <option value= “jsonp-polling” >jsonp-polling </ option>\n              <option value= “xhr-streaming” >xhr-streaming </ option>\n              <option value= “iframe-eventsource” >iframe– eventsource</ option >\n              <option value= “iframe-htmlfile” >iframe– htmlfile</ option >\n            </ select>\n        </div >\n        <div >\n            <button id = “connect” onclick =“connect();” >Connect </ button>\n            <button id = “disconnect” disabled= “disabled” onclick =“disconnect();” >Disconnect </ button>\n        </div >\n        <div >\n            <textarea id = “message” style=” width: 350px“ >Here is a message!</ textarea>\n        </div >\n        <div >\n            <button id = “echo” onclick= “echo();” disabled =“disabled” >Echo message </ button>\n        </div >\n    </div >\n    <div id = “console-container”>\n        <div id = “console”></ div>\n    </div>\n</ div>\n</ body>\n</ html>\n```\n<font color=\"red\">注：最后只要注意你定义的springmvc拦截的路径规则和请求路径即可，我一开始总是报404错误，就是路径写错了。</font>","source":"_posts/SpringMVC整合WebSocket.md","raw":"---\ntitle: SpringMVC整合WebSocket\ndate: 2015-10-13 10:45:19\ntags:\n- Java\n- WebSocket\n---\nSpring4已经加入了对Websocket支持。\n- 引入Spring4的jar包，以及Spring websocket的jar包\n- web.xml文件用3.0版本。\n```xml\n< web-app\n      xmlns:xsi= “http://www.w3.org/2001/XMLSchema-instance”\n      xmlns= “http://java.sun.com/xml/ns/javaee”\n      xmlns:web= “http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd”\n      xsi:schemaLocation= “http://java.sun.com/xml/ns/javaee\n                     http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd”\n      version= “3.0” >\n```\n- Tomcat用7或以上，JDK用7或以上，其他Spring配置文件按默认即可，这里用的是注解方式。\n- WebSocketConfig.java\n```java\npackage com.noter.websocket.config;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.servlet.config.annotation.EnableWebMvc;\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;\nimport org.springframework.web.socket.WebSocketHandler;\nimport org.springframework.web.socket.config.annotation.EnableWebSocket;\nimport org.springframework.web.socket.config.annotation.WebSocketConfigurer;\nimport org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;\nimport com.noter.websocket.handler.SystemWebSocketHandler;\n@Configuration\n@EnableWebMvc\n@EnableWebSocket\npublic class WebSocketConfig extends WebMvcConfigurerAdapter implements\n           WebSocketConfigurer {\n      @Override\n      public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {\n           registry.addHandler(systemWebSocketHandler(), “/webSocketServer.do” );\n     }\n      @Bean\n      public WebSocketHandler systemWebSocketHandler() {\n            return new SystemWebSocketHandler();\n     }\n}\n```\n- SystemWebSocketHandler.java\n```java\npackage com.noter.websocket.handler;\nimport java.io.IOException;\nimport java.util.ArrayList;\nimport org.springframework.web.socket.CloseStatus;\nimport org.springframework.web.socket.TextMessage;\nimport org.springframework.web.socket.WebSocketHandler;\nimport org.springframework.web.socket.WebSocketMessage;\nimport org.springframework.web.socket.WebSocketSession;\npublic class SystemWebSocketHandler implements WebSocketHandler {\n    private static final ArrayList<WebSocketSession> users = new ArrayList<WebSocketSession>();;\n    @Override\n    public void afterConnectionEstablished(WebSocketSession session) throws Exception {\n     System. out.println( “ConnectionEstablished” );\n        users.add(session);\n    }\n    @Override\n    public void handleMessage(WebSocketSession session, WebSocketMessage<?> message) throws Exception {\n     System. out.println( “session id:” + session.getId());\n     sendMessageToUsers(session.getId(),(TextMessage) message);\n    }\n    @Override\n    public void handleTransportError(WebSocketSession session, Throwable exception) throws Exception {\n        if(session.isOpen()){\n            session.close();\n        }\n        users.remove(session);\n    }\n    @Override\n    public void afterConnectionClosed(WebSocketSession session, CloseStatus closeStatus) throws Exception {\n        users.remove(session);\n    }\n    @Override\n    public boolean supportsPartialMessages() {\n        return false;\n    }\n    /**\n     * 给所有在线用户发送消息\n     *\n     * @param message\n     */\n    public void sendMessageToUsers(String excep, TextMessage message) {\n        for (WebSocketSession user : users) {\n            try {\n                if (user.isOpen()&& !user.getId().equals(excep)) {\n                    user.sendMessage(message);\n                }\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n \n}\n```\n- 前台JSP代码：\n```\n<%@ page language = “java” contentType= “text/html; charset=UTF-8”\n      pageEncoding= “UTF-8” %>\n<%\n     String path = request.getContextPath();\n     String basePath = request.getScheme() + “://”\n     + request.getServerName() + “:” + request.getServerPort()\n     + path + “/”;\n%>\n<! DOCTYPE html PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “http://www.w3.org/TR/html4/loose.dtd” >\n< html>\n< head>\n< meta http-equiv= “Content-Type” content = “text/html; charset=UTF-8”>\n< title> WebSocket/SockJS Echo Sample (Adapted from Tomcat’s echo sample)</ title>\n    <style type = “text/css”>\n        #connect-container {\n            float: left;\n            width: 400px\n        }\n        #connect-container div {\n            padding: 5px;\n        }\n        #console-container {\n            float: left;\n            margin-left: 15px;\n            width: 400px;\n        }\n        #console {\n            border: 1px solid #CCCCCC ;\n            border-right-color: #999999;\n            border-bottom-color: #999999;\n            height: 170px;\n            overflow-y: scroll;\n            padding: 5px;\n            width: 100%;\n        }\n        #console p {\n            padding: 0;\n            margin: 0;\n        }\n    </style >\n    <script src = “../assets/js/sockjs-0.3.min.js”></ script >\n    <script type = “text/javascript”>\n        var ws = null;\n        var url = null;\n        var transports = [];\n       \n        var basePath = “ <%= basePath%> “;\n        var wsPath = basePath.replace( “http://”, “ws://” );\n \n        function setConnected(connected) {\n            document.getElementById( ‘connect’ ).disabled = connected;\n            document.getElementById( ‘disconnect’ ).disabled = !connected;\n            document.getElementById( ‘echo’ ).disabled = !connected;\n        }\n        function connect() {\n            if (!url) {\n                alert( ‘Select whether to use W3C WebSocket or SockJS’);\n                return ;\n            }\n            ws = new WebSocket(wsPath+‘webSocketServer.do’ ); /* (url.indexOf(‘sockjs’) != -1) ?\n                new SockJS(url, undefined, {protocols_whitelist: transports}) :  */\n            ws.onopen = function () {\n                setConnected( true );\n                log( ‘Info: connection opened.’ );\n            };\n            ws.onmessage = function (event) {\n                 for ( var i in event.originalTarget){\n                     console.log( “event[“ +i+“]:” +event.originalTarget[i]);\n                }\n                log( ‘Received: ‘ + event.data);\n            };\n           \n            ws.onclose = function (event) {\n                setConnected( false );\n                log( ‘Info: connection closed.’ );\n                log(event);\n            };\n        }\n \n        function disconnect() {\n            if (ws != null) {\n                ws.close();\n                ws = null ;\n            }\n            setConnected( false );\n        }\n \n        function echo() {\n            if (ws != null) {\n                var message = document.getElementById(‘message’ ).value;\n                log( ‘Sent: ‘ + message);\n                ws.send(message);\n            } else {\n                alert( ‘connection not established, please connect.’);\n            }\n        }\n \n        function updateUrl(urlPath) {\n            if (urlPath.indexOf(‘sockjs’ ) != -1) {\n                url = urlPath;\n                document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘visible’;\n            }\n            else {\n              if (window.location.protocol == ‘http:’) {\n                  url = ‘ws://’ + window.location.host + urlPath;\n              } else {\n                  url = ‘wss://’ + window.location.host + urlPath;\n              }\n              document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘hidden’;\n            }\n        }\n \n        function updateTransport(transport) {\n          transports = (transport == ‘all’ ) ?  [] : [transport];\n        }\n       \n        function log(message) {\n            var console = document.getElementById( ‘console’);\n            var p = document.createElement( ‘p’);\n            p.style.wordWrap = ‘break-word’ ;\n            p.appendChild(document.createTextNode(message));\n            console.appendChild(p);\n            while (console.childNodes.length > 25) {\n                console.removeChild(console.firstChild);\n            }\n            console.scrollTop = console.scrollHeight;\n        }\n    </script >\n</ head>\n< body>\n< noscript>< h2 style=” color: #ff0000“ >Seems your browser doesn’t support Javascript! Websockets\n    rely on Javascript being enabled. Please enable\n    Javascript and reload this page!</ h2></ noscript >\n< div>\n    <div id = “connect-container”>\n        <input id = “radio1” type= “radio” name= “group1” onclick =“updateUrl(‘ ${contextPath} /webSocketServer’);”>\n            <label for = “radio1”> W3C WebSocket</ label >\n        <br >\n        <input id = “radio2” type= “radio” name= “group1” onclick =“updateUrl(‘/spring-websocket-test/sockjs/echo’);” >\n            <label for = “radio2”> SockJS</ label >\n        <div id = “sockJsTransportSelect” style=” visibility: hidden;” >\n            <span >SockJS transport: </ span>\n            <select onchange =“updateTransport(this.value)” >\n              <option value = “all”> all</ option >\n              <option value = “websocket”> websocket</ option >\n              <option value = “xhr-polling”> xhr-polling </option >\n              <option value= “jsonp-polling” >jsonp-polling </ option>\n              <option value= “xhr-streaming” >xhr-streaming </ option>\n              <option value= “iframe-eventsource” >iframe– eventsource</ option >\n              <option value= “iframe-htmlfile” >iframe– htmlfile</ option >\n            </ select>\n        </div >\n        <div >\n            <button id = “connect” onclick =“connect();” >Connect </ button>\n            <button id = “disconnect” disabled= “disabled” onclick =“disconnect();” >Disconnect </ button>\n        </div >\n        <div >\n            <textarea id = “message” style=” width: 350px“ >Here is a message!</ textarea>\n        </div >\n        <div >\n            <button id = “echo” onclick= “echo();” disabled =“disabled” >Echo message </ button>\n        </div >\n    </div >\n    <div id = “console-container”>\n        <div id = “console”></ div>\n    </div>\n</ div>\n</ body>\n</ html>\n```\n<font color=\"red\">注：最后只要注意你定义的springmvc拦截的路径规则和请求路径即可，我一开始总是报404错误，就是路径写错了。</font>","slug":"SpringMVC整合WebSocket","published":1,"updated":"2019-12-20T07:24:50.115Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck4dtzl2g000cemsoyjm0o5lo","content":"<p>Spring4已经加入了对Websocket支持。</p>\n<ul>\n<li>引入Spring4的jar包，以及Spring websocket的jar包</li>\n<li><p>web.xml文件用3.0版本。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt; <span class=\"attr\">web-app</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xmlns:xsi</span>= <span class=\"string\">“http://www.w3.org/2001/XMLSchema-instance”</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xmlns</span>= <span class=\"string\">“http://java.sun.com/xml/ns/javaee”</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xmlns:web</span>= <span class=\"string\">“http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd”</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xsi:schemaLocation</span>= <span class=\"string\">“http://java.sun.com/xml/ns/javaee</span></span></span><br><span class=\"line\"><span class=\"tag\">                     <span class=\"attr\">http:</span>//<span class=\"attr\">java.sun.com</span>/<span class=\"attr\">xml</span>/<span class=\"attr\">ns</span>/<span class=\"attr\">javaee</span>/<span class=\"attr\">web-app_3_0.xsd</span>”</span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">version</span>= <span class=\"string\">“3.0”</span> &gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Tomcat用7或以上，JDK用7或以上，其他Spring配置文件按默认即可，这里用的是注解方式。</p>\n</li>\n<li><p>WebSocketConfig.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.noter.websocket.config;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.config.annotation.EnableWebMvc;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.EnableWebSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.WebSocketConfigurer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.noter.websocket.handler.SystemWebSocketHandler;</span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableWebMvc</span></span><br><span class=\"line\"><span class=\"meta\">@EnableWebSocket</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSocketConfig</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebMvcConfigurerAdapter</span> <span class=\"keyword\">implements</span></span></span><br><span class=\"line\"><span class=\"class\">           <span class=\"title\">WebSocketConfigurer</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"meta\">@Override</span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">registerWebSocketHandlers</span><span class=\"params\">(WebSocketHandlerRegistry registry)</span> </span>&#123;</span><br><span class=\"line\">           registry.addHandler(systemWebSocketHandler(), “/webSocketServer.<span class=\"keyword\">do</span>” );</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">      <span class=\"meta\">@Bean</span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> WebSocketHandler <span class=\"title\">systemWebSocketHandler</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SystemWebSocketHandler();</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>SystemWebSocketHandler.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.noter.websocket.handler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.CloseStatus;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.TextMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketSession;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SystemWebSocketHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">WebSocketHandler</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> ArrayList&lt;WebSocketSession&gt; users = <span class=\"keyword\">new</span> ArrayList&lt;WebSocketSession&gt;();;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterConnectionEstablished</span><span class=\"params\">(WebSocketSession session)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">     System. out.println( “ConnectionEstablished” );</span><br><span class=\"line\">        users.add(session);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span><span class=\"params\">(WebSocketSession session, WebSocketMessage&lt;?&gt; message)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">     System. out.println( “session id:” + session.getId());</span><br><span class=\"line\">     sendMessageToUsers(session.getId(),(TextMessage) message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleTransportError</span><span class=\"params\">(WebSocketSession session, Throwable exception)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(session.isOpen())&#123;</span><br><span class=\"line\">            session.close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        users.remove(session);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterConnectionClosed</span><span class=\"params\">(WebSocketSession session, CloseStatus closeStatus)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        users.remove(session);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">supportsPartialMessages</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 给所有在线用户发送消息</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> message</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">sendMessageToUsers</span><span class=\"params\">(String excep, TextMessage message)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (WebSocketSession user : users) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (user.isOpen()&amp;&amp; !user.getId().equals(excep)) &#123;</span><br><span class=\"line\">                    user.sendMessage(message);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>前台JSP代码：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page language = “java” contentType= “text/html; charset=UTF-8”</span><br><span class=\"line\">      pageEncoding= “UTF-8” %&gt;</span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">     String path = request.getContextPath();</span><br><span class=\"line\">     String basePath = request.getScheme() + “://”</span><br><span class=\"line\">     + request.getServerName() + “:” + request.getServerPort()</span><br><span class=\"line\">     + path + “/”;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\">&lt;! DOCTYPE html PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “http://www.w3.org/TR/html4/loose.dtd” &gt;</span><br><span class=\"line\">&lt; html&gt;</span><br><span class=\"line\">&lt; head&gt;</span><br><span class=\"line\">&lt; meta http-equiv= “Content-Type” content = “text/html; charset=UTF-8”&gt;</span><br><span class=\"line\">&lt; title&gt; WebSocket/SockJS Echo Sample (Adapted from Tomcat’s echo sample)&lt;/ title&gt;</span><br><span class=\"line\">    &lt;style type = “text/css”&gt;</span><br><span class=\"line\">        #connect-container &#123;</span><br><span class=\"line\">            float: left;</span><br><span class=\"line\">            width: 400px</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #connect-container div &#123;</span><br><span class=\"line\">            padding: 5px;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #console-container &#123;</span><br><span class=\"line\">            float: left;</span><br><span class=\"line\">            margin-left: 15px;</span><br><span class=\"line\">            width: 400px;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #console &#123;</span><br><span class=\"line\">            border: 1px solid #CCCCCC ;</span><br><span class=\"line\">            border-right-color: #999999;</span><br><span class=\"line\">            border-bottom-color: #999999;</span><br><span class=\"line\">            height: 170px;</span><br><span class=\"line\">            overflow-y: scroll;</span><br><span class=\"line\">            padding: 5px;</span><br><span class=\"line\">            width: 100%;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #console p &#123;</span><br><span class=\"line\">            padding: 0;</span><br><span class=\"line\">            margin: 0;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &lt;/style &gt;</span><br><span class=\"line\">    &lt;script src = “../assets/js/sockjs-0.3.min.js”&gt;&lt;/ script &gt;</span><br><span class=\"line\">    &lt;script type = “text/javascript”&gt;</span><br><span class=\"line\">        var ws = null;</span><br><span class=\"line\">        var url = null;</span><br><span class=\"line\">        var transports = [];</span><br><span class=\"line\">       </span><br><span class=\"line\">        var basePath = “ &lt;%= basePath%&gt; “;</span><br><span class=\"line\">        var wsPath = basePath.replace( “http://”, “ws://” );</span><br><span class=\"line\"> </span><br><span class=\"line\">        function setConnected(connected) &#123;</span><br><span class=\"line\">            document.getElementById( ‘connect’ ).disabled = connected;</span><br><span class=\"line\">            document.getElementById( ‘disconnect’ ).disabled = !connected;</span><br><span class=\"line\">            document.getElementById( ‘echo’ ).disabled = !connected;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        function connect() &#123;</span><br><span class=\"line\">            if (!url) &#123;</span><br><span class=\"line\">                alert( ‘Select whether to use W3C WebSocket or SockJS’);</span><br><span class=\"line\">                return ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ws = new WebSocket(wsPath+‘webSocketServer.do’ ); /* (url.indexOf(‘sockjs’) != -1) ?</span><br><span class=\"line\">                new SockJS(url, undefined, &#123;protocols_whitelist: transports&#125;) :  */</span><br><span class=\"line\">            ws.onopen = function () &#123;</span><br><span class=\"line\">                setConnected( true );</span><br><span class=\"line\">                log( ‘Info: connection opened.’ );</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            ws.onmessage = function (event) &#123;</span><br><span class=\"line\">                 for ( var i in event.originalTarget)&#123;</span><br><span class=\"line\">                     console.log( “event[“ +i+“]:” +event.originalTarget[i]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                log( ‘Received: ‘ + event.data);</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">           </span><br><span class=\"line\">            ws.onclose = function (event) &#123;</span><br><span class=\"line\">                setConnected( false );</span><br><span class=\"line\">                log( ‘Info: connection closed.’ );</span><br><span class=\"line\">                log(event);</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function disconnect() &#123;</span><br><span class=\"line\">            if (ws != null) &#123;</span><br><span class=\"line\">                ws.close();</span><br><span class=\"line\">                ws = null ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            setConnected( false );</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function echo() &#123;</span><br><span class=\"line\">            if (ws != null) &#123;</span><br><span class=\"line\">                var message = document.getElementById(‘message’ ).value;</span><br><span class=\"line\">                log( ‘Sent: ‘ + message);</span><br><span class=\"line\">                ws.send(message);</span><br><span class=\"line\">            &#125; else &#123;</span><br><span class=\"line\">                alert( ‘connection not established, please connect.’);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function updateUrl(urlPath) &#123;</span><br><span class=\"line\">            if (urlPath.indexOf(‘sockjs’ ) != -1) &#123;</span><br><span class=\"line\">                url = urlPath;</span><br><span class=\"line\">                document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘visible’;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            else &#123;</span><br><span class=\"line\">              if (window.location.protocol == ‘http:’) &#123;</span><br><span class=\"line\">                  url = ‘ws://’ + window.location.host + urlPath;</span><br><span class=\"line\">              &#125; else &#123;</span><br><span class=\"line\">                  url = ‘wss://’ + window.location.host + urlPath;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘hidden’;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function updateTransport(transport) &#123;</span><br><span class=\"line\">          transports = (transport == ‘all’ ) ?  [] : [transport];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">       </span><br><span class=\"line\">        function log(message) &#123;</span><br><span class=\"line\">            var console = document.getElementById( ‘console’);</span><br><span class=\"line\">            var p = document.createElement( ‘p’);</span><br><span class=\"line\">            p.style.wordWrap = ‘break-word’ ;</span><br><span class=\"line\">            p.appendChild(document.createTextNode(message));</span><br><span class=\"line\">            console.appendChild(p);</span><br><span class=\"line\">            while (console.childNodes.length &gt; 25) &#123;</span><br><span class=\"line\">                console.removeChild(console.firstChild);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            console.scrollTop = console.scrollHeight;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &lt;/script &gt;</span><br><span class=\"line\">&lt;/ head&gt;</span><br><span class=\"line\">&lt; body&gt;</span><br><span class=\"line\">&lt; noscript&gt;&lt; h2 style=” color: #ff0000“ &gt;Seems your browser doesn’t support Javascript! Websockets</span><br><span class=\"line\">    rely on Javascript being enabled. Please enable</span><br><span class=\"line\">    Javascript and reload this page!&lt;/ h2&gt;&lt;/ noscript &gt;</span><br><span class=\"line\">&lt; div&gt;</span><br><span class=\"line\">    &lt;div id = “connect-container”&gt;</span><br><span class=\"line\">        &lt;input id = “radio1” type= “radio” name= “group1” onclick =“updateUrl(‘ $&#123;contextPath&#125; /webSocketServer’);”&gt;</span><br><span class=\"line\">            &lt;label for = “radio1”&gt; W3C WebSocket&lt;/ label &gt;</span><br><span class=\"line\">        &lt;br &gt;</span><br><span class=\"line\">        &lt;input id = “radio2” type= “radio” name= “group1” onclick =“updateUrl(‘/spring-websocket-test/sockjs/echo’);” &gt;</span><br><span class=\"line\">            &lt;label for = “radio2”&gt; SockJS&lt;/ label &gt;</span><br><span class=\"line\">        &lt;div id = “sockJsTransportSelect” style=” visibility: hidden;” &gt;</span><br><span class=\"line\">            &lt;span &gt;SockJS transport: &lt;/ span&gt;</span><br><span class=\"line\">            &lt;select onchange =“updateTransport(this.value)” &gt;</span><br><span class=\"line\">              &lt;option value = “all”&gt; all&lt;/ option &gt;</span><br><span class=\"line\">              &lt;option value = “websocket”&gt; websocket&lt;/ option &gt;</span><br><span class=\"line\">              &lt;option value = “xhr-polling”&gt; xhr-polling &lt;/option &gt;</span><br><span class=\"line\">              &lt;option value= “jsonp-polling” &gt;jsonp-polling &lt;/ option&gt;</span><br><span class=\"line\">              &lt;option value= “xhr-streaming” &gt;xhr-streaming &lt;/ option&gt;</span><br><span class=\"line\">              &lt;option value= “iframe-eventsource” &gt;iframe– eventsource&lt;/ option &gt;</span><br><span class=\"line\">              &lt;option value= “iframe-htmlfile” &gt;iframe– htmlfile&lt;/ option &gt;</span><br><span class=\"line\">            &lt;/ select&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">        &lt;div &gt;</span><br><span class=\"line\">            &lt;button id = “connect” onclick =“connect();” &gt;Connect &lt;/ button&gt;</span><br><span class=\"line\">            &lt;button id = “disconnect” disabled= “disabled” onclick =“disconnect();” &gt;Disconnect &lt;/ button&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">        &lt;div &gt;</span><br><span class=\"line\">            &lt;textarea id = “message” style=” width: 350px“ &gt;Here is a message!&lt;/ textarea&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">        &lt;div &gt;</span><br><span class=\"line\">            &lt;button id = “echo” onclick= “echo();” disabled =“disabled” &gt;Echo message &lt;/ button&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">    &lt;/div &gt;</span><br><span class=\"line\">    &lt;div id = “console-container”&gt;</span><br><span class=\"line\">        &lt;div id = “console”&gt;&lt;/ div&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">&lt;/ div&gt;</span><br><span class=\"line\">&lt;/ body&gt;</span><br><span class=\"line\">&lt;/ html&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<font color=\"red\">注：最后只要注意你定义的springmvc拦截的路径规则和请求路径即可，我一开始总是报404错误，就是路径写错了。</font>","site":{"data":{}},"excerpt":"","more":"<p>Spring4已经加入了对Websocket支持。</p>\n<ul>\n<li>引入Spring4的jar包，以及Spring websocket的jar包</li>\n<li><p>web.xml文件用3.0版本。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt; <span class=\"attr\">web-app</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xmlns:xsi</span>= <span class=\"string\">“http://www.w3.org/2001/XMLSchema-instance”</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xmlns</span>= <span class=\"string\">“http://java.sun.com/xml/ns/javaee”</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xmlns:web</span>= <span class=\"string\">“http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd”</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">xsi:schemaLocation</span>= <span class=\"string\">“http://java.sun.com/xml/ns/javaee</span></span></span><br><span class=\"line\"><span class=\"tag\">                     <span class=\"attr\">http:</span>//<span class=\"attr\">java.sun.com</span>/<span class=\"attr\">xml</span>/<span class=\"attr\">ns</span>/<span class=\"attr\">javaee</span>/<span class=\"attr\">web-app_3_0.xsd</span>”</span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">version</span>= <span class=\"string\">“3.0”</span> &gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Tomcat用7或以上，JDK用7或以上，其他Spring配置文件按默认即可，这里用的是注解方式。</p>\n</li>\n<li><p>WebSocketConfig.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.noter.websocket.config;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.config.annotation.EnableWebMvc;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.EnableWebSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.WebSocketConfigurer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.noter.websocket.handler.SystemWebSocketHandler;</span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableWebMvc</span></span><br><span class=\"line\"><span class=\"meta\">@EnableWebSocket</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSocketConfig</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebMvcConfigurerAdapter</span> <span class=\"keyword\">implements</span></span></span><br><span class=\"line\"><span class=\"class\">           <span class=\"title\">WebSocketConfigurer</span> </span>&#123;</span><br><span class=\"line\">      <span class=\"meta\">@Override</span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">registerWebSocketHandlers</span><span class=\"params\">(WebSocketHandlerRegistry registry)</span> </span>&#123;</span><br><span class=\"line\">           registry.addHandler(systemWebSocketHandler(), “/webSocketServer.<span class=\"keyword\">do</span>” );</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">      <span class=\"meta\">@Bean</span></span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> WebSocketHandler <span class=\"title\">systemWebSocketHandler</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> SystemWebSocketHandler();</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>SystemWebSocketHandler.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.noter.websocket.handler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.CloseStatus;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.TextMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketSession;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SystemWebSocketHandler</span> <span class=\"keyword\">implements</span> <span class=\"title\">WebSocketHandler</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> ArrayList&lt;WebSocketSession&gt; users = <span class=\"keyword\">new</span> ArrayList&lt;WebSocketSession&gt;();;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterConnectionEstablished</span><span class=\"params\">(WebSocketSession session)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">     System. out.println( “ConnectionEstablished” );</span><br><span class=\"line\">        users.add(session);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleMessage</span><span class=\"params\">(WebSocketSession session, WebSocketMessage&lt;?&gt; message)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">     System. out.println( “session id:” + session.getId());</span><br><span class=\"line\">     sendMessageToUsers(session.getId(),(TextMessage) message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleTransportError</span><span class=\"params\">(WebSocketSession session, Throwable exception)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(session.isOpen())&#123;</span><br><span class=\"line\">            session.close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        users.remove(session);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterConnectionClosed</span><span class=\"params\">(WebSocketSession session, CloseStatus closeStatus)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        users.remove(session);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">supportsPartialMessages</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 给所有在线用户发送消息</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> message</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">sendMessageToUsers</span><span class=\"params\">(String excep, TextMessage message)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (WebSocketSession user : users) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (user.isOpen()&amp;&amp; !user.getId().equals(excep)) &#123;</span><br><span class=\"line\">                    user.sendMessage(message);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>前台JSP代码：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page language = “java” contentType= “text/html; charset=UTF-8”</span><br><span class=\"line\">      pageEncoding= “UTF-8” %&gt;</span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">     String path = request.getContextPath();</span><br><span class=\"line\">     String basePath = request.getScheme() + “://”</span><br><span class=\"line\">     + request.getServerName() + “:” + request.getServerPort()</span><br><span class=\"line\">     + path + “/”;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\">&lt;! DOCTYPE html PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “http://www.w3.org/TR/html4/loose.dtd” &gt;</span><br><span class=\"line\">&lt; html&gt;</span><br><span class=\"line\">&lt; head&gt;</span><br><span class=\"line\">&lt; meta http-equiv= “Content-Type” content = “text/html; charset=UTF-8”&gt;</span><br><span class=\"line\">&lt; title&gt; WebSocket/SockJS Echo Sample (Adapted from Tomcat’s echo sample)&lt;/ title&gt;</span><br><span class=\"line\">    &lt;style type = “text/css”&gt;</span><br><span class=\"line\">        #connect-container &#123;</span><br><span class=\"line\">            float: left;</span><br><span class=\"line\">            width: 400px</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #connect-container div &#123;</span><br><span class=\"line\">            padding: 5px;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #console-container &#123;</span><br><span class=\"line\">            float: left;</span><br><span class=\"line\">            margin-left: 15px;</span><br><span class=\"line\">            width: 400px;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #console &#123;</span><br><span class=\"line\">            border: 1px solid #CCCCCC ;</span><br><span class=\"line\">            border-right-color: #999999;</span><br><span class=\"line\">            border-bottom-color: #999999;</span><br><span class=\"line\">            height: 170px;</span><br><span class=\"line\">            overflow-y: scroll;</span><br><span class=\"line\">            padding: 5px;</span><br><span class=\"line\">            width: 100%;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #console p &#123;</span><br><span class=\"line\">            padding: 0;</span><br><span class=\"line\">            margin: 0;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &lt;/style &gt;</span><br><span class=\"line\">    &lt;script src = “../assets/js/sockjs-0.3.min.js”&gt;&lt;/ script &gt;</span><br><span class=\"line\">    &lt;script type = “text/javascript”&gt;</span><br><span class=\"line\">        var ws = null;</span><br><span class=\"line\">        var url = null;</span><br><span class=\"line\">        var transports = [];</span><br><span class=\"line\">       </span><br><span class=\"line\">        var basePath = “ &lt;%= basePath%&gt; “;</span><br><span class=\"line\">        var wsPath = basePath.replace( “http://”, “ws://” );</span><br><span class=\"line\"> </span><br><span class=\"line\">        function setConnected(connected) &#123;</span><br><span class=\"line\">            document.getElementById( ‘connect’ ).disabled = connected;</span><br><span class=\"line\">            document.getElementById( ‘disconnect’ ).disabled = !connected;</span><br><span class=\"line\">            document.getElementById( ‘echo’ ).disabled = !connected;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        function connect() &#123;</span><br><span class=\"line\">            if (!url) &#123;</span><br><span class=\"line\">                alert( ‘Select whether to use W3C WebSocket or SockJS’);</span><br><span class=\"line\">                return ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            ws = new WebSocket(wsPath+‘webSocketServer.do’ ); /* (url.indexOf(‘sockjs’) != -1) ?</span><br><span class=\"line\">                new SockJS(url, undefined, &#123;protocols_whitelist: transports&#125;) :  */</span><br><span class=\"line\">            ws.onopen = function () &#123;</span><br><span class=\"line\">                setConnected( true );</span><br><span class=\"line\">                log( ‘Info: connection opened.’ );</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            ws.onmessage = function (event) &#123;</span><br><span class=\"line\">                 for ( var i in event.originalTarget)&#123;</span><br><span class=\"line\">                     console.log( “event[“ +i+“]:” +event.originalTarget[i]);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                log( ‘Received: ‘ + event.data);</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">           </span><br><span class=\"line\">            ws.onclose = function (event) &#123;</span><br><span class=\"line\">                setConnected( false );</span><br><span class=\"line\">                log( ‘Info: connection closed.’ );</span><br><span class=\"line\">                log(event);</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function disconnect() &#123;</span><br><span class=\"line\">            if (ws != null) &#123;</span><br><span class=\"line\">                ws.close();</span><br><span class=\"line\">                ws = null ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            setConnected( false );</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function echo() &#123;</span><br><span class=\"line\">            if (ws != null) &#123;</span><br><span class=\"line\">                var message = document.getElementById(‘message’ ).value;</span><br><span class=\"line\">                log( ‘Sent: ‘ + message);</span><br><span class=\"line\">                ws.send(message);</span><br><span class=\"line\">            &#125; else &#123;</span><br><span class=\"line\">                alert( ‘connection not established, please connect.’);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function updateUrl(urlPath) &#123;</span><br><span class=\"line\">            if (urlPath.indexOf(‘sockjs’ ) != -1) &#123;</span><br><span class=\"line\">                url = urlPath;</span><br><span class=\"line\">                document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘visible’;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            else &#123;</span><br><span class=\"line\">              if (window.location.protocol == ‘http:’) &#123;</span><br><span class=\"line\">                  url = ‘ws://’ + window.location.host + urlPath;</span><br><span class=\"line\">              &#125; else &#123;</span><br><span class=\"line\">                  url = ‘wss://’ + window.location.host + urlPath;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              document.getElementById(‘sockJsTransportSelect’ ).style.visibility = ‘hidden’;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        function updateTransport(transport) &#123;</span><br><span class=\"line\">          transports = (transport == ‘all’ ) ?  [] : [transport];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">       </span><br><span class=\"line\">        function log(message) &#123;</span><br><span class=\"line\">            var console = document.getElementById( ‘console’);</span><br><span class=\"line\">            var p = document.createElement( ‘p’);</span><br><span class=\"line\">            p.style.wordWrap = ‘break-word’ ;</span><br><span class=\"line\">            p.appendChild(document.createTextNode(message));</span><br><span class=\"line\">            console.appendChild(p);</span><br><span class=\"line\">            while (console.childNodes.length &gt; 25) &#123;</span><br><span class=\"line\">                console.removeChild(console.firstChild);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            console.scrollTop = console.scrollHeight;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &lt;/script &gt;</span><br><span class=\"line\">&lt;/ head&gt;</span><br><span class=\"line\">&lt; body&gt;</span><br><span class=\"line\">&lt; noscript&gt;&lt; h2 style=” color: #ff0000“ &gt;Seems your browser doesn’t support Javascript! Websockets</span><br><span class=\"line\">    rely on Javascript being enabled. Please enable</span><br><span class=\"line\">    Javascript and reload this page!&lt;/ h2&gt;&lt;/ noscript &gt;</span><br><span class=\"line\">&lt; div&gt;</span><br><span class=\"line\">    &lt;div id = “connect-container”&gt;</span><br><span class=\"line\">        &lt;input id = “radio1” type= “radio” name= “group1” onclick =“updateUrl(‘ $&#123;contextPath&#125; /webSocketServer’);”&gt;</span><br><span class=\"line\">            &lt;label for = “radio1”&gt; W3C WebSocket&lt;/ label &gt;</span><br><span class=\"line\">        &lt;br &gt;</span><br><span class=\"line\">        &lt;input id = “radio2” type= “radio” name= “group1” onclick =“updateUrl(‘/spring-websocket-test/sockjs/echo’);” &gt;</span><br><span class=\"line\">            &lt;label for = “radio2”&gt; SockJS&lt;/ label &gt;</span><br><span class=\"line\">        &lt;div id = “sockJsTransportSelect” style=” visibility: hidden;” &gt;</span><br><span class=\"line\">            &lt;span &gt;SockJS transport: &lt;/ span&gt;</span><br><span class=\"line\">            &lt;select onchange =“updateTransport(this.value)” &gt;</span><br><span class=\"line\">              &lt;option value = “all”&gt; all&lt;/ option &gt;</span><br><span class=\"line\">              &lt;option value = “websocket”&gt; websocket&lt;/ option &gt;</span><br><span class=\"line\">              &lt;option value = “xhr-polling”&gt; xhr-polling &lt;/option &gt;</span><br><span class=\"line\">              &lt;option value= “jsonp-polling” &gt;jsonp-polling &lt;/ option&gt;</span><br><span class=\"line\">              &lt;option value= “xhr-streaming” &gt;xhr-streaming &lt;/ option&gt;</span><br><span class=\"line\">              &lt;option value= “iframe-eventsource” &gt;iframe– eventsource&lt;/ option &gt;</span><br><span class=\"line\">              &lt;option value= “iframe-htmlfile” &gt;iframe– htmlfile&lt;/ option &gt;</span><br><span class=\"line\">            &lt;/ select&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">        &lt;div &gt;</span><br><span class=\"line\">            &lt;button id = “connect” onclick =“connect();” &gt;Connect &lt;/ button&gt;</span><br><span class=\"line\">            &lt;button id = “disconnect” disabled= “disabled” onclick =“disconnect();” &gt;Disconnect &lt;/ button&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">        &lt;div &gt;</span><br><span class=\"line\">            &lt;textarea id = “message” style=” width: 350px“ &gt;Here is a message!&lt;/ textarea&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">        &lt;div &gt;</span><br><span class=\"line\">            &lt;button id = “echo” onclick= “echo();” disabled =“disabled” &gt;Echo message &lt;/ button&gt;</span><br><span class=\"line\">        &lt;/div &gt;</span><br><span class=\"line\">    &lt;/div &gt;</span><br><span class=\"line\">    &lt;div id = “console-container”&gt;</span><br><span class=\"line\">        &lt;div id = “console”&gt;&lt;/ div&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">&lt;/ div&gt;</span><br><span class=\"line\">&lt;/ body&gt;</span><br><span class=\"line\">&lt;/ html&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<font color=\"red\">注：最后只要注意你定义的springmvc拦截的路径规则和请求路径即可，我一开始总是报404错误，就是路径写错了。</font>"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"ck4dtzl180001emso44iw3ms7","tag_id":"ck4dtzl1h0005emsoi728541p","_id":"ck4dtzl1m0008emsou7404ls1"},{"post_id":"ck4dtzl1e0003emsoiw7z12aa","tag_id":"ck4dtzl1m0007emsory7selzb","_id":"ck4dtzl1n0009emsocoop4lqb"},{"post_id":"ck4dtzl2e000bemsoj6ijmltj","tag_id":"ck4dtzl2h000demso7ll1yujd","_id":"ck4dtzl2h000femsosjsg7ijg"},{"post_id":"ck4dtzl2g000cemsoyjm0o5lo","tag_id":"ck4dtzl2h000eemsook1f1h10","_id":"ck4dtzl2i000hemso9u4awkep"},{"post_id":"ck4dtzl2g000cemsoyjm0o5lo","tag_id":"ck4dtzl2i000gemso5w50wlad","_id":"ck4dtzl2i000iemso77318jw6"},{"post_id":"ck4dtzl2d000aemsoi33td0kg","tag_id":"ck7y6l6w9000003sovwho6dy6","_id":"ck7y6l6wd000103so6bdsgt8m"}],"Tag":[{"name":"JavaScript","_id":"ck4dtzl1h0005emsoi728541p"},{"name":"框架","_id":"ck4dtzl1m0007emsory7selzb"},{"name":"WebApp","_id":"ck4dtzl2h000demso7ll1yujd"},{"name":"Java","_id":"ck4dtzl2h000eemsook1f1h10"},{"name":"WebSocket","_id":"ck4dtzl2i000gemso5w50wlad"},{"name":"ionic","_id":"ck7y6l6w9000003sovwho6dy6"}]}}